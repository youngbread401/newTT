{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport React, { useState, useCallback, useEffect, useRef, memo } from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Pressable from \"react-native-web/dist/exports/Pressable\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Modal from \"react-native-web/dist/exports/Modal\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport Keyboard from \"react-native-web/dist/exports/Keyboard\";\nimport Vibration from \"react-native-web/dist/exports/Vibration\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport { initializeApp } from 'firebase/app';\nimport { getDatabase, ref, onValue, set, get, off } from 'firebase/database';\nimport { debounce } from 'lodash';\nimport { ScrollView as GestureScrollView } from 'react-native-gesture-handler';\nimport { DiceRoller } from \"./components/DiceModel\";\nimport { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\nvar firebaseConfig = {\n  apiKey: \"AIzaSyBSy8ia6vKnq95_gbO7lnohVbyAQzqBtk4\",\n  authDomain: \"dndcombattracker-572b0.firebaseapp.com\",\n  databaseURL: \"https://dndcombattracker-572b0-default-rtdb.firebaseio.com\",\n  projectId: \"dndcombattracker-572b0\",\n  storageBucket: \"dndcombattracker-572b0.firebasestorage.app\",\n  messagingSenderId: \"812186225431\",\n  appId: \"1:812186225431:web:8da48e238d10db01d14552\"\n};\nvar app = initializeApp(firebaseConfig);\nvar database = getDatabase(app);\nvar LETTERS = Array.from({\n  length: 26\n}, function (_, i) {\n  return String.fromCharCode(65 + i);\n});\nvar COLORS = ['#4527A0', '#4A90E2', '#7C4DFF', '#00BFA5', '#3F51B5', '#673AB7', '#2196F3', '#B39DDB'];\nvar GRID_SIZE = 10;\nvar ABILITY_SCORES = ['STR', 'DEX', 'CON', 'INT', 'WIS', 'CHA'];\nvar SKILLS = {\n  STR: ['Athletics'],\n  DEX: ['Acrobatics', 'Sleight of Hand', 'Stealth'],\n  CON: [],\n  INT: ['Arcana', 'History', 'Investigation', 'Nature', 'Religion'],\n  WIS: ['Animal Handling', 'Insight', 'Medicine', 'Perception', 'Survival'],\n  CHA: ['Deception', 'Intimidation', 'Performance', 'Persuasion']\n};\nvar CURRENCY = ['CP', 'SP', 'EP', 'GP', 'PP'];\nvar DICE_TYPES = [{\n  sides: 4,\n  color: '#FF6B6B'\n}, {\n  sides: 6,\n  color: '#4ECDC4'\n}, {\n  sides: 8,\n  color: '#45B7D1'\n}, {\n  sides: 10,\n  color: '#96CEB4'\n}, {\n  sides: 12,\n  color: '#FFEEAD'\n}, {\n  sides: 20,\n  color: '#D4A5A5'\n}, {\n  sides: 100,\n  color: '#9B59B6'\n}];\nvar STATUS_EFFECTS = [{\n  id: 'blinded',\n  name: 'Blinded',\n  icon: 'ðŸ‘ï¸'\n}, {\n  id: 'charmed',\n  name: 'Charmed',\n  icon: 'ðŸ’•'\n}, {\n  id: 'deafened',\n  name: 'Deafened',\n  icon: 'ðŸ‘‚'\n}, {\n  id: 'frightened',\n  name: 'Frightened',\n  icon: 'ðŸ˜¨'\n}, {\n  id: 'grappled',\n  name: 'Grappled',\n  icon: 'ðŸ¤¼'\n}, {\n  id: 'incapacitated',\n  name: 'Incapacitated',\n  icon: 'ðŸ’«'\n}, {\n  id: 'invisible',\n  name: 'Invisible',\n  icon: 'ðŸ‘»'\n}, {\n  id: 'paralyzed',\n  name: 'Paralyzed',\n  icon: 'âš¡'\n}, {\n  id: 'petrified',\n  name: 'Petrified',\n  icon: 'ðŸ—¿'\n}, {\n  id: 'poisoned',\n  name: 'Poisoned',\n  icon: 'ðŸ¤¢'\n}, {\n  id: 'prone',\n  name: 'Prone',\n  icon: 'â¬‡ï¸'\n}, {\n  id: 'restrained',\n  name: 'Restrained',\n  icon: 'â›“ï¸'\n}, {\n  id: 'stunned',\n  name: 'Stunned',\n  icon: 'ðŸ’«'\n}, {\n  id: 'unconscious',\n  name: 'Unconscious',\n  icon: 'ðŸ’¤'\n}];\nvar COMMON_ENEMIES = [{\n  name: 'Bandit',\n  hp: 11,\n  maxHp: 11,\n  ac: 12,\n  initiativeBonus: 1,\n  color: '#8B4513'\n}, {\n  name: 'Wolf',\n  hp: 11,\n  maxHp: 11,\n  ac: 13,\n  initiativeBonus: 2,\n  color: '#808080'\n}, {\n  name: 'Wraith',\n  hp: 67,\n  maxHp: 67,\n  ac: 13,\n  initiativeBonus: 2,\n  color: '#4A0404'\n}, {\n  name: 'Goblin',\n  hp: 7,\n  maxHp: 7,\n  ac: 15,\n  initiativeBonus: 2,\n  color: '#355E3B'\n}, {\n  name: 'Skeleton',\n  hp: 13,\n  maxHp: 13,\n  ac: 13,\n  initiativeBonus: 2,\n  color: '#E1D9D1'\n}, {\n  name: 'Zombie',\n  hp: 22,\n  maxHp: 22,\n  ac: 8,\n  initiativeBonus: -2,\n  color: '#4A412A'\n}];\nvar windowDimensions = Dimensions.get('window');\nvar isSmallScreen = windowDimensions.width < 768;\nvar THEME = {\n  primary: '#2E1F5E',\n  secondary: '#4527A0',\n  accent: '#4A90E2',\n  gold: '#7C4DFF',\n  danger: '#FF5252',\n  success: '#00BFA5',\n  text: {\n    light: '#FFFFFF',\n    dark: '#1E1E1E'\n  },\n  background: {\n    primary: '#1A103C',\n    secondary: '#2E1F5E',\n    dark: '#150D30',\n    panel: '#3F2B85'\n  }\n};\nvar initialGameState = {\n  tokens: {},\n  layers: {\n    grid: true,\n    terrain: {},\n    tokens: {},\n    effects: {},\n    fog: {}\n  },\n  initiative: [],\n  inCombat: false,\n  currentTurn: 0,\n  settings: {\n    gridSize: GRID_SIZE,\n    showCoordinates: true\n  },\n  partyLoot: {\n    currency: {\n      CP: 0,\n      SP: 0,\n      EP: 0,\n      GP: 0,\n      PP: 0\n    },\n    items: [],\n    currentViewer: null\n  },\n  characters: [],\n  lastUpdate: Date.now()\n};\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: THEME.background.primary,\n    height: '100%',\n    width: '100%'\n  },\n  header: {\n    padding: isSmallScreen ? 10 : 20,\n    backgroundColor: THEME.background.panel,\n    width: '100%'\n  },\n  title: {\n    fontSize: isSmallScreen ? 18 : 24,\n    fontWeight: 'bold',\n    color: THEME.text.light,\n    marginBottom: 10\n  },\n  controls: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: 10,\n    justifyContent: isSmallScreen ? 'center' : 'flex-start'\n  },\n  controlButton: {\n    padding: isSmallScreen ? 8 : 10,\n    borderRadius: 5,\n    minWidth: isSmallScreen ? 80 : 100,\n    alignItems: 'center'\n  },\n  content: {\n    flex: 1,\n    width: '100%'\n  },\n  mainArea: {\n    flex: 1,\n    flexDirection: isSmallScreen ? 'column' : 'row',\n    padding: isSmallScreen ? 10 : 20,\n    gap: 20,\n    minHeight: '100%'\n  },\n  leftSidebar: {\n    width: isSmallScreen ? '100%' : 350,\n    flexShrink: 0,\n    order: isSmallScreen ? 2 : 0\n  },\n  gridSection: {\n    flex: 1,\n    minHeight: isSmallScreen ? 400 : '100%',\n    order: isSmallScreen ? 1 : 1\n  },\n  rightSidebar: {\n    width: isSmallScreen ? '100%' : 350,\n    flexShrink: 0,\n    order: isSmallScreen ? 3 : 2\n  },\n  gridContainer: {\n    padding: isSmallScreen ? 5 : 10,\n    alignItems: 'center',\n    justifyContent: 'center'\n  },\n  row: {\n    flexDirection: 'row'\n  },\n  cell: {\n    width: isSmallScreen ? 35 : 60,\n    height: isSmallScreen ? 35 : 60,\n    borderWidth: 1,\n    borderColor: THEME.accent,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: THEME.background.secondary\n  },\n  tokenContent: {\n    alignItems: 'center',\n    justifyContent: 'center',\n    width: '100%',\n    height: '100%',\n    padding: isSmallScreen ? 1 : 2\n  },\n  tokenText: {\n    fontSize: isSmallScreen ? 10 : 12,\n    fontWeight: 'bold',\n    textAlign: 'center'\n  },\n  tokenHp: {\n    fontSize: isSmallScreen ? 8 : 10,\n    textAlign: 'center'\n  },\n  modalOverlay: {\n    flex: 1,\n    backgroundColor: 'rgba(0,0,0,0.5)',\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n  modalContainer: {\n    width: '100%',\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: 20\n  },\n  modalContent: {\n    backgroundColor: THEME.background.panel,\n    padding: 20,\n    borderRadius: 10,\n    width: isSmallScreen ? '90%' : 400\n  },\n  modalTitle: {\n    fontSize: isSmallScreen ? 18 : 20,\n    fontWeight: 'bold',\n    color: THEME.text.light,\n    marginBottom: 15\n  },\n  input: {\n    borderWidth: 1,\n    borderColor: THEME.accent,\n    borderRadius: 5,\n    padding: 10,\n    marginBottom: 10,\n    color: THEME.text.light,\n    backgroundColor: THEME.background.primary\n  },\n  modalButtons: {\n    flexDirection: 'row',\n    justifyContent: 'space-around',\n    marginTop: 15\n  },\n  modalButton: {\n    padding: 10,\n    borderRadius: 5,\n    minWidth: 100,\n    alignItems: 'center'\n  },\n  buttonText: {\n    color: THEME.text.light,\n    fontWeight: 'bold',\n    fontSize: isSmallScreen ? 12 : 14\n  },\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: THEME.background.primary,\n    width: '100%',\n    height: '100%'\n  },\n  loadingText: {\n    color: THEME.text.light,\n    fontSize: 16,\n    marginTop: 10\n  },\n  loadingButtonContent: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center'\n  },\n  diceBox: {\n    width: '100%',\n    backgroundColor: THEME.background.panel,\n    borderRadius: 10,\n    padding: isSmallScreen ? 8 : 15\n  },\n  diceControls: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: 10\n  },\n  diceButtons: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: 5,\n    justifyContent: 'center'\n  },\n  diceButton: {\n    padding: isSmallScreen ? 5 : 10,\n    backgroundColor: THEME.primary,\n    borderRadius: 5,\n    alignItems: 'center',\n    minWidth: isSmallScreen ? 30 : 60\n  },\n  diceHistory: {\n    maxHeight: isSmallScreen ? 100 : 200,\n    marginTop: 10\n  },\n  diceResultContainer: {\n    padding: 5,\n    borderBottomWidth: 1,\n    borderBottomColor: THEME.accent + '40'\n  },\n  diceResult: {\n    color: THEME.text.light\n  },\n  diceTotal: {\n    fontWeight: 'bold',\n    color: THEME.accent\n  },\n  diceRolls: {\n    color: THEME.text.light + '80',\n    fontSize: 12\n  },\n  initiativeList: {\n    backgroundColor: THEME.background.panel,\n    borderRadius: 10,\n    padding: isSmallScreen ? 8 : 15,\n    width: '100%'\n  },\n  initiativeScroll: {\n    maxHeight: isSmallScreen ? 150 : 200\n  },\n  initiativeItem: {\n    padding: 10,\n    borderRadius: 5,\n    marginBottom: 5,\n    backgroundColor: THEME.background.primary\n  },\n  currentInitiative: {\n    backgroundColor: THEME.accent\n  },\n  initiativeText: {\n    color: THEME.text.light\n  },\n  currentInitiativeText: {\n    color: THEME.text.dark,\n    fontWeight: 'bold'\n  },\n  zoomControls: {\n    position: 'absolute',\n    right: 10,\n    bottom: 10,\n    flexDirection: 'row',\n    gap: 10,\n    display: isSmallScreen ? 'flex' : 'none'\n  },\n  zoomButton: {\n    width: 40,\n    height: 40,\n    borderRadius: 20,\n    backgroundColor: THEME.background.panel,\n    justifyContent: 'center',\n    alignItems: 'center',\n    opacity: 0.8\n  },\n  advantageButton: {\n    backgroundColor: THEME.background.primary,\n    padding: 8,\n    borderRadius: 5\n  },\n  advantageActive: {\n    backgroundColor: THEME.accent\n  },\n  modifierInput: {\n    backgroundColor: THEME.background.primary,\n    color: THEME.text.light,\n    padding: 8,\n    borderRadius: 5,\n    width: 60,\n    textAlign: 'center'\n  },\n  boxTitle: {\n    color: THEME.text.light,\n    fontSize: 16,\n    fontWeight: 'bold',\n    marginBottom: 10\n  },\n  colorPicker: {\n    flexDirection: 'row',\n    justifyContent: 'center',\n    gap: isSmallScreen ? 2 : 5,\n    marginBottom: isSmallScreen ? 5 : 10\n  },\n  colorButton: {\n    width: isSmallScreen ? 20 : 30,\n    height: isSmallScreen ? 20 : 30,\n    borderRadius: isSmallScreen ? 10 : 15,\n    margin: isSmallScreen ? 1 : 2\n  },\n  selectedColor: {\n    borderWidth: 2,\n    borderColor: THEME.accent\n  },\n  quickActions: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: 10,\n    padding: 15,\n    backgroundColor: THEME.background.panel,\n    borderRadius: 10,\n    marginBottom: 15\n  },\n  quickActionButton: {\n    backgroundColor: THEME.background.secondary,\n    padding: 12,\n    borderRadius: 8,\n    alignItems: 'center',\n    justifyContent: 'center',\n    minWidth: 100,\n    flex: 1\n  },\n  quickActionText: {\n    color: THEME.text.light,\n    fontSize: 14,\n    fontWeight: 'bold'\n  },\n  infoPanel: {\n    backgroundColor: THEME.background.panel,\n    padding: 15,\n    borderRadius: 10,\n    marginBottom: 15\n  },\n  infoPanelTitle: {\n    color: THEME.text.light,\n    fontSize: 16,\n    fontWeight: 'bold',\n    marginBottom: 10\n  },\n  infoGrid: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: 10\n  },\n  infoCard: {\n    backgroundColor: THEME.background.secondary,\n    padding: 12,\n    borderRadius: 8,\n    flex: 1,\n    minWidth: 150\n  },\n  infoLabel: {\n    color: THEME.accent,\n    fontSize: 12,\n    marginBottom: 5\n  },\n  infoValue: {\n    color: THEME.text.light,\n    fontSize: 16,\n    fontWeight: 'bold'\n  },\n  statBadge: {\n    backgroundColor: THEME.accent + '20',\n    paddingVertical: 4,\n    paddingHorizontal: 8,\n    borderRadius: 12,\n    alignSelf: 'flex-start'\n  },\n  statBadgeText: {\n    color: THEME.accent,\n    fontSize: 12,\n    fontWeight: 'bold'\n  },\n  divider: {\n    height: 1,\n    backgroundColor: THEME.accent + '40',\n    marginVertical: 15\n  }\n});\nvar additionalStyles = StyleSheet.create({\n  characterSheet: {\n    backgroundColor: THEME.background.panel,\n    padding: 20,\n    borderRadius: 10,\n    width: isSmallScreen ? '95%' : '80%',\n    maxWidth: 800,\n    maxHeight: '90%'\n  },\n  sheetHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    marginBottom: 20\n  },\n  sheetSection: {\n    marginBottom: 20\n  },\n  sectionTitle: {\n    fontSize: 18,\n    fontWeight: 'bold',\n    color: THEME.text.light,\n    marginBottom: 10\n  },\n  abilityScores: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    justifyContent: 'space-around',\n    gap: 10\n  },\n  abilityBox: {\n    backgroundColor: THEME.background.primary,\n    padding: 10,\n    borderRadius: 5,\n    alignItems: 'center',\n    width: isSmallScreen ? '30%' : 100,\n    marginBottom: 10\n  },\n  abilityLabel: {\n    color: THEME.text.light,\n    fontWeight: 'bold'\n  },\n  abilityScore: {\n    color: THEME.accent,\n    fontSize: 24,\n    fontWeight: 'bold',\n    width: '100%',\n    textAlign: 'center',\n    padding: 5\n  },\n  abilityMod: {\n    color: THEME.text.light\n  },\n  skillsList: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: 10\n  },\n  skillItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    backgroundColor: THEME.background.primary,\n    padding: 8,\n    borderRadius: 5,\n    minWidth: isSmallScreen ? '45%' : 200\n  },\n  proficientDot: {\n    width: 10,\n    height: 10,\n    borderRadius: 5,\n    marginRight: 5\n  },\n  skillName: {\n    color: THEME.text.light,\n    flex: 1\n  },\n  skillMod: {\n    color: THEME.accent,\n    fontWeight: 'bold'\n  },\n  closeButton: {\n    position: 'absolute',\n    top: 10,\n    right: 10,\n    padding: 10\n  },\n  closeButtonText: {\n    color: THEME.text.light,\n    fontSize: 20\n  },\n  lootSection: {\n    backgroundColor: THEME.background.primary,\n    padding: 15,\n    borderRadius: 5,\n    marginBottom: 15\n  },\n  currencyRow: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: 8\n  },\n  currencyInput: {\n    backgroundColor: THEME.background.secondary,\n    color: THEME.text.light,\n    padding: 8,\n    borderRadius: 5,\n    width: 80,\n    textAlign: 'center'\n  },\n  currencyLabel: {\n    color: THEME.text.light,\n    width: 30\n  },\n  itemRow: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginBottom: 8,\n    gap: 10\n  },\n  itemInput: {\n    flex: 1,\n    backgroundColor: THEME.background.secondary,\n    color: THEME.text.light,\n    padding: 8,\n    borderRadius: 5\n  },\n  removeButton: {\n    padding: 5,\n    borderRadius: 5,\n    backgroundColor: THEME.danger\n  },\n  addButton: {\n    backgroundColor: THEME.success,\n    padding: 8,\n    borderRadius: 5,\n    alignItems: 'center',\n    marginTop: 10\n  },\n  lootHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: 10\n  },\n  itemInfo: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 10,\n    flex: 1\n  },\n  addedBy: {\n    color: THEME.text.light,\n    opacity: 0.6,\n    fontSize: 12,\n    marginTop: 4\n  },\n  enemyOption: {\n    padding: 15,\n    borderRadius: 5,\n    marginBottom: 8,\n    backgroundColor: THEME.background.secondary\n  },\n  dmToggle: {\n    backgroundColor: THEME.background.secondary,\n    padding: 10,\n    borderRadius: 5,\n    marginLeft: 10\n  },\n  dmToggleActive: {\n    backgroundColor: THEME.accent\n  }\n});\nvar diceStyles = StyleSheet.create({\n  dicePanel: {\n    backgroundColor: THEME.background.panel,\n    borderRadius: 10,\n    padding: 15,\n    marginBottom: 15\n  },\n  diceHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: 15\n  },\n  diceTitle: {\n    color: THEME.text.light,\n    fontSize: 18,\n    fontWeight: 'bold'\n  },\n  diceGrid: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: 8,\n    justifyContent: 'center',\n    marginBottom: 15\n  },\n  diceButton: {\n    width: isSmallScreen ? 45 : 60,\n    height: isSmallScreen ? 45 : 60,\n    borderRadius: 10,\n    justifyContent: 'center',\n    alignItems: 'center',\n    boxShadow: '0px 2px 3.84px rgba(0, 0, 0, 0.25)'\n  },\n  diceButtonText: {\n    color: THEME.text.light,\n    fontSize: isSmallScreen ? 14 : 16,\n    fontWeight: 'bold'\n  },\n  diceControls: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    backgroundColor: THEME.background.primary,\n    padding: 10,\n    borderRadius: 8,\n    marginBottom: 15\n  },\n  controlGroup: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 8\n  },\n  controlButton: {\n    backgroundColor: THEME.background.secondary,\n    padding: 8,\n    borderRadius: 5,\n    minWidth: 80,\n    alignItems: 'center'\n  },\n  controlActive: {\n    backgroundColor: THEME.accent\n  },\n  modifierGroup: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 5\n  },\n  modifierLabel: {\n    color: THEME.text.light,\n    fontSize: 14\n  },\n  modifierInput: {\n    backgroundColor: THEME.background.secondary,\n    color: THEME.text.light,\n    padding: 8,\n    borderRadius: 5,\n    width: 50,\n    textAlign: 'center'\n  },\n  historyContainer: {\n    backgroundColor: THEME.background.primary,\n    borderRadius: 8,\n    maxHeight: 200\n  },\n  historyScroll: {\n    padding: 10\n  },\n  historyItem: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    paddingVertical: 8,\n    paddingHorizontal: 12,\n    borderBottomWidth: 1,\n    borderBottomColor: THEME.background.secondary\n  },\n  historyLeft: {\n    flex: 1\n  },\n  historyInfo: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 5\n  },\n  historyDice: {\n    color: THEME.text.light,\n    opacity: 0.7\n  },\n  historyRolls: {\n    color: THEME.text.light,\n    fontSize: 12,\n    opacity: 0.5\n  },\n  historyTotal: {\n    color: THEME.accent,\n    fontSize: 18,\n    fontWeight: 'bold'\n  },\n  clearButton: {\n    backgroundColor: THEME.background.secondary,\n    padding: 8,\n    borderRadius: 5,\n    alignItems: 'center',\n    marginTop: 10\n  },\n  quantityGroup: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 5\n  },\n  quantityLabel: {\n    color: THEME.text.light,\n    fontSize: 14\n  },\n  quantityInput: {\n    backgroundColor: THEME.background.secondary,\n    color: THEME.text.light,\n    padding: 8,\n    borderRadius: 5,\n    width: 50,\n    textAlign: 'center'\n  },\n  diceControls: {\n    flexDirection: 'column',\n    backgroundColor: THEME.background.primary,\n    padding: 10,\n    borderRadius: 8,\n    marginBottom: 15,\n    gap: 10\n  },\n  controlsRow: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center'\n  },\n  diceContainer: {\n    width: isSmallScreen ? 80 : 100,\n    height: isSmallScreen ? 80 : 100,\n    borderRadius: 10,\n    overflow: 'hidden',\n    marginBottom: 5\n  }\n});\nvar statusStyles = StyleSheet.create({\n  effectsContainer: {\n    marginTop: 15,\n    borderTopWidth: 1,\n    borderTopColor: THEME.accent + '40',\n    paddingTop: 15\n  },\n  effectsTitle: {\n    color: THEME.text.light,\n    fontSize: 16,\n    fontWeight: 'bold',\n    marginBottom: 10\n  },\n  effectsGrid: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: 8\n  },\n  effectButton: {\n    backgroundColor: THEME.background.primary,\n    padding: 8,\n    borderRadius: 5,\n    alignItems: 'center',\n    minWidth: 80\n  },\n  effectActive: {\n    backgroundColor: THEME.accent\n  },\n  effectText: {\n    color: THEME.text.light,\n    fontSize: 12\n  },\n  tokenEffects: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    gap: 2,\n    marginTop: 2\n  },\n  effectIcon: {\n    fontSize: isSmallScreen ? 10 : 12\n  }\n});\nvar saveGameState = function () {\n  var _ref = _asyncToGenerator(function* () {\n    if (firebaseRef.current) {\n      try {\n        yield set(firebaseRef.current, {\n          tokens: tokens,\n          layers: layers,\n          initiative: initiative,\n          inCombat: inCombat,\n          currentTurn: currentTurn,\n          partyLoot: partyLoot,\n          characters: characters,\n          settings: initialGameState.settings,\n          lastUpdate: Date.now()\n        });\n      } catch (error) {\n        console.error('Error saving game state:', error);\n        Alert.alert('Error', 'Failed to save game state');\n      }\n    }\n  });\n  return function saveGameState() {\n    return _ref.apply(this, arguments);\n  };\n}();\nvar CharacterSheetModal = memo(function (_ref2) {\n  var visible = _ref2.visible,\n    onClose = _ref2.onClose,\n    character = _ref2.character,\n    characters = _ref2.characters,\n    onUpdate = _ref2.onUpdate;\n  var _useState = useState(function () {\n      return {\n        name: (character == null ? void 0 : character.name) || '',\n        class: (character == null ? void 0 : character.class) || '',\n        level: (character == null ? void 0 : character.level) || 1,\n        owner: (character == null ? void 0 : character.owner) || '',\n        proficiencyBonus: (character == null ? void 0 : character.proficiencyBonus) || 2,\n        hp: (character == null ? void 0 : character.hp) || 0,\n        maxHp: (character == null ? void 0 : character.maxHp) || 0,\n        ac: (character == null ? void 0 : character.ac) || 10,\n        abilityScores: (character == null ? void 0 : character.abilityScores) || {\n          STR: 10,\n          DEX: 10,\n          CON: 10,\n          INT: 10,\n          WIS: 10,\n          CHA: 10\n        },\n        proficientSkills: (character == null ? void 0 : character.proficientSkills) || [],\n        currency: (character == null ? void 0 : character.currency) || {\n          CP: 0,\n          SP: 0,\n          EP: 0,\n          GP: 0,\n          PP: 0\n        },\n        items: (character == null ? void 0 : character.items) || [],\n        inventory: (character == null ? void 0 : character.inventory) || []\n      };\n    }),\n    _useState2 = _slicedToArray(_useState, 2),\n    editedCharacter = _useState2[0],\n    setEditedCharacter = _useState2[1];\n  useEffect(function () {\n    if (visible && character) {\n      setEditedCharacter({\n        name: character.name || '',\n        class: character.class || '',\n        level: character.level || 1,\n        owner: character.owner || '',\n        proficiencyBonus: character.proficiencyBonus || 2,\n        hp: character.hp || 0,\n        maxHp: character.maxHp || 0,\n        ac: character.ac || 10,\n        abilityScores: character.abilityScores || {\n          STR: 10,\n          DEX: 10,\n          CON: 10,\n          INT: 10,\n          WIS: 10,\n          CHA: 10\n        },\n        proficientSkills: character.proficientSkills || [],\n        currency: character.currency || {\n          CP: 0,\n          SP: 0,\n          EP: 0,\n          GP: 0,\n          PP: 0\n        },\n        items: character.items || [],\n        inventory: character.inventory || []\n      });\n    }\n  }, [visible, character]);\n  if (!character) {\n    console.error('No character data provided to CharacterSheetModal');\n    return null;\n  }\n  var calculateModifier = function calculateModifier(score) {\n    return Math.floor((score - 10) / 2);\n  };\n  var handleAbilityScoreChange = function handleAbilityScoreChange(ability, value) {\n    var newScore = parseInt(value) || 0;\n    setEditedCharacter(function (prev) {\n      return _objectSpread(_objectSpread({}, prev), {}, {\n        abilityScores: _objectSpread(_objectSpread({}, prev.abilityScores), {}, _defineProperty({}, ability, newScore))\n      });\n    });\n  };\n  var toggleProficiency = function toggleProficiency(skill) {\n    setEditedCharacter(function (prev) {\n      return _objectSpread(_objectSpread({}, prev), {}, {\n        proficientSkills: prev.proficientSkills.includes(skill) ? prev.proficientSkills.filter(function (s) {\n          return s !== skill;\n        }) : [].concat(_toConsumableArray(prev.proficientSkills), [skill])\n      });\n    });\n  };\n  var getSkillModifier = function getSkillModifier(skill, ability) {\n    var abilityMod = calculateModifier(editedCharacter.abilityScores[ability]);\n    var profBonus = editedCharacter.proficientSkills.includes(skill) ? editedCharacter.proficiencyBonus : 0;\n    return abilityMod + profBonus;\n  };\n  var handleSave = function () {\n    var _ref3 = _asyncToGenerator(function* () {\n      try {\n        var updatedCharacter = _objectSpread(_objectSpread({}, character), editedCharacter);\n        onUpdate(updatedCharacter);\n      } catch (error) {\n        console.error('Error saving character:', error);\n        Alert.alert('Error', 'Failed to save character');\n      }\n    });\n    return function handleSave() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  if (!visible) return null;\n  return _jsx(Modal, {\n    visible: visible,\n    transparent: true,\n    animationType: \"fade\",\n    onRequestClose: onClose,\n    children: _jsx(View, {\n      style: styles.modalOverlay,\n      children: _jsxs(View, {\n        style: additionalStyles.characterSheet,\n        children: [_jsx(TouchableOpacity, {\n          style: additionalStyles.closeButton,\n          onPress: onClose,\n          children: _jsx(Text, {\n            style: additionalStyles.closeButtonText,\n            children: \"\\xD7\"\n          })\n        }), _jsxs(GestureScrollView, {\n          children: [_jsxs(View, {\n            style: additionalStyles.sheetSection,\n            children: [_jsx(Text, {\n              style: additionalStyles.sectionTitle,\n              children: \"Character Info\"\n            }), _jsx(TextInput, {\n              style: styles.input,\n              value: editedCharacter.name,\n              onChangeText: function onChangeText(text) {\n                return setEditedCharacter(function (prev) {\n                  return _objectSpread(_objectSpread({}, prev), {}, {\n                    name: text\n                  });\n                });\n              },\n              placeholder: \"Character Name\",\n              placeholderTextColor: THEME.text.light + '80'\n            }), _jsxs(View, {\n              style: {\n                flexDirection: 'row',\n                gap: 10\n              },\n              children: [_jsx(TextInput, {\n                style: [styles.input, {\n                  flex: 1\n                }],\n                value: editedCharacter.class,\n                onChangeText: function onChangeText(text) {\n                  return setEditedCharacter(function (prev) {\n                    return _objectSpread(_objectSpread({}, prev), {}, {\n                      class: text\n                    });\n                  });\n                },\n                placeholder: \"Class\",\n                placeholderTextColor: THEME.text.light + '80'\n              }), _jsx(TextInput, {\n                style: [styles.input, {\n                  flex: 1\n                }],\n                value: String(editedCharacter.level),\n                onChangeText: function onChangeText(text) {\n                  return setEditedCharacter(function (prev) {\n                    return _objectSpread(_objectSpread({}, prev), {}, {\n                      level: parseInt(text) || 1\n                    });\n                  });\n                },\n                placeholder: \"Level\",\n                keyboardType: \"numeric\",\n                placeholderTextColor: THEME.text.light + '80'\n              })]\n            }), _jsxs(View, {\n              style: {\n                flexDirection: 'row',\n                gap: 10,\n                marginTop: 10\n              },\n              children: [_jsxs(View, {\n                style: {\n                  flex: 2\n                },\n                children: [_jsx(Text, {\n                  style: [styles.buttonText, {\n                    marginBottom: 5\n                  }],\n                  children: \"Hit Points\"\n                }), _jsxs(View, {\n                  style: {\n                    flexDirection: 'row',\n                    gap: 5\n                  },\n                  children: [_jsx(TextInput, {\n                    style: [styles.input, {\n                      flex: 1\n                    }],\n                    value: String(editedCharacter.hp),\n                    onChangeText: function onChangeText(text) {\n                      return setEditedCharacter(function (prev) {\n                        return _objectSpread(_objectSpread({}, prev), {}, {\n                          hp: parseInt(text) || 0\n                        });\n                      });\n                    },\n                    placeholder: \"Current HP\",\n                    keyboardType: \"numeric\",\n                    placeholderTextColor: THEME.text.light + '80'\n                  }), _jsx(Text, {\n                    style: {\n                      color: THEME.text.light,\n                      alignSelf: 'center',\n                      fontSize: 18\n                    },\n                    children: \"/\"\n                  }), _jsx(TextInput, {\n                    style: [styles.input, {\n                      flex: 1\n                    }],\n                    value: String(editedCharacter.maxHp),\n                    onChangeText: function onChangeText(text) {\n                      return setEditedCharacter(function (prev) {\n                        return _objectSpread(_objectSpread({}, prev), {}, {\n                          maxHp: parseInt(text) || 0\n                        });\n                      });\n                    },\n                    placeholder: \"Max HP\",\n                    keyboardType: \"numeric\",\n                    placeholderTextColor: THEME.text.light + '80'\n                  })]\n                })]\n              }), _jsxs(View, {\n                style: {\n                  flex: 1\n                },\n                children: [_jsx(Text, {\n                  style: [styles.buttonText, {\n                    marginBottom: 5\n                  }],\n                  children: \"Armor Class\"\n                }), _jsx(TextInput, {\n                  style: styles.input,\n                  value: String(editedCharacter.ac),\n                  onChangeText: function onChangeText(text) {\n                    return setEditedCharacter(function (prev) {\n                      return _objectSpread(_objectSpread({}, prev), {}, {\n                        ac: parseInt(text) || 10\n                      });\n                    });\n                  },\n                  placeholder: \"AC\",\n                  keyboardType: \"numeric\",\n                  placeholderTextColor: THEME.text.light + '80'\n                })]\n              })]\n            })]\n          }), _jsxs(View, {\n            style: additionalStyles.sheetSection,\n            children: [_jsx(Text, {\n              style: additionalStyles.sectionTitle,\n              children: \"Ability Scores\"\n            }), _jsx(View, {\n              style: additionalStyles.abilityScores,\n              children: ABILITY_SCORES.map(function (ability) {\n                return _jsxs(View, {\n                  style: additionalStyles.abilityBox,\n                  children: [_jsx(Text, {\n                    style: additionalStyles.abilityLabel,\n                    children: ability\n                  }), _jsx(TextInput, {\n                    style: additionalStyles.abilityScore,\n                    value: String(editedCharacter.abilityScores[ability]),\n                    onChangeText: function onChangeText(text) {\n                      return handleAbilityScoreChange(ability, text);\n                    },\n                    keyboardType: \"numeric\",\n                    maxLength: 2,\n                    selectTextOnFocus: true\n                  }), _jsxs(Text, {\n                    style: additionalStyles.abilityMod,\n                    children: [calculateModifier(editedCharacter.abilityScores[ability]) >= 0 ? '+' : '', calculateModifier(editedCharacter.abilityScores[ability])]\n                  })]\n                }, ability);\n              })\n            })]\n          }), _jsxs(View, {\n            style: additionalStyles.sheetSection,\n            children: [_jsx(Text, {\n              style: additionalStyles.sectionTitle,\n              children: \"Skills\"\n            }), _jsx(View, {\n              style: additionalStyles.skillsList,\n              children: Object.entries(SKILLS).map(function (_ref4) {\n                var _ref5 = _slicedToArray(_ref4, 2),\n                  ability = _ref5[0],\n                  skills = _ref5[1];\n                return skills.map(function (skill) {\n                  return _jsxs(TouchableOpacity, {\n                    style: additionalStyles.skillItem,\n                    onPress: function onPress() {\n                      return toggleProficiency(skill);\n                    },\n                    children: [_jsx(View, {\n                      style: [additionalStyles.proficientDot, {\n                        backgroundColor: editedCharacter.proficientSkills.includes(skill) ? THEME.accent : THEME.background.secondary\n                      }]\n                    }), _jsx(Text, {\n                      style: additionalStyles.skillName,\n                      children: skill\n                    }), _jsxs(Text, {\n                      style: additionalStyles.skillMod,\n                      children: [getSkillModifier(skill, ability) >= 0 ? '+' : '', getSkillModifier(skill, ability)]\n                    })]\n                  }, skill);\n                });\n              })\n            })]\n          }), _jsxs(View, {\n            style: additionalStyles.sheetSection,\n            children: [_jsx(Text, {\n              style: additionalStyles.sectionTitle,\n              children: \"Inventory\"\n            }), _jsx(View, {\n              style: additionalStyles.lootSection,\n              children: CURRENCY.map(function (currency) {\n                return _jsxs(View, {\n                  style: additionalStyles.currencyRow,\n                  children: [_jsx(Text, {\n                    style: additionalStyles.currencyLabel,\n                    children: currency\n                  }), _jsx(TextInput, {\n                    style: additionalStyles.currencyInput,\n                    value: String(editedCharacter.currency[currency] || 0),\n                    onChangeText: function onChangeText(text) {\n                      var value = parseInt(text) || 0;\n                      setEditedCharacter(function (prev) {\n                        return _objectSpread(_objectSpread({}, prev), {}, {\n                          currency: _objectSpread(_objectSpread({}, prev.currency), {}, _defineProperty({}, currency, value))\n                        });\n                      });\n                    },\n                    keyboardType: \"numeric\",\n                    placeholderTextColor: THEME.text.light + '80'\n                  })]\n                }, currency);\n              })\n            }), _jsxs(View, {\n              style: additionalStyles.lootSection,\n              children: [_jsxs(View, {\n                style: additionalStyles.lootHeader,\n                children: [_jsx(Text, {\n                  style: additionalStyles.sectionTitle,\n                  children: \"Items\"\n                }), _jsx(TouchableOpacity, {\n                  style: additionalStyles.addButton,\n                  onPress: function onPress() {\n                    setEditedCharacter(function (prev) {\n                      return _objectSpread(_objectSpread({}, prev), {}, {\n                        items: [].concat(_toConsumableArray(prev.items), [{\n                          name: '',\n                          quantity: 1,\n                          notes: '',\n                          addedBy: character.name\n                        }])\n                      });\n                    });\n                  },\n                  children: _jsx(Text, {\n                    style: styles.buttonText,\n                    children: \"Add Item\"\n                  })\n                })]\n              }), editedCharacter.items.map(function (item, index) {\n                return _jsxs(View, {\n                  style: additionalStyles.itemRow,\n                  children: [_jsxs(View, {\n                    style: additionalStyles.itemInfo,\n                    children: [_jsx(TextInput, {\n                      style: [additionalStyles.itemInput, {\n                        flex: 2\n                      }],\n                      value: item.name,\n                      onChangeText: function onChangeText(text) {\n                        var newItems = _toConsumableArray(editedCharacter.items);\n                        newItems[index] = _objectSpread(_objectSpread({}, item), {}, {\n                          name: text\n                        });\n                        setEditedCharacter(function (prev) {\n                          return _objectSpread(_objectSpread({}, prev), {}, {\n                            items: newItems\n                          });\n                        });\n                      },\n                      placeholder: \"Item name\",\n                      placeholderTextColor: THEME.text.light + '80'\n                    }), _jsx(TextInput, {\n                      style: [additionalStyles.itemInput, {\n                        width: 60\n                      }],\n                      value: String(item.quantity),\n                      onChangeText: function onChangeText(text) {\n                        var newItems = _toConsumableArray(editedCharacter.items);\n                        newItems[index] = _objectSpread(_objectSpread({}, item), {}, {\n                          quantity: parseInt(text) || 1\n                        });\n                        setEditedCharacter(function (prev) {\n                          return _objectSpread(_objectSpread({}, prev), {}, {\n                            items: newItems\n                          });\n                        });\n                      },\n                      keyboardType: \"numeric\",\n                      placeholder: \"Qty\",\n                      placeholderTextColor: THEME.text.light + '80'\n                    }), item.addedBy === character.name && _jsx(TouchableOpacity, {\n                      style: additionalStyles.removeButton,\n                      onPress: function onPress() {\n                        setEditedCharacter(function (prev) {\n                          return _objectSpread(_objectSpread({}, prev), {}, {\n                            items: prev.items.filter(function (_, i) {\n                              return i !== index;\n                            })\n                          });\n                        });\n                      },\n                      children: _jsx(Text, {\n                        style: styles.buttonText,\n                        children: \"\\xD7\"\n                      })\n                    })]\n                  }), _jsxs(Text, {\n                    style: additionalStyles.addedBy,\n                    children: [\"Added by: \", item.addedBy]\n                  })]\n                }, index);\n              })]\n            }), _jsx(TouchableOpacity, {\n              style: [styles.modalButton, {\n                backgroundColor: THEME.success\n              }],\n              onPress: handleSave,\n              children: _jsx(Text, {\n                style: styles.buttonText,\n                children: \"Save Changes\"\n              })\n            })]\n          })]\n        })]\n      })\n    })\n  });\n});\nvar TokenModal = memo(function (_ref6) {\n  var showTokenModal = _ref6.showTokenModal,\n    setShowTokenModal = _ref6.setShowTokenModal,\n    selectedToken = _ref6.selectedToken,\n    setSelectedToken = _ref6.setSelectedToken,\n    tokens = _ref6.tokens,\n    firebaseRef = _ref6.firebaseRef,\n    initialGameState = _ref6.initialGameState,\n    layers = _ref6.layers,\n    initiative = _ref6.initiative,\n    inCombat = _ref6.inCombat,\n    currentTurn = _ref6.currentTurn,\n    THEME = _ref6.THEME;\n  return _jsx(Modal, {\n    visible: showTokenModal,\n    transparent: true,\n    animationType: \"fade\",\n    onRequestClose: function onRequestClose() {\n      return setShowTokenModal(false);\n    },\n    children: _jsx(Pressable, {\n      style: [styles.modalOverlay, {\n        cursor: 'default'\n      }],\n      onPress: function onPress() {\n        return Keyboard.dismiss();\n      },\n      children: _jsx(View, {\n        style: styles.modalContent,\n        children: _jsx(KeyboardAvoidingView, {\n          behavior: Platform.select({\n            ios: 'padding',\n            android: 'height'\n          }),\n          style: styles.modalContainer,\n          keyboardVerticalOffset: Platform.select({\n            ios: 64,\n            android: 0\n          }),\n          children: _jsxs(Pressable, {\n            onPress: function onPress(e) {\n              return e.stopPropagation();\n            },\n            children: [_jsx(Text, {\n              style: styles.modalTitle,\n              children: \"Edit Token\"\n            }), _jsx(TextInput, {\n              style: styles.input,\n              value: selectedToken == null ? void 0 : selectedToken.name,\n              onChangeText: function onChangeText(text) {\n                setSelectedToken(function (prev) {\n                  return _objectSpread(_objectSpread({}, prev), {}, {\n                    name: text\n                  });\n                });\n              },\n              placeholder: \"Token Name\",\n              placeholderTextColor: THEME.text.light + '80',\n              blurOnSubmit: false,\n              autoComplete: \"off\",\n              spellCheck: false,\n              selectTextOnFocus: true,\n              enablesReturnKeyAutomatically: true\n            }), _jsxs(View, {\n              style: {\n                flexDirection: 'row',\n                gap: 10,\n                marginBottom: 10\n              },\n              children: [_jsx(View, {\n                style: {\n                  flex: 1\n                },\n                children: _jsx(TextInput, {\n                  style: styles.input,\n                  value: String((selectedToken == null ? void 0 : selectedToken.hp) || ''),\n                  onChangeText: function onChangeText(text) {\n                    var hp = parseInt(text) || 0;\n                    setSelectedToken(function (prev) {\n                      return _objectSpread(_objectSpread({}, prev), {}, {\n                        hp: Math.max(0, hp)\n                      });\n                    });\n                  },\n                  keyboardType: \"numeric\",\n                  placeholder: \"Current HP\",\n                  placeholderTextColor: THEME.text.light + '80',\n                  blurOnSubmit: false,\n                  autoComplete: \"off\",\n                  selectTextOnFocus: true,\n                  enablesReturnKeyAutomatically: true\n                })\n              }), _jsx(View, {\n                style: {\n                  flex: 1\n                },\n                children: _jsx(TextInput, {\n                  style: styles.input,\n                  value: String((selectedToken == null ? void 0 : selectedToken.maxHp) || ''),\n                  onChangeText: function onChangeText(text) {\n                    var maxHp = parseInt(text) || 1;\n                    setSelectedToken(function (prev) {\n                      return _objectSpread(_objectSpread({}, prev), {}, {\n                        maxHp: Math.max(1, maxHp)\n                      });\n                    });\n                  },\n                  keyboardType: \"numeric\",\n                  placeholder: \"Max HP\",\n                  placeholderTextColor: THEME.text.light + '80',\n                  blurOnSubmit: false,\n                  autoComplete: \"off\",\n                  selectTextOnFocus: true,\n                  enablesReturnKeyAutomatically: true\n                })\n              })]\n            }), _jsx(TextInput, {\n              style: styles.input,\n              value: String((selectedToken == null ? void 0 : selectedToken.initiativeBonus) || '0'),\n              onChangeText: function onChangeText(text) {\n                setSelectedToken(function (prev) {\n                  return _objectSpread(_objectSpread({}, prev), {}, {\n                    initiativeBonus: parseInt(text) || 0\n                  });\n                });\n              },\n              keyboardType: \"numeric\",\n              placeholder: \"Initiative Bonus\",\n              placeholderTextColor: THEME.text.light + '80',\n              blurOnSubmit: false,\n              autoComplete: \"off\",\n              selectTextOnFocus: true,\n              enablesReturnKeyAutomatically: true\n            }), _jsxs(View, {\n              style: statusStyles.effectsContainer,\n              children: [_jsx(Text, {\n                style: statusStyles.effectsTitle,\n                children: \"Status Effects\"\n              }), _jsx(View, {\n                style: statusStyles.effectsGrid,\n                children: STATUS_EFFECTS.map(function (effect) {\n                  var _selectedToken$effect;\n                  return _jsx(TouchableOpacity, {\n                    style: [statusStyles.effectButton, (selectedToken == null ? void 0 : (_selectedToken$effect = selectedToken.effects) == null ? void 0 : _selectedToken$effect.includes(effect.id)) && statusStyles.effectActive],\n                    onPress: function onPress() {\n                      setSelectedToken(function (prev) {\n                        var currentEffects = prev.effects || [];\n                        var newEffects = currentEffects.includes(effect.id) ? currentEffects.filter(function (e) {\n                          return e !== effect.id;\n                        }) : [].concat(_toConsumableArray(currentEffects), [effect.id]);\n                        return _objectSpread(_objectSpread({}, prev), {}, {\n                          effects: newEffects\n                        });\n                      });\n                    },\n                    children: _jsxs(Text, {\n                      style: statusStyles.effectText,\n                      children: [effect.icon, \" \", effect.name]\n                    })\n                  }, effect.id);\n                })\n              })]\n            }), _jsxs(View, {\n              style: styles.modalButtons,\n              children: [_jsx(TouchableOpacity, {\n                style: [styles.modalButton, {\n                  backgroundColor: THEME.danger\n                }],\n                onPress: function onPress() {\n                  if (firebaseRef.current && selectedToken) {\n                    var newTokens = _objectSpread({}, tokens);\n                    delete newTokens[selectedToken.position];\n                    set(firebaseRef.current, _objectSpread(_objectSpread({}, initialGameState), {}, {\n                      tokens: newTokens,\n                      layers: layers,\n                      initiative: initiative,\n                      inCombat: inCombat,\n                      currentTurn: currentTurn\n                    }));\n                    setShowTokenModal(false);\n                  }\n                },\n                children: _jsx(Text, {\n                  style: styles.buttonText,\n                  children: \"Delete\"\n                })\n              }), _jsx(TouchableOpacity, {\n                style: [styles.modalButton, {\n                  backgroundColor: THEME.success\n                }],\n                onPress: function onPress() {\n                  if (firebaseRef.current && selectedToken) {\n                    var newTokens = _objectSpread(_objectSpread({}, tokens), {}, _defineProperty({}, selectedToken.position, selectedToken));\n                    set(firebaseRef.current, _objectSpread(_objectSpread({}, initialGameState), {}, {\n                      tokens: newTokens,\n                      layers: layers,\n                      initiative: initiative,\n                      inCombat: inCombat,\n                      currentTurn: currentTurn\n                    }));\n                    setShowTokenModal(false);\n                  }\n                },\n                children: _jsx(Text, {\n                  style: styles.buttonText,\n                  children: \"Save\"\n                })\n              })]\n            })]\n          })\n        })\n      })\n    })\n  });\n});\nvar modalStyles = StyleSheet.create({\n  modalOverlay: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\n    justifyContent: 'center',\n    alignItems: 'center',\n    zIndex: 1000\n  },\n  modalContent: {\n    backgroundColor: THEME.background.panel,\n    padding: 20,\n    borderRadius: 10,\n    width: '90%',\n    maxWidth: 400,\n    zIndex: 1001\n  }\n});\nvar RoomModal = memo(function (_ref7) {\n  var showRoomModal = _ref7.showRoomModal,\n    setShowRoomModal = _ref7.setShowRoomModal,\n    isConnected = _ref7.isConnected,\n    roomCode = _ref7.roomCode,\n    setRoomCode = _ref7.setRoomCode,\n    isJoining = _ref7.isJoining,\n    connectToRoom = _ref7.connectToRoom;\n  return _jsx(Modal, {\n    visible: showRoomModal,\n    transparent: true,\n    animationType: \"fade\",\n    onRequestClose: function onRequestClose() {},\n    style: {\n      zIndex: 999\n    },\n    children: _jsx(View, {\n      style: [modalStyles.modalOverlay, {\n        pointerEvents: 'auto'\n      }],\n      children: _jsxs(View, {\n        style: modalStyles.modalContent,\n        children: [_jsx(Text, {\n          style: styles.modalTitle,\n          children: \"Join Room\"\n        }), _jsx(TextInput, {\n          style: [styles.input, {\n            marginBottom: 15,\n            zIndex: 1002\n          }],\n          value: roomCode,\n          onChangeText: function onChangeText(text) {\n            setRoomCode(text.trim().toLowerCase());\n          },\n          placeholder: \"Enter room code...\",\n          placeholderTextColor: THEME.text.light + '80',\n          autoCapitalize: \"none\",\n          autoCorrect: false,\n          editable: !isJoining,\n          autoFocus: true,\n          blurOnSubmit: false\n        }), _jsx(TouchableOpacity, {\n          style: [styles.modalButton, {\n            backgroundColor: isJoining ? THEME.background.secondary : THEME.success,\n            width: '100%',\n            zIndex: 1002\n          }],\n          onPress: function onPress() {\n            Keyboard.dismiss();\n            connectToRoom(roomCode);\n          },\n          disabled: isJoining,\n          children: isJoining ? _jsxs(View, {\n            style: styles.loadingButtonContent,\n            children: [_jsx(ActivityIndicator, {\n              color: THEME.text.light\n            }), _jsx(Text, {\n              style: [styles.buttonText, {\n                marginLeft: 10\n              }],\n              children: \"Connecting...\"\n            })]\n          }) : _jsx(Text, {\n            style: styles.buttonText,\n            children: \"Join Room\"\n          })\n        })]\n      })\n    })\n  });\n});\nvar PartyLootModal = memo(function (_ref8) {\n  var visible = _ref8.visible,\n    onClose = _ref8.onClose,\n    partyLoot = _ref8.partyLoot,\n    onUpdate = _ref8.onUpdate,\n    playerName = _ref8.playerName;\n  var _useState3 = useState({\n      currency: {\n        CP: 0,\n        SP: 0,\n        EP: 0,\n        GP: 0,\n        PP: 0\n      },\n      items: []\n    }),\n    _useState4 = _slicedToArray(_useState3, 2),\n    editedLoot = _useState4[0],\n    setEditedLoot = _useState4[1];\n  useEffect(function () {\n    if (visible && partyLoot) {\n      setEditedLoot({\n        currency: partyLoot.currency || {\n          CP: 0,\n          SP: 0,\n          EP: 0,\n          GP: 0,\n          PP: 0\n        },\n        items: partyLoot.items || []\n      });\n    }\n  }, [visible, partyLoot]);\n  if (!visible) return null;\n  return _jsx(Modal, {\n    visible: visible,\n    transparent: true,\n    animationType: \"fade\",\n    onRequestClose: onClose,\n    children: _jsx(View, {\n      style: styles.modalOverlay,\n      children: _jsxs(View, {\n        style: [styles.modalContent, {\n          maxHeight: '90%'\n        }],\n        children: [_jsx(Text, {\n          style: styles.modalTitle,\n          children: \"Party Loot\"\n        }), _jsxs(ScrollView, {\n          children: [_jsx(View, {\n            style: additionalStyles.lootSection,\n            children: CURRENCY.map(function (type) {\n              return _jsxs(View, {\n                style: additionalStyles.currencyRow,\n                children: [_jsx(Text, {\n                  style: additionalStyles.currencyLabel,\n                  children: type\n                }), _jsx(TextInput, {\n                  style: additionalStyles.currencyInput,\n                  value: String(editedLoot.currency[type] || 0),\n                  onChangeText: function onChangeText(text) {\n                    var value = parseInt(text) || 0;\n                    setEditedLoot(function (prev) {\n                      return _objectSpread(_objectSpread({}, prev), {}, {\n                        currency: _objectSpread(_objectSpread({}, prev.currency), {}, _defineProperty({}, type, value))\n                      });\n                    });\n                  },\n                  keyboardType: \"numeric\",\n                  placeholderTextColor: THEME.text.light + '80'\n                })]\n              }, type);\n            })\n          }), _jsxs(View, {\n            style: additionalStyles.lootSection,\n            children: [_jsxs(View, {\n              style: additionalStyles.lootHeader,\n              children: [_jsx(Text, {\n                style: additionalStyles.sectionTitle,\n                children: \"Items\"\n              }), _jsx(TouchableOpacity, {\n                style: additionalStyles.addButton,\n                onPress: function onPress() {\n                  setEditedLoot(function (prev) {\n                    return _objectSpread(_objectSpread({}, prev), {}, {\n                      items: [].concat(_toConsumableArray(prev.items), [{\n                        id: Date.now().toString(),\n                        name: '',\n                        quantity: 1,\n                        addedBy: playerName\n                      }])\n                    });\n                  });\n                },\n                children: _jsx(Text, {\n                  style: styles.buttonText,\n                  children: \"Add Item\"\n                })\n              })]\n            }), editedLoot.items.map(function (item, index) {\n              return _jsxs(View, {\n                style: additionalStyles.itemRow,\n                children: [_jsx(TextInput, {\n                  style: [additionalStyles.itemInput, {\n                    flex: 2\n                  }],\n                  value: item.name,\n                  onChangeText: function onChangeText(text) {\n                    var newItems = _toConsumableArray(editedLoot.items);\n                    newItems[index] = _objectSpread(_objectSpread({}, item), {}, {\n                      name: text\n                    });\n                    setEditedLoot(function (prev) {\n                      return _objectSpread(_objectSpread({}, prev), {}, {\n                        items: newItems\n                      });\n                    });\n                  },\n                  placeholder: \"Item name\",\n                  placeholderTextColor: THEME.text.light + '80'\n                }), _jsx(TextInput, {\n                  style: [additionalStyles.itemInput, {\n                    width: 60\n                  }],\n                  value: String(item.quantity),\n                  onChangeText: function onChangeText(text) {\n                    var newItems = _toConsumableArray(editedLoot.items);\n                    newItems[index] = _objectSpread(_objectSpread({}, item), {}, {\n                      quantity: parseInt(text) || 1\n                    });\n                    setEditedLoot(function (prev) {\n                      return _objectSpread(_objectSpread({}, prev), {}, {\n                        items: newItems\n                      });\n                    });\n                  },\n                  keyboardType: \"numeric\",\n                  placeholder: \"Qty\",\n                  placeholderTextColor: THEME.text.light + '80'\n                }), _jsx(TouchableOpacity, {\n                  style: additionalStyles.removeButton,\n                  onPress: function onPress() {\n                    setEditedLoot(function (prev) {\n                      return _objectSpread(_objectSpread({}, prev), {}, {\n                        items: prev.items.filter(function (_, i) {\n                          return i !== index;\n                        })\n                      });\n                    });\n                  },\n                  children: _jsx(Text, {\n                    style: styles.buttonText,\n                    children: \"\\xD7\"\n                  })\n                })]\n              }, item.id || index);\n            })]\n          })]\n        }), _jsxs(View, {\n          style: styles.buttonRow,\n          children: [_jsx(TouchableOpacity, {\n            style: [styles.button, styles.closeButton],\n            onPress: onClose,\n            children: _jsx(Text, {\n              style: styles.buttonText,\n              children: \"Cancel\"\n            })\n          }), _jsx(TouchableOpacity, {\n            style: [styles.button, {\n              backgroundColor: THEME.success\n            }],\n            onPress: function onPress() {\n              onUpdate(editedLoot);\n              onClose();\n            },\n            children: _jsx(Text, {\n              style: styles.buttonText,\n              children: \"Save Changes\"\n            })\n          })]\n        })]\n      })\n    })\n  });\n});\nvar GridZoomControls = memo(function (_ref9) {\n  var zoomLevel = _ref9.zoomLevel,\n    setZoomLevel = _ref9.setZoomLevel;\n  var debouncedZoom = debounce(function (newZoom) {\n    setZoomLevel(newZoom);\n  }, 100);\n  return _jsxs(View, {\n    style: styles.zoomControls,\n    children: [_jsx(TouchableOpacity, {\n      style: styles.zoomButton,\n      onPress: function onPress() {\n        return debouncedZoom(Math.max(0.5, zoomLevel - 0.1));\n      },\n      children: _jsx(Text, {\n        style: styles.buttonText,\n        children: \"-\"\n      })\n    }), _jsx(TouchableOpacity, {\n      style: styles.zoomButton,\n      onPress: function onPress() {\n        return debouncedZoom(Math.min(2, zoomLevel + 0.1));\n      },\n      children: _jsx(Text, {\n        style: styles.buttonText,\n        children: \"+\"\n      })\n    })]\n  });\n});\nvar InventoryModal = memo(function (_ref10) {\n  var visible = _ref10.visible,\n    onClose = _ref10.onClose,\n    character = _ref10.character,\n    onUpdate = _ref10.onUpdate;\n  var _useState5 = useState({\n      currency: (character == null ? void 0 : character.currency) || {\n        CP: 0,\n        SP: 0,\n        EP: 0,\n        GP: 0,\n        PP: 0\n      },\n      inventory: (character == null ? void 0 : character.inventory) || []\n    }),\n    _useState6 = _slicedToArray(_useState5, 2),\n    editedInventory = _useState6[0],\n    setEditedInventory = _useState6[1];\n  useEffect(function () {\n    if (visible && character) {\n      setEditedInventory({\n        currency: character.currency || {\n          CP: 0,\n          SP: 0,\n          EP: 0,\n          GP: 0,\n          PP: 0\n        },\n        inventory: character.inventory || []\n      });\n    }\n  }, [visible, character]);\n  if (!visible || !character) return null;\n  return _jsx(Modal, {\n    visible: visible,\n    transparent: true,\n    animationType: \"fade\",\n    onRequestClose: onClose,\n    children: _jsx(View, {\n      style: styles.modalOverlay,\n      children: _jsxs(View, {\n        style: additionalStyles.characterSheet,\n        children: [_jsx(TouchableOpacity, {\n          style: additionalStyles.closeButton,\n          onPress: onClose,\n          children: _jsx(Text, {\n            style: additionalStyles.closeButtonText,\n            children: \"\\xD7\"\n          })\n        }), _jsxs(Text, {\n          style: additionalStyles.sectionTitle,\n          children: [character.name, \"'s Inventory\"]\n        }), _jsxs(GestureScrollView, {\n          children: [_jsx(View, {\n            style: additionalStyles.lootSection,\n            children: CURRENCY.map(function (currency) {\n              return _jsxs(View, {\n                style: additionalStyles.currencyRow,\n                children: [_jsx(Text, {\n                  style: additionalStyles.currencyLabel,\n                  children: currency\n                }), _jsx(TextInput, {\n                  style: additionalStyles.currencyInput,\n                  value: String(editedInventory.currency[currency] || 0),\n                  onChangeText: function onChangeText(text) {\n                    var value = parseInt(text) || 0;\n                    setEditedInventory(function (prev) {\n                      return _objectSpread(_objectSpread({}, prev), {}, {\n                        currency: _objectSpread(_objectSpread({}, prev.currency), {}, _defineProperty({}, currency, value))\n                      });\n                    });\n                  },\n                  keyboardType: \"numeric\",\n                  placeholderTextColor: THEME.text.light + '80'\n                })]\n              }, currency);\n            })\n          }), _jsxs(View, {\n            style: additionalStyles.lootSection,\n            children: [_jsxs(View, {\n              style: additionalStyles.lootHeader,\n              children: [_jsx(Text, {\n                style: additionalStyles.sectionTitle,\n                children: \"Items\"\n              }), _jsx(TouchableOpacity, {\n                style: additionalStyles.addButton,\n                onPress: function onPress() {\n                  setEditedInventory(function (prev) {\n                    return _objectSpread(_objectSpread({}, prev), {}, {\n                      inventory: [].concat(_toConsumableArray(prev.inventory), [{\n                        name: '',\n                        quantity: 1,\n                        notes: '',\n                        addedBy: character.name\n                      }])\n                    });\n                  });\n                },\n                children: _jsx(Text, {\n                  style: styles.buttonText,\n                  children: \"Add Item\"\n                })\n              })]\n            }), editedInventory.inventory.map(function (item, index) {\n              return _jsxs(View, {\n                style: additionalStyles.itemRow,\n                children: [_jsxs(View, {\n                  style: additionalStyles.itemInfo,\n                  children: [_jsx(TextInput, {\n                    style: [additionalStyles.itemInput, {\n                      flex: 2\n                    }],\n                    value: item.name,\n                    onChangeText: function onChangeText(text) {\n                      var newInventory = _toConsumableArray(editedInventory.inventory);\n                      newInventory[index] = _objectSpread(_objectSpread({}, item), {}, {\n                        name: text\n                      });\n                      setEditedInventory(function (prev) {\n                        return _objectSpread(_objectSpread({}, prev), {}, {\n                          inventory: newInventory\n                        });\n                      });\n                    },\n                    placeholder: \"Item name\",\n                    placeholderTextColor: THEME.text.light + '80'\n                  }), _jsx(TextInput, {\n                    style: [additionalStyles.itemInput, {\n                      width: 60\n                    }],\n                    value: String(item.quantity),\n                    onChangeText: function onChangeText(text) {\n                      var newInventory = _toConsumableArray(editedInventory.inventory);\n                      newInventory[index] = _objectSpread(_objectSpread({}, item), {}, {\n                        quantity: parseInt(text) || 1\n                      });\n                      setEditedInventory(function (prev) {\n                        return _objectSpread(_objectSpread({}, prev), {}, {\n                          inventory: newInventory\n                        });\n                      });\n                    },\n                    keyboardType: \"numeric\",\n                    placeholder: \"Qty\",\n                    placeholderTextColor: THEME.text.light + '80'\n                  }), item.addedBy === character.name && _jsx(TouchableOpacity, {\n                    style: additionalStyles.removeButton,\n                    onPress: function onPress() {\n                      setEditedInventory(function (prev) {\n                        return _objectSpread(_objectSpread({}, prev), {}, {\n                          inventory: prev.inventory.filter(function (_, i) {\n                            return i !== index;\n                          })\n                        });\n                      });\n                    },\n                    children: _jsx(Text, {\n                      style: styles.buttonText,\n                      children: \"\\xD7\"\n                    })\n                  })]\n                }), _jsxs(Text, {\n                  style: additionalStyles.addedBy,\n                  children: [\"Added by: \", item.addedBy]\n                })]\n              }, index);\n            })]\n          }), _jsx(TouchableOpacity, {\n            style: [styles.modalButton, {\n              backgroundColor: THEME.success\n            }],\n            onPress: function onPress() {\n              onUpdate(_objectSpread(_objectSpread({}, character), {}, {\n                currency: editedInventory.currency,\n                inventory: editedInventory.inventory\n              }));\n              onClose();\n            },\n            children: _jsx(Text, {\n              style: styles.buttonText,\n              children: \"Save Changes\"\n            })\n          })]\n        })]\n      })\n    })\n  });\n});\nvar PlayerNameModal = memo(function (_ref11) {\n  var visible = _ref11.visible,\n    onSubmit = _ref11.onSubmit;\n  var _useState7 = useState(''),\n    _useState8 = _slicedToArray(_useState7, 2),\n    name = _useState8[0],\n    setName = _useState8[1];\n  return _jsx(Modal, {\n    visible: visible,\n    transparent: true,\n    animationType: \"fade\",\n    onRequestClose: function onRequestClose() {},\n    children: _jsx(View, {\n      style: styles.modalOverlay,\n      children: _jsxs(View, {\n        style: styles.modalContent,\n        children: [_jsx(Text, {\n          style: styles.modalTitle,\n          children: \"Enter Your Name\"\n        }), _jsx(TextInput, {\n          style: styles.input,\n          value: name,\n          onChangeText: setName,\n          placeholder: \"Your name\",\n          placeholderTextColor: THEME.text.light + '80',\n          autoCapitalize: \"words\"\n        }), _jsx(TouchableOpacity, {\n          style: [styles.modalButton, {\n            backgroundColor: THEME.success,\n            width: '100%',\n            marginTop: 10\n          }],\n          onPress: function onPress() {\n            return onSubmit(name);\n          },\n          disabled: !name.trim(),\n          children: _jsx(Text, {\n            style: styles.buttonText,\n            children: \"Continue\"\n          })\n        })]\n      })\n    })\n  });\n});\nvar viewerStyles = StyleSheet.create({\n  viewersList: {\n    marginTop: 15,\n    padding: 10,\n    backgroundColor: THEME.background.primary,\n    borderRadius: 5\n  },\n  viewersTitle: {\n    color: THEME.text.light,\n    fontSize: 14,\n    fontWeight: 'bold',\n    marginBottom: 5\n  },\n  viewerName: {\n    color: THEME.text.light,\n    opacity: 0.8,\n    fontSize: 12,\n    marginBottom: 2\n  }\n});\nvar calculateModifier = function calculateModifier(score) {\n  return Math.floor((score - 10) / 2);\n};\nvar DiceResultModal = memo(function (_ref12) {\n  var visible = _ref12.visible,\n    result = _ref12.result,\n    onClose = _ref12.onClose;\n  useEffect(function () {\n    if (visible) {\n      var timer = setTimeout(onClose, 2000);\n      return function () {\n        return clearTimeout(timer);\n      };\n    }\n  }, [visible, onClose]);\n  if (!visible || !result) return null;\n  return _jsx(View, {\n    style: {\n      position: 'fixed',\n      top: 0,\n      left: 0,\n      right: 0,\n      bottom: 0,\n      justifyContent: 'center',\n      alignItems: 'center',\n      zIndex: 9999,\n      backgroundColor: 'rgba(0, 0, 0, 0.5)'\n    },\n    children: _jsxs(View, {\n      style: {\n        backgroundColor: THEME.background.panel + 'E6',\n        padding: 20,\n        borderRadius: 10,\n        alignItems: 'center',\n        minWidth: 200,\n        maxWidth: '90%',\n        shadowColor: '#000',\n        shadowOffset: {\n          width: 0,\n          height: 2\n        },\n        shadowOpacity: 0.25,\n        shadowRadius: 3.84,\n        elevation: 5\n      },\n      children: [_jsxs(Text, {\n        style: {\n          color: THEME.text.light,\n          fontSize: 18,\n          marginBottom: 5\n        },\n        children: [result.dice, \" \", result.rollType !== 'normal' ? \"(\" + result.rollType + \")\" : '']\n      }), _jsx(Text, {\n        style: {\n          color: THEME.accent,\n          fontSize: 32,\n          fontWeight: 'bold',\n          marginBottom: 5\n        },\n        children: result.total\n      }), _jsxs(Text, {\n        style: {\n          color: THEME.text.light + '80',\n          fontSize: 14\n        },\n        children: [\"Rolls: [\", result.rolls.join(', '), \"]\", result.modifier !== 0 && \" + \" + result.modifier]\n      })]\n    })\n  });\n});\nvar DeleteCharacterModal = memo(function (_ref13) {\n  var visible = _ref13.visible,\n    character = _ref13.character,\n    onClose = _ref13.onClose,\n    onConfirm = _ref13.onConfirm;\n  var _useState9 = useState(''),\n    _useState10 = _slicedToArray(_useState9, 2),\n    confirmName = _useState10[0],\n    setConfirmName = _useState10[1];\n  return _jsx(Modal, {\n    visible: visible,\n    transparent: true,\n    animationType: \"fade\",\n    onRequestClose: onClose,\n    children: _jsx(View, {\n      style: styles.modalOverlay,\n      children: _jsxs(View, {\n        style: styles.modalContent,\n        children: [_jsx(Text, {\n          style: styles.modalTitle,\n          children: \"Delete Character\"\n        }), _jsxs(Text, {\n          style: [styles.buttonText, {\n            marginBottom: 10,\n            textAlign: 'center'\n          }],\n          children: [\"Type \\\"\", character == null ? void 0 : character.name, \"\\\" to confirm deletion\"]\n        }), _jsx(TextInput, {\n          style: styles.input,\n          value: confirmName,\n          onChangeText: setConfirmName,\n          placeholder: \"Character name\",\n          placeholderTextColor: THEME.text.light + '80'\n        }), _jsxs(View, {\n          style: [styles.modalButtons, {\n            marginTop: 15\n          }],\n          children: [_jsx(TouchableOpacity, {\n            style: [styles.modalButton, {\n              backgroundColor: THEME.background.secondary\n            }],\n            onPress: onClose,\n            children: _jsx(Text, {\n              style: styles.buttonText,\n              children: \"Cancel\"\n            })\n          }), _jsx(TouchableOpacity, {\n            style: [styles.modalButton, {\n              backgroundColor: confirmName === (character == null ? void 0 : character.name) ? THEME.danger : THEME.background.secondary,\n              opacity: confirmName === (character == null ? void 0 : character.name) ? 1 : 0.5\n            }],\n            onPress: function onPress() {\n              if (confirmName === (character == null ? void 0 : character.name)) {\n                onConfirm();\n              }\n            },\n            disabled: confirmName !== (character == null ? void 0 : character.name),\n            children: _jsx(Text, {\n              style: styles.buttonText,\n              children: \"Delete\"\n            })\n          })]\n        })]\n      })\n    })\n  });\n});\nvar EnemySelectModal = memo(function (_ref14) {\n  var visible = _ref14.visible,\n    onClose = _ref14.onClose,\n    onSelect = _ref14.onSelect;\n  return _jsx(Modal, {\n    visible: visible,\n    transparent: true,\n    animationType: \"fade\",\n    onRequestClose: onClose,\n    children: _jsx(View, {\n      style: styles.modalOverlay,\n      children: _jsxs(View, {\n        style: styles.modalContent,\n        children: [_jsx(Text, {\n          style: styles.modalTitle,\n          children: \"Select Enemy\"\n        }), _jsx(ScrollView, {\n          style: {\n            maxHeight: 300\n          },\n          children: COMMON_ENEMIES.map(function (enemy, index) {\n            return _jsxs(TouchableOpacity, {\n              style: [styles.enemyOption, {\n                backgroundColor: THEME.background.secondary\n              }],\n              onPress: function onPress() {\n                return onSelect(enemy);\n              },\n              children: [_jsx(Text, {\n                style: styles.buttonText,\n                children: enemy.name\n              }), _jsxs(Text, {\n                style: [styles.buttonText, {\n                  opacity: 0.7,\n                  fontSize: 12\n                }],\n                children: [\"HP: \", enemy.hp, \" \\u2022 AC: \", enemy.ac]\n              })]\n            }, index);\n          })\n        }), _jsx(TouchableOpacity, {\n          style: [styles.modalButton, {\n            backgroundColor: THEME.background.secondary,\n            marginTop: 10\n          }],\n          onPress: onClose,\n          children: _jsx(Text, {\n            style: styles.buttonText,\n            children: \"Cancel\"\n          })\n        })]\n      })\n    })\n  });\n});\nexport default function App() {\n  var _tokens$initiative$cu, _initiative$currentTu2, _initiative$currentTu3;\n  var calculateModifier = function calculateModifier(score) {\n    return Math.floor((score - 10) / 2);\n  };\n  var _useState11 = useState(''),\n    _useState12 = _slicedToArray(_useState11, 2),\n    roomCode = _useState12[0],\n    setRoomCode = _useState12[1];\n  var _useState13 = useState(false),\n    _useState14 = _slicedToArray(_useState13, 2),\n    isConnected = _useState14[0],\n    setIsConnected = _useState14[1];\n  var _useState15 = useState(false),\n    _useState16 = _slicedToArray(_useState15, 2),\n    isLoading = _useState16[0],\n    setIsLoading = _useState16[1];\n  var _useState17 = useState(false),\n    _useState18 = _slicedToArray(_useState17, 2),\n    isJoining = _useState18[0],\n    setIsJoining = _useState18[1];\n  var _useState19 = useState(false),\n    _useState20 = _slicedToArray(_useState19, 2),\n    isUpdating = _useState20[0],\n    setIsUpdating = _useState20[1];\n  var _useState21 = useState(true),\n    _useState22 = _slicedToArray(_useState21, 2),\n    showRoomModal = _useState22[0],\n    setShowRoomModal = _useState22[1];\n  var _useState23 = useState(true),\n    _useState24 = _slicedToArray(_useState23, 2),\n    isDarkMode = _useState24[0],\n    setIsDarkMode = _useState24[1];\n  var _useState25 = useState(isSmallScreen ? 0.8 : 1),\n    _useState26 = _slicedToArray(_useState25, 2),\n    zoomLevel = _useState26[0],\n    setZoomLevel = _useState26[1];\n  var _useState27 = useState({}),\n    _useState28 = _slicedToArray(_useState27, 2),\n    tokens = _useState28[0],\n    setTokens = _useState28[1];\n  var _useState29 = useState(COLORS[0]),\n    _useState30 = _slicedToArray(_useState29, 2),\n    currentColor = _useState30[0],\n    setCurrentColor = _useState30[1];\n  var _useState31 = useState([]),\n    _useState32 = _slicedToArray(_useState31, 2),\n    initiative = _useState32[0],\n    setInitiative = _useState32[1];\n  var _useState33 = useState(false),\n    _useState34 = _slicedToArray(_useState33, 2),\n    inCombat = _useState34[0],\n    setInCombat = _useState34[1];\n  var _useState35 = useState(0),\n    _useState36 = _slicedToArray(_useState35, 2),\n    currentTurn = _useState36[0],\n    setCurrentTurn = _useState36[1];\n  var _useState37 = useState(initialGameState.layers),\n    _useState38 = _slicedToArray(_useState37, 2),\n    layers = _useState38[0],\n    setLayers = _useState38[1];\n  var _useState39 = useState([]),\n    _useState40 = _slicedToArray(_useState39, 2),\n    diceHistory = _useState40[0],\n    setDiceHistory = _useState40[1];\n  var _useState41 = useState(false),\n    _useState42 = _slicedToArray(_useState41, 2),\n    advantage = _useState42[0],\n    setAdvantage = _useState42[1];\n  var _useState43 = useState(0),\n    _useState44 = _slicedToArray(_useState43, 2),\n    modifier = _useState44[0],\n    setModifier = _useState44[1];\n  var _useState45 = useState(null),\n    _useState46 = _slicedToArray(_useState45, 2),\n    selectedToken = _useState46[0],\n    setSelectedToken = _useState46[1];\n  var _useState47 = useState(false),\n    _useState48 = _slicedToArray(_useState47, 2),\n    showTokenModal = _useState48[0],\n    setShowTokenModal = _useState48[1];\n  var _useState49 = useState({\n      currency: {\n        CP: 0,\n        SP: 0,\n        EP: 0,\n        GP: 0,\n        PP: 0\n      },\n      items: [],\n      currentViewer: null\n    }),\n    _useState50 = _slicedToArray(_useState49, 2),\n    partyLoot = _useState50[0],\n    setPartyLoot = _useState50[1];\n  var _useState51 = useState(false),\n    _useState52 = _slicedToArray(_useState51, 2),\n    showPartyLoot = _useState52[0],\n    setShowPartyLoot = _useState52[1];\n  var _useState53 = useState(1),\n    _useState54 = _slicedToArray(_useState53, 2),\n    diceQuantity = _useState54[0],\n    setDiceQuantity = _useState54[1];\n  var _useState55 = useState([]),\n    _useState56 = _slicedToArray(_useState55, 2),\n    characters = _useState56[0],\n    setCharacters = _useState56[1];\n  var _useState57 = useState(false),\n    _useState58 = _slicedToArray(_useState57, 2),\n    showCharacterSheet = _useState58[0],\n    setShowCharacterSheet = _useState58[1];\n  var _useState59 = useState(null),\n    _useState60 = _slicedToArray(_useState59, 2),\n    selectedCharacter = _useState60[0],\n    setSelectedCharacter = _useState60[1];\n  var _useState61 = useState(false),\n    _useState62 = _slicedToArray(_useState61, 2),\n    showInventory = _useState62[0],\n    setShowInventory = _useState62[1];\n  var _useState63 = useState(''),\n    _useState64 = _slicedToArray(_useState63, 2),\n    playerName = _useState64[0],\n    setPlayerName = _useState64[1];\n  var _useState65 = useState(true),\n    _useState66 = _slicedToArray(_useState65, 2),\n    showPlayerNameModal = _useState66[0],\n    setShowPlayerNameModal = _useState66[1];\n  var _useState67 = useState('normal'),\n    _useState68 = _slicedToArray(_useState67, 2),\n    rollType = _useState68[0],\n    setRollType = _useState68[1];\n  var _useState69 = useState(null),\n    _useState70 = _slicedToArray(_useState69, 2),\n    diceResult = _useState70[0],\n    setDiceResult = _useState70[1];\n  var _useState71 = useState(false),\n    _useState72 = _slicedToArray(_useState71, 2),\n    showDiceResult = _useState72[0],\n    setShowDiceResult = _useState72[1];\n  var _useState73 = useState(false),\n    _useState74 = _slicedToArray(_useState73, 2),\n    showDeleteModal = _useState74[0],\n    setShowDeleteModal = _useState74[1];\n  var _useState75 = useState(false),\n    _useState76 = _slicedToArray(_useState75, 2),\n    isDM = _useState76[0],\n    setIsDM = _useState76[1];\n  var _useState77 = useState(false),\n    _useState78 = _slicedToArray(_useState77, 2),\n    showEnemySelect = _useState78[0],\n    setShowEnemySelect = _useState78[1];\n  var _useState79 = useState(null),\n    _useState80 = _slicedToArray(_useState79, 2),\n    selectedPosition = _useState80[0],\n    setSelectedPosition = _useState80[1];\n  var firebaseRef = useRef(null);\n  var unsubscribeRef = useRef(null);\n  var handleDisconnect = useCallback(function () {\n    try {\n      if (unsubscribeRef.current) {\n        unsubscribeRef.current();\n        unsubscribeRef.current = null;\n      }\n      if (firebaseRef.current) {\n        off(firebaseRef.current);\n        firebaseRef.current = null;\n      }\n      setIsConnected(false);\n      setRoomCode('');\n      setTokens({});\n      setLayers(initialGameState.layers);\n      setInitiative([]);\n      setInCombat(false);\n      setCurrentTurn(0);\n      setDiceHistory([]);\n      setAdvantage(false);\n      setModifier(0);\n      setSelectedToken(null);\n      setShowTokenModal(false);\n      setPartyLoot(initialGameState.partyLoot);\n      setZoomLevel(isSmallScreen ? 0.8 : 1);\n    } catch (error) {\n      console.error('Error during disconnect:', error);\n      Alert.alert('Error', 'Failed to leave room properly. Please try again.');\n    }\n  }, []);\n  var handleInitiativeRoll = useCallback(function () {\n    if (!tokens || Object.keys(tokens).length === 0) {\n      Alert.alert('Error', 'No tokens on the board');\n      return;\n    }\n    var rolls = Object.entries(tokens).map(function (_ref15) {\n      var _ref16 = _slicedToArray(_ref15, 2),\n        position = _ref16[0],\n        token = _ref16[1];\n      var roll = Math.floor(Math.random() * 20) + 1;\n      var initiative = roll + (token.initiativeBonus || 0);\n      return {\n        position: position,\n        initiative: initiative,\n        details: token.name + \" (\" + initiative + \")\"\n      };\n    });\n    rolls.sort(function (a, b) {\n      return b.initiative - a.initiative;\n    });\n    if (firebaseRef.current) {\n      set(firebaseRef.current, _objectSpread(_objectSpread({}, initialGameState), {}, {\n        tokens: tokens,\n        layers: layers,\n        initiative: rolls,\n        inCombat: true,\n        currentTurn: 0\n      }));\n    }\n    setInitiative(rolls);\n    setInCombat(true);\n    setCurrentTurn(0);\n  }, [tokens, layers]);\n  var rollDice = useCallback(function (sides) {\n    var allRolls = [];\n    for (var d = 0; d < diceQuantity; d++) {\n      var rolls = [];\n      var numRolls = rollType !== 'normal' ? 2 : 1;\n      for (var i = 0; i < numRolls; i++) {\n        rolls.push(Math.floor(Math.random() * sides) + 1);\n      }\n      var finalRoll = rollType === 'advantage' ? Math.max.apply(Math, rolls) : rollType === 'disadvantage' ? Math.min.apply(Math, rolls) : rolls[0];\n      allRolls.push({\n        rolls: rolls,\n        total: finalRoll\n      });\n    }\n    var grandTotal = allRolls.reduce(function (sum, roll) {\n      return sum + roll.total;\n    }, 0) + modifier;\n    var newResult = {\n      dice: diceQuantity + \"d\" + sides,\n      rolls: allRolls.map(function (r) {\n        return r.rolls;\n      }).flat(),\n      individualTotals: allRolls.map(function (r) {\n        return r.total;\n      }),\n      modifier: modifier,\n      rollType: rollType,\n      total: grandTotal,\n      timestamp: Date.now()\n    };\n    setDiceHistory(function (prev) {\n      return [newResult].concat(_toConsumableArray(prev.slice(0, 49)));\n    });\n    Vibration.vibrate(50);\n  }, [rollType, modifier, diceQuantity]);\n  var handleCellPress = useCallback(function () {\n    var _ref17 = _asyncToGenerator(function* (row, col) {\n      if (!firebaseRef.current) return;\n      try {\n        var position = row + \"-\" + col;\n        var newTokens = _objectSpread({}, tokens);\n        if (tokens[position]) {\n          delete newTokens[position];\n        } else {\n          if (isDM) {\n            setSelectedPosition(position);\n            setShowEnemySelect(true);\n            return;\n          } else {\n            if (!selectedCharacter) {\n              Alert.alert('No Character Selected', 'Please select a character from your list first.');\n              return;\n            }\n            newTokens[position] = {\n              name: selectedCharacter.name,\n              color: currentColor,\n              hp: selectedCharacter.hp,\n              maxHp: selectedCharacter.maxHp,\n              ac: selectedCharacter.ac,\n              initiativeBonus: calculateModifier(selectedCharacter.abilityScores.DEX),\n              effects: [],\n              position: position,\n              owner: playerName\n            };\n          }\n        }\n        yield set(firebaseRef.current, {\n          tokens: newTokens,\n          layers: layers,\n          initiative: initiative,\n          inCombat: inCombat,\n          currentTurn: currentTurn,\n          partyLoot: partyLoot,\n          lastUpdate: Date.now()\n        });\n        setTokens(newTokens);\n      } catch (error) {\n        console.error('Error updating tokens:', error);\n        Alert.alert('Error', 'Failed to update token');\n      }\n    });\n    return function (_x, _x2) {\n      return _ref17.apply(this, arguments);\n    };\n  }(), [tokens, currentColor, layers, initiative, inCombat, currentTurn, partyLoot, selectedCharacter, playerName, isDM]);\n  var savePlayerData = useCallback(function () {\n    var _ref18 = _asyncToGenerator(function* (updatedCharacters) {\n      if (!playerName || !roomCode) return;\n      try {\n        var roomPlayerRef = ref(database, \"rooms/\" + roomCode + \"/players/\" + playerName);\n        var globalPlayerRef = ref(database, \"players/\" + playerName);\n        var playerData = {\n          characters: updatedCharacters,\n          lastUpdate: Date.now()\n        };\n        yield Promise.all([set(roomPlayerRef, playerData), set(globalPlayerRef, playerData)]);\n      } catch (error) {\n        console.error('Error saving player data:', error);\n        Alert.alert('Error', 'Failed to save character data');\n      }\n    });\n    return function (_x3) {\n      return _ref18.apply(this, arguments);\n    };\n  }(), [playerName, roomCode]);\n  var connectToRoom = useCallback(function () {\n    var _ref19 = _asyncToGenerator(function* (code) {\n      if (!code.trim() || !playerName) {\n        Alert.alert(\"Error\", \"Please enter a room code and player name\");\n        return;\n      }\n      setIsJoining(true);\n      setIsLoading(true);\n      try {\n        var globalPlayerRef = ref(database, \"players/\" + playerName);\n        var playerSnapshot = yield get(globalPlayerRef);\n        if (playerSnapshot.exists()) {\n          var playerData = playerSnapshot.val();\n          setCharacters(playerData.characters || []);\n        }\n        var gameRef = ref(database, \"rooms/\" + code);\n        firebaseRef.current = gameRef;\n        var snapshot = yield get(gameRef);\n        if (!snapshot.exists()) {\n          yield set(gameRef, initialGameState);\n        }\n        var unsubscribe = onValue(gameRef, function (snapshot) {\n          var data = snapshot.val();\n          if (data) {\n            setTokens(data.tokens || {});\n            setLayers(data.layers || initialGameState.layers);\n            setInitiative(data.initiative || []);\n            setInCombat(data.inCombat || false);\n            setCurrentTurn(data.currentTurn || 0);\n            setPartyLoot(data.partyLoot || initialGameState.partyLoot);\n            if (data.players && data.players[playerName]) {\n              setCharacters(data.players[playerName].characters || []);\n            }\n          }\n        });\n        unsubscribeRef.current = unsubscribe;\n        setRoomCode(code);\n        setShowRoomModal(false);\n        setIsConnected(true);\n      } catch (error) {\n        console.error('Connection error:', error);\n        Alert.alert(\"Error\", \"Failed to join room. Please try again.\");\n        setIsConnected(false);\n      } finally {\n        setIsJoining(false);\n        setIsLoading(false);\n      }\n    });\n    return function (_x4) {\n      return _ref19.apply(this, arguments);\n    };\n  }(), [playerName]);\n  useEffect(function () {\n    var handleOffline = function handleOffline() {\n      Alert.alert('Connection Lost', 'Please check your internet connection', [{\n        text: 'OK'\n      }]);\n    };\n    window.addEventListener('offline', handleOffline);\n    return function () {\n      window.removeEventListener('offline', handleOffline);\n      if (unsubscribeRef.current) {\n        unsubscribeRef.current();\n      }\n      if (firebaseRef.current) {\n        off(firebaseRef.current);\n      }\n    };\n  }, []);\n  var layoutStyles = {\n    sidePanel: {\n      backgroundColor: THEME.background.panel,\n      padding: 15,\n      borderRadius: 10,\n      marginBottom: 15,\n      width: '100%'\n    },\n    sidePanelTitle: {\n      color: THEME.text.light,\n      fontSize: 18,\n      fontWeight: 'bold',\n      marginBottom: 10\n    },\n    buttonRow: {\n      flexDirection: 'row',\n      gap: 10,\n      marginBottom: 10\n    },\n    panelButton: {\n      backgroundColor: THEME.background.primary,\n      padding: 10,\n      borderRadius: 5,\n      alignItems: 'center',\n      flex: 1\n    },\n    panelButtonText: {\n      color: THEME.text.light,\n      fontWeight: 'bold'\n    },\n    characterItem: {\n      padding: 10,\n      borderRadius: 5,\n      marginBottom: 5,\n      backgroundColor: THEME.background.secondary\n    },\n    characterInfo: {\n      flexDirection: 'row',\n      justifyContent: 'space-between',\n      alignItems: 'center'\n    },\n    characterName: {\n      color: THEME.text.light,\n      fontWeight: 'bold'\n    },\n    characterDetails: {\n      color: THEME.text.light,\n      opacity: 0.8\n    }\n  };\n  var handleDeleteCharacter = useCallback(_asyncToGenerator(function* () {\n    if (!selectedCharacter) return;\n    try {\n      var newCharacters = characters.filter(function (char) {\n        return char.name !== selectedCharacter.name;\n      });\n      setCharacters(newCharacters);\n      yield savePlayerData(newCharacters);\n      setSelectedCharacter(null);\n      setShowDeleteModal(false);\n    } catch (error) {\n      console.error('Error deleting character:', error);\n      Alert.alert('Error', 'Failed to delete character');\n    }\n  }), [selectedCharacter, characters, savePlayerData]);\n  var handleEnemySelect = useCallback(function () {\n    var _ref21 = _asyncToGenerator(function* (enemy) {\n      if (!selectedPosition || !firebaseRef.current) return;\n      try {\n        var newTokens = _objectSpread({}, tokens);\n        newTokens[selectedPosition] = _objectSpread(_objectSpread({}, enemy), {}, {\n          position: selectedPosition,\n          effects: [],\n          owner: 'DM'\n        });\n        yield set(firebaseRef.current, {\n          tokens: newTokens,\n          layers: layers,\n          initiative: initiative,\n          inCombat: inCombat,\n          currentTurn: currentTurn,\n          partyLoot: partyLoot,\n          lastUpdate: Date.now()\n        });\n        setTokens(newTokens);\n        setShowEnemySelect(false);\n        setSelectedPosition(null);\n      } catch (error) {\n        console.error('Error adding enemy:', error);\n        Alert.alert('Error', 'Failed to add enemy');\n      }\n    });\n    return function (_x5) {\n      return _ref21.apply(this, arguments);\n    };\n  }(), [selectedPosition, tokens, layers, initiative, inCombat, currentTurn, partyLoot]);\n  return _jsxs(SafeAreaView, {\n    style: [styles.container, isDarkMode && styles.darkMode],\n    children: [_jsxs(View, {\n      style: styles.container,\n      children: [_jsx(TokenModal, {\n        showTokenModal: showTokenModal,\n        setShowTokenModal: setShowTokenModal,\n        selectedToken: selectedToken,\n        setSelectedToken: setSelectedToken,\n        tokens: tokens,\n        firebaseRef: firebaseRef,\n        initialGameState: initialGameState,\n        layers: layers,\n        initiative: initiative,\n        inCombat: inCombat,\n        currentTurn: currentTurn,\n        THEME: THEME\n      }), _jsx(RoomModal, {\n        showRoomModal: showRoomModal,\n        setShowRoomModal: setShowRoomModal,\n        isConnected: isConnected,\n        roomCode: roomCode,\n        setRoomCode: setRoomCode,\n        isJoining: isJoining,\n        connectToRoom: connectToRoom\n      }), _jsx(PlayerNameModal, {\n        visible: showPlayerNameModal && !playerName,\n        onSubmit: function onSubmit(name) {\n          setPlayerName(name);\n          setShowPlayerNameModal(false);\n          setIsConnected(true);\n        }\n      }), _jsx(DiceResultModal, {\n        visible: showDiceResult,\n        result: diceResult,\n        onClose: function onClose() {\n          return setShowDiceResult(false);\n        }\n      }), _jsx(PartyLootModal, {\n        visible: showPartyLoot,\n        onClose: function onClose() {\n          return setShowPartyLoot(false);\n        },\n        partyLoot: partyLoot,\n        playerName: playerName,\n        onUpdate: function onUpdate(updatedLoot) {\n          setPartyLoot(updatedLoot);\n          if (firebaseRef.current) {\n            set(firebaseRef.current, _objectSpread(_objectSpread({}, initialGameState), {}, {\n              tokens: tokens,\n              layers: layers,\n              initiative: initiative,\n              inCombat: inCombat,\n              currentTurn: currentTurn,\n              partyLoot: updatedLoot\n            }));\n          }\n        }\n      }), _jsx(CharacterSheetModal, {\n        visible: showCharacterSheet,\n        onClose: function onClose() {\n          return setShowCharacterSheet(false);\n        },\n        character: selectedCharacter || {\n          name: '',\n          class: '',\n          level: 1,\n          owner: playerName,\n          proficiencyBonus: 2,\n          hp: 0,\n          maxHp: 0,\n          ac: 10,\n          abilityScores: {\n            STR: 10,\n            DEX: 10,\n            CON: 10,\n            INT: 10,\n            WIS: 10,\n            CHA: 10\n          },\n          proficientSkills: [],\n          currency: {\n            CP: 0,\n            SP: 0,\n            EP: 0,\n            GP: 0,\n            PP: 0\n          },\n          items: [],\n          inventory: []\n        },\n        characters: characters,\n        onUpdate: (function () {\n          var _ref22 = _asyncToGenerator(function* (updatedCharacter) {\n            try {\n              if (!updatedCharacter) {\n                throw new Error('No character data to save');\n              }\n              var newCharacters = selectedCharacter ? characters.map(function (char) {\n                return char.name === selectedCharacter.name ? updatedCharacter : char;\n              }) : [].concat(_toConsumableArray(characters), [updatedCharacter]);\n              setCharacters(newCharacters);\n              var playerRef = ref(database, \"players/\" + playerName);\n              yield set(playerRef, {\n                characters: newCharacters,\n                lastUpdate: Date.now()\n              });\n              if (firebaseRef.current) {\n                var roomPlayerRef = ref(database, \"rooms/\" + roomCode + \"/players/\" + playerName);\n                yield set(roomPlayerRef, {\n                  characters: newCharacters,\n                  lastUpdate: Date.now()\n                });\n              }\n              setShowCharacterSheet(false);\n            } catch (error) {\n              console.error('Error saving character:', error);\n              Alert.alert('Error', 'Failed to save character');\n            }\n          });\n          return function (_x6) {\n            return _ref22.apply(this, arguments);\n          };\n        }())\n      }), _jsx(InventoryModal, {\n        visible: showInventory,\n        onClose: function onClose() {\n          return setShowInventory(false);\n        },\n        character: selectedCharacter,\n        onUpdate: (function () {\n          var _ref23 = _asyncToGenerator(function* (updatedCharacter) {\n            try {\n              var newCharacters = characters.map(function (char) {\n                return char.name === selectedCharacter.name ? updatedCharacter : char;\n              });\n              setCharacters(newCharacters);\n              yield savePlayerData(newCharacters);\n              setShowInventory(false);\n            } catch (error) {\n              console.error('Error saving inventory:', error);\n              Alert.alert('Error', 'Failed to save inventory');\n            }\n          });\n          return function (_x7) {\n            return _ref23.apply(this, arguments);\n          };\n        }())\n      }), !isConnected ? _jsx(View, {\n        style: styles.loadingContainer,\n        children: isLoading ? _jsxs(View, {\n          style: {\n            alignItems: 'center'\n          },\n          children: [_jsx(ActivityIndicator, {\n            size: \"large\",\n            color: THEME.accent\n          }), _jsx(Text, {\n            style: [styles.loadingText, {\n              marginTop: 20\n            }],\n            children: \"Connecting to room...\"\n          })]\n        }) : _jsx(Text, {\n          style: styles.loadingText,\n          children: \"Enter a room code to begin\"\n        })\n      }) : _jsxs(_Fragment, {\n        children: [_jsxs(View, {\n          style: styles.header,\n          children: [_jsx(Text, {\n            style: styles.title,\n            children: \"D&D Combat Tracker\"\n          }), _jsxs(ScrollView, {\n            horizontal: isSmallScreen,\n            showsHorizontalScrollIndicator: false,\n            contentContainerStyle: styles.controls,\n            children: [_jsx(TouchableOpacity, {\n              style: [styles.controlButton, {\n                backgroundColor: THEME.primary\n              }],\n              onPress: function onPress() {\n                return setShowRoomModal(true);\n              },\n              children: _jsxs(Text, {\n                style: styles.buttonText,\n                children: [\"Room: \", roomCode]\n              })\n            }), _jsx(TouchableOpacity, {\n              style: [styles.controlButton, {\n                backgroundColor: THEME.primary\n              }],\n              onPress: handleInitiativeRoll,\n              children: _jsx(Text, {\n                style: styles.buttonText,\n                children: \"Roll Initiative\"\n              })\n            }), inCombat && _jsxs(_Fragment, {\n              children: [_jsx(TouchableOpacity, {\n                style: [styles.controlButton, {\n                  backgroundColor: THEME.success\n                }],\n                onPress: function onPress() {\n                  var nextTurn = (currentTurn + 1) % initiative.length;\n                  setCurrentTurn(nextTurn);\n                  if (firebaseRef.current) {\n                    set(firebaseRef.current, _objectSpread(_objectSpread({}, initialGameState), {}, {\n                      tokens: tokens,\n                      layers: layers,\n                      initiative: initiative,\n                      inCombat: true,\n                      currentTurn: nextTurn\n                    }));\n                  }\n                },\n                children: _jsx(Text, {\n                  style: styles.buttonText,\n                  children: \"Next Turn\"\n                })\n              }), _jsx(TouchableOpacity, {\n                style: [styles.controlButton, {\n                  backgroundColor: THEME.danger\n                }],\n                onPress: function onPress() {\n                  if (firebaseRef.current) {\n                    set(firebaseRef.current, _objectSpread(_objectSpread({}, initialGameState), {}, {\n                      tokens: tokens,\n                      layers: layers,\n                      initiative: [],\n                      inCombat: false,\n                      currentTurn: 0\n                    }));\n                  }\n                  setInitiative([]);\n                  setInCombat(false);\n                  setCurrentTurn(0);\n                },\n                children: _jsx(Text, {\n                  style: styles.buttonText,\n                  children: \"End Combat\"\n                })\n              })]\n            }), _jsx(TouchableOpacity, {\n              style: [styles.controlButton, {\n                backgroundColor: THEME.danger\n              }],\n              onPress: function onPress() {\n                Alert.alert(\"Leave Room\", \"Are you sure you want to leave this room?\", [{\n                  text: \"Cancel\",\n                  style: \"cancel\"\n                }, {\n                  text: \"Leave\",\n                  style: \"destructive\",\n                  onPress: function onPress() {\n                    if (unsubscribeRef.current) {\n                      unsubscribeRef.current();\n                      unsubscribeRef.current = null;\n                    }\n                    if (firebaseRef.current) {\n                      off(firebaseRef.current);\n                      firebaseRef.current = null;\n                    }\n                    setIsConnected(false);\n                    setRoomCode('');\n                    setTokens({});\n                    setInitiative([]);\n                    setInCombat(false);\n                    setCurrentTurn(0);\n                    setPartyLoot(initialGameState.partyLoot);\n                    setShowRoomModal(true);\n                    setShowPlayerNameModal(true);\n                  }\n                }]);\n              },\n              children: _jsx(Text, {\n                style: styles.buttonText,\n                children: \"Leave Room\"\n              })\n            }), _jsx(TouchableOpacity, {\n              style: [styles.controlButton, isDM && styles.dmToggleActive],\n              onPress: function onPress() {\n                return setIsDM(!isDM);\n              },\n              children: _jsx(Text, {\n                style: styles.buttonText,\n                children: \"DM Mode\"\n              })\n            })]\n          })]\n        }), _jsx(ScrollView, {\n          style: styles.content,\n          children: _jsxs(View, {\n            style: styles.mainArea,\n            children: [_jsxs(View, {\n              style: styles.leftSidebar,\n              children: [_jsxs(View, {\n                style: diceStyles.dicePanel,\n                children: [_jsx(Text, {\n                  style: diceStyles.diceTitle,\n                  children: \"Dice Roller\"\n                }), _jsxs(View, {\n                  style: diceStyles.diceControls,\n                  children: [_jsx(View, {\n                    style: diceStyles.controlsRow,\n                    children: _jsxs(View, {\n                      style: diceStyles.controlGroup,\n                      children: [_jsx(TouchableOpacity, {\n                        style: [diceStyles.controlButton, rollType === 'advantage' && diceStyles.controlActive, rollType === 'advantage' && {\n                          backgroundColor: THEME.success\n                        }],\n                        onPress: function onPress() {\n                          return setRollType(function (current) {\n                            return current === 'advantage' ? 'normal' : 'advantage';\n                          });\n                        },\n                        children: _jsx(Text, {\n                          style: styles.buttonText,\n                          children: \"Advantage\"\n                        })\n                      }), _jsx(TouchableOpacity, {\n                        style: [diceStyles.controlButton, rollType === 'disadvantage' && diceStyles.controlActive, rollType === 'disadvantage' && {\n                          backgroundColor: THEME.danger\n                        }],\n                        onPress: function onPress() {\n                          return setRollType(function (current) {\n                            return current === 'disadvantage' ? 'normal' : 'disadvantage';\n                          });\n                        },\n                        children: _jsx(Text, {\n                          style: styles.buttonText,\n                          children: \"Disadvantage\"\n                        })\n                      })]\n                    })\n                  }), _jsxs(View, {\n                    style: diceStyles.controlsRow,\n                    children: [_jsxs(View, {\n                      style: diceStyles.modifierGroup,\n                      children: [_jsx(Text, {\n                        style: diceStyles.modifierLabel,\n                        children: \"Modifier\"\n                      }), _jsx(TextInput, {\n                        style: diceStyles.modifierInput,\n                        value: String(modifier),\n                        onChangeText: function onChangeText(text) {\n                          var num = parseInt(text) || 0;\n                          setModifier(num);\n                        },\n                        keyboardType: \"numeric\",\n                        selectTextOnFocus: true\n                      })]\n                    }), _jsxs(View, {\n                      style: diceStyles.quantityGroup,\n                      children: [_jsx(Text, {\n                        style: diceStyles.quantityLabel,\n                        children: \"Quantity\"\n                      }), _jsx(TextInput, {\n                        style: diceStyles.quantityInput,\n                        value: String(diceQuantity),\n                        onChangeText: function onChangeText(text) {\n                          var num = parseInt(text) || 1;\n                          setDiceQuantity(Math.max(1, Math.min(num, 100)));\n                        },\n                        keyboardType: \"numeric\",\n                        selectTextOnFocus: true\n                      })]\n                    })]\n                  })]\n                }), _jsx(View, {\n                  style: diceStyles.diceGrid,\n                  children: DICE_TYPES.map(function (_ref24) {\n                    var sides = _ref24.sides;\n                    return _jsx(TouchableOpacity, {\n                      style: [diceStyles.diceButton, {\n                        backgroundColor: THEME.background.secondary\n                      }],\n                      onPress: function onPress() {\n                        var rolls = [];\n                        for (var i = 0; i < diceQuantity; i++) {\n                          if (rollType !== 'normal') {\n                            var roll1 = Math.floor(Math.random() * sides) + 1;\n                            var roll2 = Math.floor(Math.random() * sides) + 1;\n                            rolls.push(rollType === 'advantage' ? Math.max(roll1, roll2) : Math.min(roll1, roll2));\n                          } else {\n                            rolls.push(Math.floor(Math.random() * sides) + 1);\n                          }\n                        }\n                        var total = rolls.reduce(function (sum, roll) {\n                          return sum + roll;\n                        }, 0) + modifier;\n                        var result = {\n                          dice: diceQuantity + \"d\" + sides,\n                          rolls: rolls,\n                          modifier: modifier,\n                          rollType: rollType,\n                          total: total\n                        };\n                        setDiceResult(result);\n                        setShowDiceResult(true);\n                        Vibration.vibrate(50);\n                      },\n                      children: _jsxs(Text, {\n                        style: diceStyles.diceButtonText,\n                        children: [\"d\", sides]\n                      })\n                    }, sides);\n                  })\n                })]\n              }), _jsxs(View, {\n                style: styles.infoPanel,\n                children: [_jsx(Text, {\n                  style: styles.infoPanelTitle,\n                  children: \"Player Tools\"\n                }), _jsxs(View, {\n                  style: styles.infoGrid,\n                  children: [_jsx(TouchableOpacity, {\n                    style: styles.quickActionButton,\n                    onPress: function onPress() {\n                      var roll = Math.floor(Math.random() * 20) + 1;\n                      setDiceResult({\n                        dice: \"d20\",\n                        rolls: [roll],\n                        modifier: 0,\n                        rollType: 'normal',\n                        total: roll\n                      });\n                      setShowDiceResult(true);\n                    },\n                    children: _jsx(Text, {\n                      style: styles.quickActionText,\n                      children: \"Quick d20\"\n                    })\n                  }), _jsx(TouchableOpacity, {\n                    style: styles.quickActionButton,\n                    onPress: function onPress() {\n                      var roll1 = Math.floor(Math.random() * 20) + 1;\n                      var roll2 = Math.floor(Math.random() * 20) + 1;\n                      var total = Math.max(roll1, roll2);\n                      setDiceResult({\n                        dice: \"d20 with advantage\",\n                        rolls: [roll1, roll2],\n                        modifier: 0,\n                        rollType: 'advantage',\n                        total: total\n                      });\n                      setShowDiceResult(true);\n                    },\n                    children: _jsx(Text, {\n                      style: styles.quickActionText,\n                      children: \"Quick Advantage\"\n                    })\n                  }), _jsx(TouchableOpacity, {\n                    style: styles.quickActionButton,\n                    onPress: function onPress() {\n                      var damage = Math.floor(Math.random() * 8) + 1;\n                      setDiceResult({\n                        dice: \"d8\",\n                        rolls: [damage],\n                        modifier: 0,\n                        rollType: 'normal',\n                        total: damage\n                      });\n                      setShowDiceResult(true);\n                    },\n                    children: _jsx(Text, {\n                      style: styles.quickActionText,\n                      children: \"Quick Damage\"\n                    })\n                  }), _jsx(TouchableOpacity, {\n                    style: styles.quickActionButton,\n                    onPress: function onPress() {\n                      var roll1 = Math.floor(Math.random() * 20) + 1;\n                      var roll2 = Math.floor(Math.random() * 20) + 1;\n                      var total = Math.min(roll1, roll2);\n                      setDiceResult({\n                        dice: \"d20 with disadvantage\",\n                        rolls: [roll1, roll2],\n                        modifier: 0,\n                        rollType: 'disadvantage',\n                        total: total\n                      });\n                      setShowDiceResult(true);\n                    },\n                    children: _jsx(Text, {\n                      style: styles.quickActionText,\n                      children: \"Quick Disadvantage\"\n                    })\n                  })]\n                }), _jsx(View, {\n                  style: styles.divider\n                }), _jsxs(View, {\n                  style: styles.infoGrid,\n                  children: [_jsx(TouchableOpacity, {\n                    style: [styles.quickActionButton, {\n                      backgroundColor: THEME.accent\n                    }],\n                    onPress: function onPress() {\n                      var rolls = [Math.floor(Math.random() * 6) + 1, Math.floor(Math.random() * 6) + 1, Math.floor(Math.random() * 6) + 1, Math.floor(Math.random() * 6) + 1].sort(function (a, b) {\n                        return b - a;\n                      });\n                      rolls.pop();\n                      var total = rolls.reduce(function (sum, roll) {\n                        return sum + roll;\n                      }, 0);\n                      setDiceResult({\n                        dice: \"4d6 drop lowest\",\n                        rolls: rolls,\n                        modifier: 0,\n                        rollType: 'normal',\n                        total: total\n                      });\n                      setShowDiceResult(true);\n                    },\n                    children: _jsx(Text, {\n                      style: styles.quickActionText,\n                      children: \"Roll Ability Score\"\n                    })\n                  }), _jsx(TouchableOpacity, {\n                    style: [styles.quickActionButton, {\n                      backgroundColor: THEME.success\n                    }],\n                    onPress: function onPress() {\n                      var roll = Math.floor(Math.random() * 100) + 1;\n                      setDiceResult({\n                        dice: \"d100\",\n                        rolls: [roll],\n                        modifier: 0,\n                        rollType: 'normal',\n                        total: roll\n                      });\n                      setShowDiceResult(true);\n                    },\n                    children: _jsx(Text, {\n                      style: styles.quickActionText,\n                      children: \"Percentile Roll\"\n                    })\n                  })]\n                })]\n              })]\n            }), _jsxs(View, {\n              style: styles.gridSection,\n              children: [_jsx(ScrollView, {\n                horizontal: true,\n                contentContainerStyle: {\n                  minWidth: '100%'\n                },\n                children: _jsx(ScrollView, {\n                  children: _jsxs(View, {\n                    style: [styles.gridContainer, {\n                      transform: [{\n                        scale: zoomLevel\n                      }]\n                    }],\n                    children: [_jsx(View, {\n                      style: styles.colorPicker,\n                      children: COLORS.map(function (color) {\n                        return _jsx(TouchableOpacity, {\n                          style: [styles.colorButton, {\n                            backgroundColor: color\n                          }, color === currentColor && styles.selectedColor],\n                          onPress: function onPress() {\n                            return setCurrentColor(color);\n                          }\n                        }, color);\n                      })\n                    }), Array.from({\n                      length: GRID_SIZE\n                    }).map(function (_, row) {\n                      return _jsx(View, {\n                        style: styles.row,\n                        children: Array.from({\n                          length: GRID_SIZE\n                        }).map(function (_, col) {\n                          var _initiative$currentTu;\n                          var position = row + \"-\" + col;\n                          var token = tokens[position];\n                          var isCurrentTurn = inCombat && ((_initiative$currentTu = initiative[currentTurn]) == null ? void 0 : _initiative$currentTu.position) === position;\n                          return _jsx(TouchableOpacity, {\n                            style: [styles.cell, token && {\n                              backgroundColor: token.color\n                            }, isCurrentTurn && styles.currentTurn],\n                            onPress: function onPress() {\n                              return handleCellPress(row, col);\n                            },\n                            onLongPress: function onLongPress() {\n                              if (token) {\n                                setSelectedToken(_objectSpread(_objectSpread({}, token), {}, {\n                                  position: position\n                                }));\n                                setShowTokenModal(true);\n                              }\n                            },\n                            children: token && _jsxs(View, {\n                              style: styles.tokenContent,\n                              children: [_jsx(Text, {\n                                style: [styles.tokenText, {\n                                  color: token.color === '#ffffff' ? '#000000' : '#ffffff'\n                                }],\n                                numberOfLines: 1,\n                                children: token.name\n                              }), _jsxs(Text, {\n                                style: [styles.tokenHp, {\n                                  color: token.color === '#ffffff' ? '#000000' : '#ffffff'\n                                }],\n                                children: [\"HP: \", token.hp, \"/\", token.maxHp]\n                              }), _jsxs(Text, {\n                                style: [styles.tokenHp, {\n                                  color: token.color === '#ffffff' ? '#000000' : '#ffffff'\n                                }],\n                                children: [\"AC: \", token.ac]\n                              }), token.effects && token.effects.length > 0 && _jsx(View, {\n                                style: statusStyles.tokenEffects,\n                                children: token.effects.map(function (effect) {\n                                  var statusEffect = STATUS_EFFECTS.find(function (e) {\n                                    return e.id === effect;\n                                  });\n                                  return statusEffect ? _jsx(Text, {\n                                    style: statusStyles.effectIcon,\n                                    children: statusEffect.icon\n                                  }, effect) : null;\n                                })\n                              })]\n                            })\n                          }, col);\n                        })\n                      }, row);\n                    })]\n                  })\n                })\n              }), _jsx(GridZoomControls, {\n                zoomLevel: zoomLevel,\n                setZoomLevel: setZoomLevel\n              })]\n            }), _jsxs(View, {\n              style: styles.rightSidebar,\n              children: [_jsxs(View, {\n                style: styles.quickActions,\n                children: [_jsx(TouchableOpacity, {\n                  style: styles.quickActionButton,\n                  onPress: function onPress() {\n                    return setShowCharacterSheet(true);\n                  },\n                  children: _jsx(Text, {\n                    style: styles.quickActionText,\n                    children: \"New Character\"\n                  })\n                }), _jsx(TouchableOpacity, {\n                  style: styles.quickActionButton,\n                  onPress: function onPress() {\n                    return setShowPartyLoot(true);\n                  },\n                  children: _jsx(Text, {\n                    style: styles.quickActionText,\n                    children: \"Party Loot\"\n                  })\n                }), _jsx(TouchableOpacity, {\n                  style: styles.quickActionButton,\n                  onPress: handleInitiativeRoll,\n                  children: _jsx(Text, {\n                    style: styles.quickActionText,\n                    children: \"Roll Initiative\"\n                  })\n                }), _jsx(TouchableOpacity, {\n                  style: [styles.quickActionButton, {\n                    backgroundColor: THEME.danger\n                  }],\n                  onPress: function onPress() {\n                    if (firebaseRef.current) {\n                      set(firebaseRef.current, _objectSpread(_objectSpread({}, initialGameState), {}, {\n                        tokens: {},\n                        layers: layers,\n                        initiative: [],\n                        inCombat: false,\n                        currentTurn: 0,\n                        partyLoot: partyLoot,\n                        characters: characters\n                      }));\n                      setTokens({});\n                      setInitiative([]);\n                      setInCombat(false);\n                      setCurrentTurn(0);\n                    }\n                  },\n                  children: _jsx(Text, {\n                    style: styles.quickActionText,\n                    children: \"Clear Board\"\n                  })\n                })]\n              }), _jsxs(View, {\n                style: [styles.infoPanel, {\n                  marginBottom: 15\n                }],\n                children: [_jsx(Text, {\n                  style: styles.infoPanelTitle,\n                  children: \"Characters\"\n                }), _jsx(ScrollView, {\n                  style: {\n                    maxHeight: 200\n                  },\n                  children: characters.filter(function (char) {\n                    return char.owner === playerName;\n                  }).map(function (char, index) {\n                    return _jsx(TouchableOpacity, {\n                      style: [layoutStyles.characterItem, (selectedCharacter == null ? void 0 : selectedCharacter.name) === char.name && {\n                        backgroundColor: THEME.accent + '40'\n                      }],\n                      onPress: function onPress() {\n                        return setSelectedCharacter(char);\n                      },\n                      children: _jsxs(View, {\n                        style: layoutStyles.characterInfo,\n                        children: [_jsxs(View, {\n                          children: [_jsx(Text, {\n                            style: layoutStyles.characterName,\n                            children: char.name\n                          }), _jsxs(Text, {\n                            style: layoutStyles.characterDetails,\n                            children: [\"Level \", char.level, \" \", char.class]\n                          })]\n                        }), _jsx(View, {\n                          style: styles.statBadge,\n                          children: _jsxs(Text, {\n                            style: styles.statBadgeText,\n                            children: [\"HP: \", char.hp, \"/\", char.maxHp]\n                          })\n                        })]\n                      })\n                    }, index);\n                  })\n                }), selectedCharacter && _jsxs(_Fragment, {\n                  children: [_jsx(View, {\n                    style: styles.divider\n                  }), _jsxs(View, {\n                    style: styles.infoGrid,\n                    children: [_jsx(TouchableOpacity, {\n                      style: [styles.quickActionButton, {\n                        backgroundColor: THEME.accent\n                      }],\n                      onPress: function onPress() {\n                        return setShowCharacterSheet(true);\n                      },\n                      children: _jsx(Text, {\n                        style: styles.quickActionText,\n                        children: \"Character Sheet\"\n                      })\n                    }), _jsx(TouchableOpacity, {\n                      style: [styles.quickActionButton, {\n                        backgroundColor: THEME.success\n                      }],\n                      onPress: function onPress() {\n                        return setShowInventory(true);\n                      },\n                      children: _jsx(Text, {\n                        style: styles.quickActionText,\n                        children: \"Inventory\"\n                      })\n                    })]\n                  })]\n                })]\n              }), _jsxs(View, {\n                style: styles.infoPanel,\n                children: [_jsx(Text, {\n                  style: styles.infoPanelTitle,\n                  children: \"Combat Tracker\"\n                }), _jsxs(View, {\n                  style: styles.infoGrid,\n                  children: [_jsx(TouchableOpacity, {\n                    style: [styles.quickActionButton, inCombat ? {\n                      backgroundColor: THEME.danger\n                    } : {}],\n                    onPress: function onPress() {\n                      if (inCombat) {\n                        if (firebaseRef.current) {\n                          set(firebaseRef.current, _objectSpread(_objectSpread({}, initialGameState), {}, {\n                            tokens: tokens,\n                            layers: layers,\n                            initiative: [],\n                            inCombat: false,\n                            currentTurn: 0\n                          }));\n                        }\n                        setInitiative([]);\n                        setInCombat(false);\n                        setCurrentTurn(0);\n                      } else {\n                        handleInitiativeRoll();\n                      }\n                    },\n                    children: _jsx(Text, {\n                      style: styles.quickActionText,\n                      children: inCombat ? 'End Combat' : 'Start Combat'\n                    })\n                  }), inCombat && _jsx(TouchableOpacity, {\n                    style: [styles.quickActionButton, {\n                      backgroundColor: THEME.success\n                    }],\n                    onPress: function onPress() {\n                      var nextTurn = (currentTurn + 1) % initiative.length;\n                      setCurrentTurn(nextTurn);\n                      if (firebaseRef.current) {\n                        set(firebaseRef.current, _objectSpread(_objectSpread({}, initialGameState), {}, {\n                          tokens: tokens,\n                          layers: layers,\n                          initiative: initiative,\n                          inCombat: true,\n                          currentTurn: nextTurn\n                        }));\n                      }\n                    },\n                    children: _jsx(Text, {\n                      style: styles.quickActionText,\n                      children: \"Next Turn\"\n                    })\n                  })]\n                }), inCombat && initiative.length > 0 && _jsxs(_Fragment, {\n                  children: [_jsx(View, {\n                    style: styles.divider\n                  }), _jsx(Text, {\n                    style: [styles.infoPanelTitle, {\n                      fontSize: 14\n                    }],\n                    children: \"Current Turn\"\n                  }), _jsxs(View, {\n                    style: [styles.infoCard, {\n                      marginBottom: 10\n                    }],\n                    children: [_jsx(Text, {\n                      style: styles.infoValue,\n                      children: ((_tokens$initiative$cu = tokens[(_initiative$currentTu2 = initiative[currentTurn]) == null ? void 0 : _initiative$currentTu2.position]) == null ? void 0 : _tokens$initiative$cu.name) || 'Unknown'\n                    }), _jsxs(Text, {\n                      style: styles.infoLabel,\n                      children: [\"Initiative: \", ((_initiative$currentTu3 = initiative[currentTurn]) == null ? void 0 : _initiative$currentTu3.initiative) || '0']\n                    })]\n                  }), _jsx(Text, {\n                    style: [styles.infoPanelTitle, {\n                      fontSize: 14\n                    }],\n                    children: \"Initiative Order\"\n                  }), _jsx(ScrollView, {\n                    style: {\n                      maxHeight: 150\n                    },\n                    children: initiative.map(function (item, index) {\n                      var token = tokens[item.position];\n                      if (!token) return null;\n                      return _jsxs(View, {\n                        style: [styles.infoCard, {\n                          marginBottom: 5\n                        }, index === currentTurn && {\n                          backgroundColor: THEME.accent + '40'\n                        }],\n                        children: [_jsx(Text, {\n                          style: styles.infoValue,\n                          children: token.name\n                        }), _jsxs(View, {\n                          style: {\n                            flexDirection: 'row',\n                            justifyContent: 'space-between'\n                          },\n                          children: [_jsxs(Text, {\n                            style: styles.infoLabel,\n                            children: [\"Initiative: \", item.initiative]\n                          }), _jsxs(Text, {\n                            style: styles.infoLabel,\n                            children: [\"HP: \", token.hp, \"/\", token.maxHp]\n                          })]\n                        })]\n                      }, item.position);\n                    })\n                  })]\n                })]\n              })]\n            })]\n          })\n        })]\n      })]\n    }), _jsx(DeleteCharacterModal, {\n      visible: showDeleteModal,\n      character: selectedCharacter,\n      onClose: function onClose() {\n        return setShowDeleteModal(false);\n      },\n      onConfirm: handleDeleteCharacter\n    }), _jsx(EnemySelectModal, {\n      visible: showEnemySelect,\n      onClose: function onClose() {\n        setShowEnemySelect(false);\n        setSelectedPosition(null);\n      },\n      onSelect: handleEnemySelect\n    })]\n  });\n}","map":{"version":3,"names":["React","useState","useCallback","useEffect","useRef","memo","StyleSheet","View","Text","TouchableOpacity","Pressable","TextInput","ScrollView","Alert","Modal","KeyboardAvoidingView","Platform","SafeAreaView","ActivityIndicator","Keyboard","Vibration","Dimensions","initializeApp","getDatabase","ref","onValue","set","get","off","debounce","GestureScrollView","DiceRoller","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","firebaseConfig","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","app","database","LETTERS","Array","from","length","_","i","String","fromCharCode","COLORS","GRID_SIZE","ABILITY_SCORES","SKILLS","STR","DEX","CON","INT","WIS","CHA","CURRENCY","DICE_TYPES","sides","color","STATUS_EFFECTS","id","name","icon","COMMON_ENEMIES","hp","maxHp","ac","initiativeBonus","windowDimensions","isSmallScreen","width","THEME","primary","secondary","accent","gold","danger","success","text","light","dark","background","panel","initialGameState","tokens","layers","grid","terrain","effects","fog","initiative","inCombat","currentTurn","settings","gridSize","showCoordinates","partyLoot","currency","CP","SP","EP","GP","PP","items","currentViewer","characters","lastUpdate","Date","now","styles","create","container","flex","backgroundColor","height","header","padding","title","fontSize","fontWeight","marginBottom","controls","flexDirection","flexWrap","gap","justifyContent","controlButton","borderRadius","minWidth","alignItems","content","mainArea","minHeight","leftSidebar","flexShrink","order","gridSection","rightSidebar","gridContainer","row","cell","borderWidth","borderColor","tokenContent","tokenText","textAlign","tokenHp","modalOverlay","modalContainer","modalContent","modalTitle","input","modalButtons","marginTop","modalButton","buttonText","loadingContainer","loadingText","loadingButtonContent","diceBox","diceControls","diceButtons","diceButton","diceHistory","maxHeight","diceResultContainer","borderBottomWidth","borderBottomColor","diceResult","diceTotal","diceRolls","initiativeList","initiativeScroll","initiativeItem","currentInitiative","initiativeText","currentInitiativeText","zoomControls","position","right","bottom","display","zoomButton","opacity","advantageButton","advantageActive","modifierInput","boxTitle","colorPicker","colorButton","margin","selectedColor","quickActions","quickActionButton","quickActionText","infoPanel","infoPanelTitle","infoGrid","infoCard","infoLabel","infoValue","statBadge","paddingVertical","paddingHorizontal","alignSelf","statBadgeText","divider","marginVertical","additionalStyles","characterSheet","maxWidth","sheetHeader","sheetSection","sectionTitle","abilityScores","abilityBox","abilityLabel","abilityScore","abilityMod","skillsList","skillItem","proficientDot","marginRight","skillName","skillMod","closeButton","top","closeButtonText","lootSection","currencyRow","currencyInput","currencyLabel","itemRow","itemInput","removeButton","addButton","lootHeader","itemInfo","addedBy","enemyOption","dmToggle","marginLeft","dmToggleActive","diceStyles","dicePanel","diceHeader","diceTitle","diceGrid","boxShadow","diceButtonText","controlGroup","controlActive","modifierGroup","modifierLabel","historyContainer","historyScroll","historyItem","historyLeft","historyInfo","historyDice","historyRolls","historyTotal","clearButton","quantityGroup","quantityLabel","quantityInput","controlsRow","diceContainer","overflow","statusStyles","effectsContainer","borderTopWidth","borderTopColor","paddingTop","effectsTitle","effectsGrid","effectButton","effectActive","effectText","tokenEffects","effectIcon","saveGameState","_ref","_asyncToGenerator","firebaseRef","current","error","console","alert","apply","arguments","CharacterSheetModal","_ref2","visible","onClose","character","onUpdate","_useState","class","level","owner","proficiencyBonus","proficientSkills","inventory","_useState2","_slicedToArray","editedCharacter","setEditedCharacter","calculateModifier","score","Math","floor","handleAbilityScoreChange","ability","value","newScore","parseInt","prev","_objectSpread","_defineProperty","toggleProficiency","skill","includes","filter","s","concat","_toConsumableArray","getSkillModifier","profBonus","handleSave","_ref3","updatedCharacter","transparent","animationType","onRequestClose","children","style","onPress","onChangeText","placeholder","placeholderTextColor","keyboardType","map","maxLength","selectTextOnFocus","Object","entries","_ref4","_ref5","skills","quantity","notes","item","index","newItems","TokenModal","_ref6","showTokenModal","setShowTokenModal","selectedToken","setSelectedToken","cursor","dismiss","behavior","select","ios","android","keyboardVerticalOffset","e","stopPropagation","blurOnSubmit","autoComplete","spellCheck","enablesReturnKeyAutomatically","max","effect","_selectedToken$effect","currentEffects","newEffects","newTokens","modalStyles","left","zIndex","RoomModal","_ref7","showRoomModal","setShowRoomModal","isConnected","roomCode","setRoomCode","isJoining","connectToRoom","pointerEvents","trim","toLowerCase","autoCapitalize","autoCorrect","editable","autoFocus","disabled","PartyLootModal","_ref8","playerName","_useState3","_useState4","editedLoot","setEditedLoot","type","toString","buttonRow","button","GridZoomControls","_ref9","zoomLevel","setZoomLevel","debouncedZoom","newZoom","min","InventoryModal","_ref10","_useState5","_useState6","editedInventory","setEditedInventory","newInventory","PlayerNameModal","_ref11","onSubmit","_useState7","_useState8","setName","viewerStyles","viewersList","viewersTitle","viewerName","DiceResultModal","_ref12","result","timer","setTimeout","clearTimeout","shadowColor","shadowOffset","shadowOpacity","shadowRadius","elevation","dice","rollType","total","rolls","join","modifier","DeleteCharacterModal","_ref13","onConfirm","_useState9","_useState10","confirmName","setConfirmName","EnemySelectModal","_ref14","onSelect","enemy","App","_tokens$initiative$cu","_initiative$currentTu2","_initiative$currentTu3","_useState11","_useState12","_useState13","_useState14","setIsConnected","_useState15","_useState16","isLoading","setIsLoading","_useState17","_useState18","setIsJoining","_useState19","_useState20","isUpdating","setIsUpdating","_useState21","_useState22","_useState23","_useState24","isDarkMode","setIsDarkMode","_useState25","_useState26","_useState27","_useState28","setTokens","_useState29","_useState30","currentColor","setCurrentColor","_useState31","_useState32","setInitiative","_useState33","_useState34","setInCombat","_useState35","_useState36","setCurrentTurn","_useState37","_useState38","setLayers","_useState39","_useState40","setDiceHistory","_useState41","_useState42","advantage","setAdvantage","_useState43","_useState44","setModifier","_useState45","_useState46","_useState47","_useState48","_useState49","_useState50","setPartyLoot","_useState51","_useState52","showPartyLoot","setShowPartyLoot","_useState53","_useState54","diceQuantity","setDiceQuantity","_useState55","_useState56","setCharacters","_useState57","_useState58","showCharacterSheet","setShowCharacterSheet","_useState59","_useState60","selectedCharacter","setSelectedCharacter","_useState61","_useState62","showInventory","setShowInventory","_useState63","_useState64","setPlayerName","_useState65","_useState66","showPlayerNameModal","setShowPlayerNameModal","_useState67","_useState68","setRollType","_useState69","_useState70","setDiceResult","_useState71","_useState72","showDiceResult","setShowDiceResult","_useState73","_useState74","showDeleteModal","setShowDeleteModal","_useState75","_useState76","isDM","setIsDM","_useState77","_useState78","showEnemySelect","setShowEnemySelect","_useState79","_useState80","selectedPosition","setSelectedPosition","unsubscribeRef","handleDisconnect","handleInitiativeRoll","keys","_ref15","_ref16","token","roll","random","details","sort","a","b","rollDice","allRolls","d","numRolls","push","finalRoll","grandTotal","reduce","sum","newResult","r","flat","individualTotals","timestamp","slice","vibrate","handleCellPress","_ref17","col","_x","_x2","savePlayerData","_ref18","updatedCharacters","roomPlayerRef","globalPlayerRef","playerData","Promise","all","_x3","_ref19","code","playerSnapshot","exists","val","gameRef","snapshot","unsubscribe","data","players","_x4","handleOffline","window","addEventListener","removeEventListener","layoutStyles","sidePanel","sidePanelTitle","panelButton","panelButtonText","characterItem","characterInfo","characterName","characterDetails","handleDeleteCharacter","newCharacters","char","handleEnemySelect","_ref21","_x5","darkMode","updatedLoot","_ref22","Error","playerRef","_x6","_ref23","_x7","size","horizontal","showsHorizontalScrollIndicator","contentContainerStyle","nextTurn","num","_ref24","roll1","roll2","damage","pop","transform","scale","_initiative$currentTu","isCurrentTurn","onLongPress","numberOfLines","statusEffect","find"],"sources":["C:/Users/Daniel/Desktop/3d-dice-main/App.jsx"],"sourcesContent":["import React, { useState, useCallback, useEffect, useRef, memo } from 'react';\r\nimport { \r\n  StyleSheet, \r\n  View, \r\n  Text, \r\n  TouchableOpacity, \r\n  Pressable,\r\n  TextInput, \r\n  ScrollView, \r\n  Alert, \r\n  Modal,\r\n  KeyboardAvoidingView,\r\n  Platform,\r\n  SafeAreaView,\r\n  ActivityIndicator,\r\n  Keyboard,\r\n  Vibration,\r\n  Dimensions\r\n} from 'react-native';\r\nimport { initializeApp } from 'firebase/app';\r\nimport { \r\n  getDatabase, \r\n  ref, \r\n  onValue, \r\n  set, \r\n  get, \r\n  off \r\n} from 'firebase/database';\r\nimport { debounce } from 'lodash';\r\nimport { ScrollView as GestureScrollView } from 'react-native-gesture-handler';\r\nimport { DiceRoller } from './components/DiceModel';\r\n\r\n// Firebase configuration\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyBSy8ia6vKnq95_gbO7lnohVbyAQzqBtk4\",\r\n  authDomain: \"dndcombattracker-572b0.firebaseapp.com\",\r\n  databaseURL: \"https://dndcombattracker-572b0-default-rtdb.firebaseio.com\",\r\n  projectId: \"dndcombattracker-572b0\",\r\n  storageBucket: \"dndcombattracker-572b0.firebasestorage.app\",\r\n  messagingSenderId: \"812186225431\",\r\n  appId: \"1:812186225431:web:8da48e238d10db01d14552\"\r\n};\r\n\r\n// Initialize Firebase\r\nconst app = initializeApp(firebaseConfig);\r\nconst database = getDatabase(app);\r\n\r\n// Constants\r\nconst LETTERS = Array.from({ length: 26 }, (_, i) => String.fromCharCode(65 + i));\r\nconst COLORS = [\r\n  '#4527A0',  // Rich purple\r\n  '#4A90E2',  // Bright blue\r\n  '#7C4DFF',  // Bright purple\r\n  '#00BFA5',  // Teal\r\n  '#3F51B5',  // Indigo\r\n  '#673AB7',  // Deep Purple\r\n  '#2196F3',  // Blue\r\n  '#B39DDB'   // Light Purple\r\n];\r\nconst GRID_SIZE = 10;\r\nconst ABILITY_SCORES = ['STR', 'DEX', 'CON', 'INT', 'WIS', 'CHA'];\r\nconst SKILLS = {\r\n  STR: ['Athletics'],\r\n  DEX: ['Acrobatics', 'Sleight of Hand', 'Stealth'],\r\n  CON: [],\r\n  INT: ['Arcana', 'History', 'Investigation', 'Nature', 'Religion'],\r\n  WIS: ['Animal Handling', 'Insight', 'Medicine', 'Perception', 'Survival'],\r\n  CHA: ['Deception', 'Intimidation', 'Performance', 'Persuasion']\r\n};\r\nconst CURRENCY = ['CP', 'SP', 'EP', 'GP', 'PP'];\r\nconst DICE_TYPES = [\r\n  { sides: 4, color: '#FF6B6B' },\r\n  { sides: 6, color: '#4ECDC4' },\r\n  { sides: 8, color: '#45B7D1' },\r\n  { sides: 10, color: '#96CEB4' },\r\n  { sides: 12, color: '#FFEEAD' },\r\n  { sides: 20, color: '#D4A5A5' },\r\n  { sides: 100, color: '#9B59B6' }\r\n];\r\nconst STATUS_EFFECTS = [\r\n  { id: 'blinded', name: 'Blinded', icon: 'ðŸ‘ï¸' },\r\n  { id: 'charmed', name: 'Charmed', icon: 'ðŸ’•' },\r\n  { id: 'deafened', name: 'Deafened', icon: 'ðŸ‘‚' },\r\n  { id: 'frightened', name: 'Frightened', icon: 'ðŸ˜¨' },\r\n  { id: 'grappled', name: 'Grappled', icon: 'ðŸ¤¼' },\r\n  { id: 'incapacitated', name: 'Incapacitated', icon: 'ðŸ’«' },\r\n  { id: 'invisible', name: 'Invisible', icon: 'ðŸ‘»' },\r\n  { id: 'paralyzed', name: 'Paralyzed', icon: 'âš¡' },\r\n  { id: 'petrified', name: 'Petrified', icon: 'ðŸ—¿' },\r\n  { id: 'poisoned', name: 'Poisoned', icon: 'ðŸ¤¢' },\r\n  { id: 'prone', name: 'Prone', icon: 'â¬‡ï¸' },\r\n  { id: 'restrained', name: 'Restrained', icon: 'â›“ï¸' },\r\n  { id: 'stunned', name: 'Stunned', icon: 'ðŸ’«' },\r\n  { id: 'unconscious', name: 'Unconscious', icon: 'ðŸ’¤' }\r\n];\r\n\r\n// Add this constant near the other constants at the top\r\nconst COMMON_ENEMIES = [\r\n  {\r\n    name: 'Bandit',\r\n    hp: 11,\r\n    maxHp: 11,\r\n    ac: 12,\r\n    initiativeBonus: 1,\r\n    color: '#8B4513'\r\n  },\r\n  {\r\n    name: 'Wolf',\r\n    hp: 11,\r\n    maxHp: 11,\r\n    ac: 13,\r\n    initiativeBonus: 2,\r\n    color: '#808080'\r\n  },\r\n  {\r\n    name: 'Wraith',\r\n    hp: 67,\r\n    maxHp: 67,\r\n    ac: 13,\r\n    initiativeBonus: 2,\r\n    color: '#4A0404'\r\n  },\r\n  {\r\n    name: 'Goblin',\r\n    hp: 7,\r\n    maxHp: 7,\r\n    ac: 15,\r\n    initiativeBonus: 2,\r\n    color: '#355E3B'\r\n  },\r\n  {\r\n    name: 'Skeleton',\r\n    hp: 13,\r\n    maxHp: 13,\r\n    ac: 13,\r\n    initiativeBonus: 2,\r\n    color: '#E1D9D1'\r\n  },\r\n  {\r\n    name: 'Zombie',\r\n    hp: 22,\r\n    maxHp: 22,\r\n    ac: 8,\r\n    initiativeBonus: -2,\r\n    color: '#4A412A'\r\n  }\r\n];\r\n\r\n// Get window dimensions\r\nconst windowDimensions = Dimensions.get('window');\r\nconst isSmallScreen = windowDimensions.width < 768;\r\n\r\n// Theme configuration\r\nconst THEME = {\r\n  primary: '#2E1F5E',      // Deep purple\r\n  secondary: '#4527A0',    // Rich purple\r\n  accent: '#4A90E2',       // Bright blue\r\n  gold: '#7C4DFF',         // Bright purple\r\n  danger: '#FF5252',       // Red (keeping for clear danger indication)\r\n  success: '#00BFA5',      // Teal (keeping for clear success indication)\r\n  text: {\r\n    light: '#FFFFFF',\r\n    dark: '#1E1E1E'\r\n  },\r\n  background: {\r\n    primary: '#1A103C',    // Darkest purple\r\n    secondary: '#2E1F5E',  // Deep purple\r\n    dark: '#150D30',       // Very dark purple\r\n    panel: '#3F2B85'       // Medium purple\r\n  }\r\n};\r\n\r\n// Initial game state\r\nconst initialGameState = {\r\n  tokens: {},\r\n  layers: {\r\n    grid: true,\r\n    terrain: {},\r\n    tokens: {},\r\n    effects: {},\r\n    fog: {}\r\n  },\r\n  initiative: [],\r\n  inCombat: false,\r\n  currentTurn: 0,\r\n  settings: {\r\n    gridSize: GRID_SIZE,\r\n    showCoordinates: true,\r\n  },\r\n  partyLoot: {\r\n    currency: { CP: 0, SP: 0, EP: 0, GP: 0, PP: 0 },\r\n    items: [],\r\n    currentViewer: null\r\n  },\r\n  characters: [],\r\n  lastUpdate: Date.now()\r\n};\r\n\r\n// Styles\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: THEME.background.primary,\r\n    height: '100%',\r\n    width: '100%',\r\n  },\r\n  header: {\r\n    padding: isSmallScreen ? 10 : 20,\r\n    backgroundColor: THEME.background.panel,\r\n    width: '100%',\r\n  },\r\n  title: {\r\n    fontSize: isSmallScreen ? 18 : 24,\r\n    fontWeight: 'bold',\r\n    color: THEME.text.light,\r\n    marginBottom: 10,\r\n  },\r\n  controls: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 10,\r\n    justifyContent: isSmallScreen ? 'center' : 'flex-start',\r\n  },\r\n  controlButton: {\r\n    padding: isSmallScreen ? 8 : 10,\r\n    borderRadius: 5,\r\n    minWidth: isSmallScreen ? 80 : 100,\r\n    alignItems: 'center',\r\n  },\r\n  content: {\r\n    flex: 1,\r\n    width: '100%',\r\n  },\r\n  mainArea: {\r\n    flex: 1,\r\n    flexDirection: isSmallScreen ? 'column' : 'row',\r\n    padding: isSmallScreen ? 10 : 20,\r\n    gap: 20,\r\n    minHeight: '100%',\r\n  },\r\n  leftSidebar: {\r\n    width: isSmallScreen ? '100%' : 350,\r\n    flexShrink: 0,\r\n    order: isSmallScreen ? 2 : 0,\r\n  },\r\n  gridSection: {\r\n    flex: 1,\r\n    minHeight: isSmallScreen ? 400 : '100%',\r\n    order: isSmallScreen ? 1 : 1,\r\n  },\r\n  rightSidebar: {\r\n    width: isSmallScreen ? '100%' : 350,\r\n    flexShrink: 0,\r\n    order: isSmallScreen ? 3 : 2,\r\n  },\r\n  gridContainer: {\r\n    padding: isSmallScreen ? 5 : 10,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  row: {\r\n    flexDirection: 'row',\r\n  },\r\n  cell: {\r\n    width: isSmallScreen ? 35 : 60,\r\n    height: isSmallScreen ? 35 : 60,\r\n    borderWidth: 1,\r\n    borderColor: THEME.accent,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    backgroundColor: THEME.background.secondary,\r\n  },\r\n  tokenContent: {\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    width: '100%',\r\n    height: '100%',\r\n    padding: isSmallScreen ? 1 : 2,\r\n  },\r\n  tokenText: {\r\n    fontSize: isSmallScreen ? 10 : 12,\r\n    fontWeight: 'bold',\r\n    textAlign: 'center',\r\n  },\r\n  tokenHp: {\r\n    fontSize: isSmallScreen ? 8 : 10,\r\n    textAlign: 'center',\r\n  },\r\n  modalOverlay: {\r\n    flex: 1,\r\n    backgroundColor: 'rgba(0,0,0,0.5)',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  modalContainer: {\r\n    width: '100%',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    padding: 20,\r\n  },\r\n  modalContent: {\r\n    backgroundColor: THEME.background.panel,\r\n    padding: 20,\r\n    borderRadius: 10,\r\n    width: isSmallScreen ? '90%' : 400,\r\n  },\r\n  modalTitle: {\r\n    fontSize: isSmallScreen ? 18 : 20,\r\n    fontWeight: 'bold',\r\n    color: THEME.text.light,\r\n    marginBottom: 15,\r\n  },\r\n  input: {\r\n    borderWidth: 1,\r\n    borderColor: THEME.accent,\r\n    borderRadius: 5,\r\n    padding: 10,\r\n    marginBottom: 10,\r\n    color: THEME.text.light,\r\n    backgroundColor: THEME.background.primary,\r\n  },\r\n  modalButtons: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-around',\r\n    marginTop: 15,\r\n  },\r\n  modalButton: {\r\n    padding: 10,\r\n    borderRadius: 5,\r\n    minWidth: 100,\r\n    alignItems: 'center',\r\n  },\r\n  buttonText: {\r\n    color: THEME.text.light,\r\n    fontWeight: 'bold',\r\n    fontSize: isSmallScreen ? 12 : 14,\r\n  },\r\n  loadingContainer: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    backgroundColor: THEME.background.primary,\r\n    width: '100%',\r\n    height: '100%',\r\n  },\r\n  loadingText: {\r\n    color: THEME.text.light,\r\n    fontSize: 16,\r\n    marginTop: 10,\r\n  },\r\n  loadingButtonContent: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n  },\r\n  diceBox: {\r\n    width: '100%',\r\n    backgroundColor: THEME.background.panel,\r\n    borderRadius: 10,\r\n    padding: isSmallScreen ? 8 : 15,\r\n  },\r\n  diceControls: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 10,\r\n  },\r\n  diceButtons: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 5,\r\n    justifyContent: 'center',\r\n  },\r\n  diceButton: {\r\n    padding: isSmallScreen ? 5 : 10,\r\n    backgroundColor: THEME.primary,\r\n    borderRadius: 5,\r\n    alignItems: 'center',\r\n    minWidth: isSmallScreen ? 30 : 60,\r\n  },\r\n  diceHistory: {\r\n    maxHeight: isSmallScreen ? 100 : 200,\r\n    marginTop: 10,\r\n  },\r\n  diceResultContainer: {\r\n    padding: 5,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: THEME.accent + '40',\r\n  },\r\n  diceResult: {\r\n    color: THEME.text.light,\r\n  },\r\n  diceTotal: {\r\n    fontWeight: 'bold',\r\n    color: THEME.accent,\r\n  },\r\n  diceRolls: {\r\n    color: THEME.text.light + '80',\r\n    fontSize: 12,\r\n  },\r\n  initiativeList: {\r\n    backgroundColor: THEME.background.panel,\r\n    borderRadius: 10,\r\n    padding: isSmallScreen ? 8 : 15,\r\n    width: '100%',\r\n  },\r\n  initiativeScroll: {\r\n    maxHeight: isSmallScreen ? 150 : 200,\r\n  },\r\n  initiativeItem: {\r\n    padding: 10,\r\n    borderRadius: 5,\r\n    marginBottom: 5,\r\n    backgroundColor: THEME.background.primary,\r\n  },\r\n  currentInitiative: {\r\n    backgroundColor: THEME.accent,\r\n  },\r\n  initiativeText: {\r\n    color: THEME.text.light,\r\n  },\r\n  currentInitiativeText: {\r\n    color: THEME.text.dark,\r\n    fontWeight: 'bold',\r\n  },\r\n  zoomControls: {\r\n    position: 'absolute',\r\n    right: 10,\r\n    bottom: 10,\r\n    flexDirection: 'row',\r\n    gap: 10,\r\n    display: isSmallScreen ? 'flex' : 'none',\r\n  },\r\n  zoomButton: {\r\n    width: 40,\r\n    height: 40,\r\n    borderRadius: 20,\r\n    backgroundColor: THEME.background.panel,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    opacity: 0.8,\r\n  },\r\n  advantageButton: {\r\n    backgroundColor: THEME.background.primary,\r\n    padding: 8,\r\n    borderRadius: 5,\r\n  },\r\n  advantageActive: {\r\n    backgroundColor: THEME.accent,\r\n  },\r\n  modifierInput: {\r\n    backgroundColor: THEME.background.primary,\r\n    color: THEME.text.light,\r\n    padding: 8,\r\n    borderRadius: 5,\r\n    width: 60,\r\n    textAlign: 'center',\r\n  },\r\n  boxTitle: {\r\n    color: THEME.text.light,\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n    marginBottom: 10,\r\n  },\r\n  colorPicker: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'center',\r\n    gap: isSmallScreen ? 2 : 5,\r\n    marginBottom: isSmallScreen ? 5 : 10,\r\n  },\r\n  colorButton: {\r\n    width: isSmallScreen ? 20 : 30,\r\n    height: isSmallScreen ? 20 : 30,\r\n    borderRadius: isSmallScreen ? 10 : 15,\r\n    margin: isSmallScreen ? 1 : 2,\r\n  },\r\n  selectedColor: {\r\n    borderWidth: 2,\r\n    borderColor: THEME.accent,\r\n  },\r\n  quickActions: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 10,\r\n    padding: 15,\r\n    backgroundColor: THEME.background.panel,\r\n    borderRadius: 10,\r\n    marginBottom: 15,\r\n  },\r\n  quickActionButton: {\r\n    backgroundColor: THEME.background.secondary,\r\n    padding: 12,\r\n    borderRadius: 8,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    minWidth: 100,\r\n    flex: 1,\r\n  },\r\n  quickActionText: {\r\n    color: THEME.text.light,\r\n    fontSize: 14,\r\n    fontWeight: 'bold',\r\n  },\r\n  infoPanel: {\r\n    backgroundColor: THEME.background.panel,\r\n    padding: 15,\r\n    borderRadius: 10,\r\n    marginBottom: 15,\r\n  },\r\n  infoPanelTitle: {\r\n    color: THEME.text.light,\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n    marginBottom: 10,\r\n  },\r\n  infoGrid: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 10,\r\n  },\r\n  infoCard: {\r\n    backgroundColor: THEME.background.secondary,\r\n    padding: 12,\r\n    borderRadius: 8,\r\n    flex: 1,\r\n    minWidth: 150,\r\n  },\r\n  infoLabel: {\r\n    color: THEME.accent,\r\n    fontSize: 12,\r\n    marginBottom: 5,\r\n  },\r\n  infoValue: {\r\n    color: THEME.text.light,\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n  },\r\n  statBadge: {\r\n    backgroundColor: THEME.accent + '20',\r\n    paddingVertical: 4,\r\n    paddingHorizontal: 8,\r\n    borderRadius: 12,\r\n    alignSelf: 'flex-start',\r\n  },\r\n  statBadgeText: {\r\n    color: THEME.accent,\r\n    fontSize: 12,\r\n    fontWeight: 'bold',\r\n  },\r\n  divider: {\r\n    height: 1,\r\n    backgroundColor: THEME.accent + '40',\r\n    marginVertical: 15,\r\n  },\r\n});\r\n\r\nconst additionalStyles = StyleSheet.create({\r\n  characterSheet: {\r\n    backgroundColor: THEME.background.panel,\r\n    padding: 20,\r\n    borderRadius: 10,\r\n    width: isSmallScreen ? '95%' : '80%',\r\n    maxWidth: 800,\r\n    maxHeight: '90%',\r\n  },\r\n  sheetHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    marginBottom: 20,\r\n  },\r\n  sheetSection: {\r\n    marginBottom: 20,\r\n  },\r\n  sectionTitle: {\r\n    fontSize: 18,\r\n    fontWeight: 'bold',\r\n    color: THEME.text.light,\r\n    marginBottom: 10,\r\n  },\r\n  abilityScores: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    justifyContent: 'space-around',\r\n    gap: 10,\r\n  },\r\n  abilityBox: {\r\n    backgroundColor: THEME.background.primary,\r\n    padding: 10,\r\n    borderRadius: 5,\r\n    alignItems: 'center',\r\n    width: isSmallScreen ? '30%' : 100,\r\n    marginBottom: 10,\r\n  },\r\n  abilityLabel: {\r\n    color: THEME.text.light,\r\n    fontWeight: 'bold',\r\n  },\r\n  abilityScore: {\r\n    color: THEME.accent,\r\n    fontSize: 24,\r\n    fontWeight: 'bold',\r\n    width: '100%',\r\n    textAlign: 'center',\r\n    padding: 5,\r\n  },\r\n  abilityMod: {\r\n    color: THEME.text.light,\r\n  },\r\n  skillsList: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 10,\r\n  },\r\n  skillItem: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    backgroundColor: THEME.background.primary,\r\n    padding: 8,\r\n    borderRadius: 5,\r\n    minWidth: isSmallScreen ? '45%' : 200,\r\n  },\r\n  proficientDot: {\r\n    width: 10,\r\n    height: 10,\r\n    borderRadius: 5,\r\n    marginRight: 5,\r\n  },\r\n  skillName: {\r\n    color: THEME.text.light,\r\n    flex: 1,\r\n  },\r\n  skillMod: {\r\n    color: THEME.accent,\r\n    fontWeight: 'bold',\r\n  },\r\n  closeButton: {\r\n    position: 'absolute',\r\n    top: 10,\r\n    right: 10,\r\n    padding: 10,\r\n  },\r\n  closeButtonText: {\r\n    color: THEME.text.light,\r\n    fontSize: 20,\r\n  },\r\n  lootSection: {\r\n    backgroundColor: THEME.background.primary,\r\n    padding: 15,\r\n    borderRadius: 5,\r\n    marginBottom: 15,\r\n  },\r\n  currencyRow: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 8,\r\n  },\r\n  currencyInput: {\r\n    backgroundColor: THEME.background.secondary,\r\n    color: THEME.text.light,\r\n    padding: 8,\r\n    borderRadius: 5,\r\n    width: 80,\r\n    textAlign: 'center',\r\n  },\r\n  currencyLabel: {\r\n    color: THEME.text.light,\r\n    width: 30,\r\n  },\r\n  itemRow: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    marginBottom: 8,\r\n    gap: 10,\r\n  },\r\n  itemInput: {\r\n    flex: 1,\r\n    backgroundColor: THEME.background.secondary,\r\n    color: THEME.text.light,\r\n    padding: 8,\r\n    borderRadius: 5,\r\n  },\r\n  removeButton: {\r\n    padding: 5,\r\n    borderRadius: 5,\r\n    backgroundColor: THEME.danger,\r\n  },\r\n  addButton: {\r\n    backgroundColor: THEME.success,\r\n    padding: 8,\r\n    borderRadius: 5,\r\n    alignItems: 'center',\r\n    marginTop: 10,\r\n  },\r\n  lootHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 10,\r\n  },\r\n  itemInfo: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 10,\r\n    flex: 1,\r\n  },\r\n  addedBy: {\r\n    color: THEME.text.light,\r\n    opacity: 0.6,\r\n    fontSize: 12,\r\n    marginTop: 4,\r\n  },\r\n  enemyOption: {\r\n    padding: 15,\r\n    borderRadius: 5,\r\n    marginBottom: 8,\r\n    backgroundColor: THEME.background.secondary,\r\n  },\r\n  dmToggle: {\r\n    backgroundColor: THEME.background.secondary,\r\n    padding: 10,\r\n    borderRadius: 5,\r\n    marginLeft: 10,\r\n  },\r\n  dmToggleActive: {\r\n    backgroundColor: THEME.accent,\r\n  }\r\n});\r\n\r\nconst diceStyles = StyleSheet.create({\r\n  dicePanel: {\r\n    backgroundColor: THEME.background.panel,\r\n    borderRadius: 10,\r\n    padding: 15,\r\n    marginBottom: 15,\r\n  },\r\n  diceHeader: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 15,\r\n  },\r\n  diceTitle: {\r\n    color: THEME.text.light,\r\n    fontSize: 18,\r\n    fontWeight: 'bold',\r\n  },\r\n  diceGrid: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 8,\r\n    justifyContent: 'center',\r\n    marginBottom: 15,\r\n  },\r\n  diceButton: {\r\n    width: isSmallScreen ? 45 : 60,\r\n    height: isSmallScreen ? 45 : 60,\r\n    borderRadius: 10,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    boxShadow: '0px 2px 3.84px rgba(0, 0, 0, 0.25)', // Replace elevation and shadowProps\r\n  },\r\n  diceButtonText: {\r\n    color: THEME.text.light,\r\n    fontSize: isSmallScreen ? 14 : 16,\r\n    fontWeight: 'bold',\r\n  },\r\n  diceControls: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    backgroundColor: THEME.background.primary,\r\n    padding: 10,\r\n    borderRadius: 8,\r\n    marginBottom: 15,\r\n  },\r\n  controlGroup: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 8,\r\n  },\r\n  controlButton: {\r\n    backgroundColor: THEME.background.secondary,\r\n    padding: 8,\r\n    borderRadius: 5,\r\n    minWidth: 80,\r\n    alignItems: 'center',\r\n  },\r\n  controlActive: {\r\n    backgroundColor: THEME.accent,\r\n  },\r\n  modifierGroup: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 5,\r\n  },\r\n  modifierLabel: {\r\n    color: THEME.text.light,\r\n    fontSize: 14,\r\n  },\r\n  modifierInput: {\r\n    backgroundColor: THEME.background.secondary,\r\n    color: THEME.text.light,\r\n    padding: 8,\r\n    borderRadius: 5,\r\n    width: 50,\r\n    textAlign: 'center',\r\n  },\r\n  historyContainer: {\r\n    backgroundColor: THEME.background.primary,\r\n    borderRadius: 8,\r\n    maxHeight: 200,\r\n  },\r\n  historyScroll: {\r\n    padding: 10,\r\n  },\r\n  historyItem: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 12,\r\n    borderBottomWidth: 1,\r\n    borderBottomColor: THEME.background.secondary,\r\n  },\r\n  historyLeft: {\r\n    flex: 1,\r\n  },\r\n  historyInfo: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 5,\r\n  },\r\n  historyDice: {\r\n    color: THEME.text.light,\r\n    opacity: 0.7,\r\n  },\r\n  historyRolls: {\r\n    color: THEME.text.light,\r\n    fontSize: 12,\r\n    opacity: 0.5,\r\n  },\r\n  historyTotal: {\r\n    color: THEME.accent,\r\n    fontSize: 18,\r\n    fontWeight: 'bold',\r\n  },\r\n  clearButton: {\r\n    backgroundColor: THEME.background.secondary,\r\n    padding: 8,\r\n    borderRadius: 5,\r\n    alignItems: 'center',\r\n    marginTop: 10,\r\n  },\r\n  quantityGroup: {\r\n    flexDirection: 'row',\r\n    alignItems: 'center',\r\n    gap: 5,\r\n  },\r\n  quantityLabel: {\r\n    color: THEME.text.light,\r\n    fontSize: 14,\r\n  },\r\n  quantityInput: {\r\n    backgroundColor: THEME.background.secondary,\r\n    color: THEME.text.light,\r\n    padding: 8,\r\n    borderRadius: 5,\r\n    width: 50,\r\n    textAlign: 'center',\r\n  },\r\n  diceControls: {\r\n    flexDirection: 'column',\r\n    backgroundColor: THEME.background.primary,\r\n    padding: 10,\r\n    borderRadius: 8,\r\n    marginBottom: 15,\r\n    gap: 10,\r\n  },\r\n  controlsRow: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n  },\r\n  diceContainer: {\r\n    width: isSmallScreen ? 80 : 100,\r\n    height: isSmallScreen ? 80 : 100,\r\n    borderRadius: 10,\r\n    overflow: 'hidden',\r\n    marginBottom: 5,\r\n  }\r\n});\r\n\r\nconst statusStyles = StyleSheet.create({\r\n  effectsContainer: {\r\n    marginTop: 15,\r\n    borderTopWidth: 1,\r\n    borderTopColor: THEME.accent + '40',\r\n    paddingTop: 15,\r\n  },\r\n  effectsTitle: {\r\n    color: THEME.text.light,\r\n    fontSize: 16,\r\n    fontWeight: 'bold',\r\n    marginBottom: 10,\r\n  },\r\n  effectsGrid: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 8,\r\n  },\r\n  effectButton: {\r\n    backgroundColor: THEME.background.primary,\r\n    padding: 8,\r\n    borderRadius: 5,\r\n    alignItems: 'center',\r\n    minWidth: 80,\r\n  },\r\n  effectActive: {\r\n    backgroundColor: THEME.accent,\r\n  },\r\n  effectText: {\r\n    color: THEME.text.light,\r\n    fontSize: 12,\r\n  },\r\n  tokenEffects: {\r\n    flexDirection: 'row',\r\n    flexWrap: 'wrap',\r\n    gap: 2,\r\n    marginTop: 2,\r\n  },\r\n  effectIcon: {\r\n    fontSize: isSmallScreen ? 10 : 12,\r\n  },\r\n});\r\n\r\n// Create a helper function to save game state\r\nconst saveGameState = async () => {\r\n  if (firebaseRef.current) {\r\n    try {\r\n      await set(firebaseRef.current, {\r\n        tokens,\r\n        layers,\r\n        initiative,\r\n        inCombat,\r\n        currentTurn,\r\n        partyLoot,\r\n        characters,\r\n        settings: initialGameState.settings,\r\n        lastUpdate: Date.now()\r\n      });\r\n    } catch (error) {\r\n      console.error('Error saving game state:', error);\r\n      Alert.alert('Error', 'Failed to save game state');\r\n    }\r\n  }\r\n};\r\n\r\n// Add this component definition before the TokenModal component\r\nconst CharacterSheetModal = memo(({ visible, onClose, character, characters, onUpdate }) => {\r\n  const [editedCharacter, setEditedCharacter] = useState(() => ({\r\n    name: character?.name || '',\r\n    class: character?.class || '',\r\n    level: character?.level || 1,\r\n    owner: character?.owner || '',\r\n    proficiencyBonus: character?.proficiencyBonus || 2,\r\n    // Add HP and AC\r\n    hp: character?.hp || 0,\r\n    maxHp: character?.maxHp || 0,\r\n    ac: character?.ac || 10,\r\n    abilityScores: character?.abilityScores || {\r\n      STR: 10,\r\n      DEX: 10,\r\n      CON: 10,\r\n      INT: 10,\r\n      WIS: 10,\r\n      CHA: 10\r\n    },\r\n    proficientSkills: character?.proficientSkills || [],\r\n    currency: character?.currency || {\r\n      CP: 0,\r\n      SP: 0,\r\n      EP: 0,\r\n      GP: 0,\r\n      PP: 0\r\n    },\r\n    items: character?.items || [],\r\n    inventory: character?.inventory || []\r\n  }));\r\n\r\n  useEffect(() => {\r\n    if (visible && character) {\r\n      setEditedCharacter({\r\n        name: character.name || '',\r\n        class: character.class || '',\r\n        level: character.level || 1,\r\n        owner: character.owner || '',\r\n        proficiencyBonus: character.proficiencyBonus || 2,\r\n        hp: character.hp || 0,\r\n        maxHp: character.maxHp || 0,\r\n        ac: character.ac || 10,\r\n        abilityScores: character.abilityScores || {\r\n          STR: 10,\r\n          DEX: 10,\r\n          CON: 10,\r\n          INT: 10,\r\n          WIS: 10,\r\n          CHA: 10\r\n        },\r\n        proficientSkills: character.proficientSkills || [],\r\n        currency: character.currency || {\r\n          CP: 0,\r\n          SP: 0,\r\n          EP: 0,\r\n          GP: 0,\r\n          PP: 0\r\n        },\r\n        items: character.items || [],\r\n        inventory: character.inventory || []\r\n      });\r\n    }\r\n  }, [visible, character]);\r\n\r\n  // Add error boundary\r\n  if (!character) {\r\n    console.error('No character data provided to CharacterSheetModal');\r\n    return null;\r\n  }\r\n\r\n  const calculateModifier = (score) => {\r\n    return Math.floor((score - 10) / 2);\r\n  };\r\n\r\n  const handleAbilityScoreChange = (ability, value) => {\r\n    const newScore = parseInt(value) || 0;\r\n    setEditedCharacter(prev => ({\r\n      ...prev,\r\n      abilityScores: {\r\n        ...prev.abilityScores,\r\n        [ability]: newScore\r\n      }\r\n    }));\r\n  };\r\n\r\n  const toggleProficiency = (skill) => {\r\n    setEditedCharacter(prev => ({\r\n      ...prev,\r\n      proficientSkills: prev.proficientSkills.includes(skill)\r\n        ? prev.proficientSkills.filter(s => s !== skill)\r\n        : [...prev.proficientSkills, skill]\r\n    }));\r\n  };\r\n\r\n  const getSkillModifier = (skill, ability) => {\r\n    const abilityMod = calculateModifier(editedCharacter.abilityScores[ability]);\r\n    const profBonus = editedCharacter.proficientSkills.includes(skill) ? editedCharacter.proficiencyBonus : 0;\r\n    return abilityMod + profBonus;\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    try {\r\n      const updatedCharacter = {\r\n        ...character,\r\n        ...editedCharacter\r\n      };\r\n\r\n      onUpdate(updatedCharacter);\r\n    } catch (error) {\r\n      console.error('Error saving character:', error);\r\n      Alert.alert('Error', 'Failed to save character');\r\n    }\r\n  };\r\n\r\n  if (!visible) return null;\r\n\r\n  return (\r\n    <Modal\r\n      visible={visible}\r\n      transparent={true}\r\n      animationType=\"fade\"\r\n      onRequestClose={onClose}\r\n    >\r\n      <View style={styles.modalOverlay}>\r\n        <View style={additionalStyles.characterSheet}>\r\n          <TouchableOpacity \r\n            style={additionalStyles.closeButton}\r\n            onPress={onClose}\r\n          >\r\n            <Text style={additionalStyles.closeButtonText}>Ã—</Text>\r\n          </TouchableOpacity>\r\n\r\n          <GestureScrollView>\r\n            {/* Basic Info */}\r\n            <View style={additionalStyles.sheetSection}>\r\n              <Text style={additionalStyles.sectionTitle}>Character Info</Text>\r\n              <TextInput\r\n                style={styles.input}\r\n                value={editedCharacter.name}\r\n                onChangeText={(text) => setEditedCharacter(prev => ({...prev, name: text}))}\r\n                placeholder=\"Character Name\"\r\n                placeholderTextColor={THEME.text.light + '80'}\r\n              />\r\n              <View style={{ flexDirection: 'row', gap: 10 }}>\r\n                <TextInput\r\n                  style={[styles.input, { flex: 1 }]}\r\n                  value={editedCharacter.class}\r\n                  onChangeText={(text) => setEditedCharacter(prev => ({...prev, class: text}))}\r\n                  placeholder=\"Class\"\r\n                  placeholderTextColor={THEME.text.light + '80'}\r\n                />\r\n                <TextInput\r\n                  style={[styles.input, { flex: 1 }]}\r\n                  value={String(editedCharacter.level)}\r\n                  onChangeText={(text) => setEditedCharacter(prev => ({...prev, level: parseInt(text) || 1}))}\r\n                  placeholder=\"Level\"\r\n                  keyboardType=\"numeric\"\r\n                  placeholderTextColor={THEME.text.light + '80'}\r\n                />\r\n              </View>\r\n\r\n              {/* Add HP and AC fields here */}\r\n              <View style={{ flexDirection: 'row', gap: 10, marginTop: 10 }}>\r\n                <View style={{ flex: 2 }}>\r\n                  <Text style={[styles.buttonText, { marginBottom: 5 }]}>Hit Points</Text>\r\n                  <View style={{ flexDirection: 'row', gap: 5 }}>\r\n                    <TextInput\r\n                      style={[styles.input, { flex: 1 }]}\r\n                      value={String(editedCharacter.hp)}\r\n                      onChangeText={(text) => setEditedCharacter(prev => ({\r\n                        ...prev,\r\n                        hp: parseInt(text) || 0\r\n                      }))}\r\n                      placeholder=\"Current HP\"\r\n                      keyboardType=\"numeric\"\r\n                      placeholderTextColor={THEME.text.light + '80'}\r\n                    />\r\n                    <Text style={{ color: THEME.text.light, alignSelf: 'center', fontSize: 18 }}>/</Text>\r\n                    <TextInput\r\n                      style={[styles.input, { flex: 1 }]}\r\n                      value={String(editedCharacter.maxHp)}\r\n                      onChangeText={(text) => setEditedCharacter(prev => ({\r\n                        ...prev,\r\n                        maxHp: parseInt(text) || 0\r\n                      }))}\r\n                      placeholder=\"Max HP\"\r\n                      keyboardType=\"numeric\"\r\n                      placeholderTextColor={THEME.text.light + '80'}\r\n                    />\r\n                  </View>\r\n                </View>\r\n                <View style={{ flex: 1 }}>\r\n                  <Text style={[styles.buttonText, { marginBottom: 5 }]}>Armor Class</Text>\r\n                  <TextInput\r\n                    style={styles.input}\r\n                    value={String(editedCharacter.ac)}\r\n                    onChangeText={(text) => setEditedCharacter(prev => ({\r\n                      ...prev,\r\n                      ac: parseInt(text) || 10\r\n                    }))}\r\n                    placeholder=\"AC\"\r\n                    keyboardType=\"numeric\"\r\n                    placeholderTextColor={THEME.text.light + '80'}\r\n                  />\r\n                </View>\r\n              </View>\r\n            </View>\r\n\r\n            {/* Ability Scores */}\r\n            <View style={additionalStyles.sheetSection}>\r\n              <Text style={additionalStyles.sectionTitle}>Ability Scores</Text>\r\n              <View style={additionalStyles.abilityScores}>\r\n                {ABILITY_SCORES.map(ability => (\r\n                  <View key={ability} style={additionalStyles.abilityBox}>\r\n                    <Text style={additionalStyles.abilityLabel}>{ability}</Text>\r\n                    <TextInput\r\n                      style={additionalStyles.abilityScore}\r\n                      value={String(editedCharacter.abilityScores[ability])}\r\n                      onChangeText={(text) => handleAbilityScoreChange(ability, text)}\r\n                      keyboardType=\"numeric\"\r\n                      maxLength={2}\r\n                      selectTextOnFocus={true}\r\n                    />\r\n                    <Text style={additionalStyles.abilityMod}>\r\n                      {calculateModifier(editedCharacter.abilityScores[ability]) >= 0 ? '+' : ''}\r\n                      {calculateModifier(editedCharacter.abilityScores[ability])}\r\n                    </Text>\r\n                  </View>\r\n                ))}\r\n              </View>\r\n            </View>\r\n\r\n            {/* Skills */}\r\n            <View style={additionalStyles.sheetSection}>\r\n              <Text style={additionalStyles.sectionTitle}>Skills</Text>\r\n              <View style={additionalStyles.skillsList}>\r\n                {Object.entries(SKILLS).map(([ability, skills]) =>\r\n                  skills.map(skill => (\r\n                    <TouchableOpacity\r\n                      key={skill}\r\n                      style={additionalStyles.skillItem}\r\n                      onPress={() => toggleProficiency(skill)}\r\n                    >\r\n                      <View style={[\r\n                        additionalStyles.proficientDot,\r\n                        {\r\n                          backgroundColor: editedCharacter.proficientSkills.includes(skill)\r\n                            ? THEME.accent\r\n                            : THEME.background.secondary\r\n                        }\r\n                      ]} />\r\n                      <Text style={additionalStyles.skillName}>{skill}</Text>\r\n                      <Text style={additionalStyles.skillMod}>\r\n                        {getSkillModifier(skill, ability) >= 0 ? '+' : ''}\r\n                        {getSkillModifier(skill, ability)}\r\n                      </Text>\r\n                    </TouchableOpacity>\r\n                  ))\r\n                )}\r\n              </View>\r\n            </View>\r\n\r\n            {/* Inventory */}\r\n            <View style={additionalStyles.sheetSection}>\r\n              <Text style={additionalStyles.sectionTitle}>Inventory</Text>\r\n\r\n              <View style={additionalStyles.lootSection}>\r\n                {/* Currency */}\r\n                {CURRENCY.map(currency => (\r\n                  <View key={currency} style={additionalStyles.currencyRow}>\r\n                    <Text style={additionalStyles.currencyLabel}>{currency}</Text>\r\n                    <TextInput\r\n                      style={additionalStyles.currencyInput}\r\n                      value={String(editedCharacter.currency[currency] || 0)}\r\n                      onChangeText={(text) => {\r\n                        const value = parseInt(text) || 0;\r\n                        setEditedCharacter(prev => ({\r\n                          ...prev,\r\n                          currency: {\r\n                            ...prev.currency,\r\n                            [currency]: value\r\n                          }\r\n                        }));\r\n                      }}\r\n                      keyboardType=\"numeric\"\r\n                      placeholderTextColor={THEME.text.light + '80'}\r\n                    />\r\n                  </View>\r\n                ))}\r\n              </View>\r\n\r\n              <View style={additionalStyles.lootSection}>\r\n                <View style={additionalStyles.lootHeader}>\r\n                  <Text style={additionalStyles.sectionTitle}>Items</Text>\r\n                  <TouchableOpacity\r\n                    style={additionalStyles.addButton}\r\n                    onPress={() => {\r\n                      setEditedCharacter(prev => ({\r\n                        ...prev,\r\n                        items: [...prev.items, { name: '', quantity: 1, notes: '', addedBy: character.name }]\r\n                      }));\r\n                    }}\r\n                  >\r\n                    <Text style={styles.buttonText}>Add Item</Text>\r\n                  </TouchableOpacity>\r\n                </View>\r\n\r\n                {editedCharacter.items.map((item, index) => (\r\n                  <View key={index} style={additionalStyles.itemRow}>\r\n                    <View style={additionalStyles.itemInfo}>\r\n                      <TextInput\r\n                        style={[additionalStyles.itemInput, { flex: 2 }]}\r\n                        value={item.name}\r\n                        onChangeText={(text) => {\r\n                          const newItems = [...editedCharacter.items];\r\n                          newItems[index] = { ...item, name: text };\r\n                          setEditedCharacter(prev => ({ ...prev, items: newItems }));\r\n                        }}\r\n                        placeholder=\"Item name\"\r\n                        placeholderTextColor={THEME.text.light + '80'}\r\n                      />\r\n                      <TextInput\r\n                        style={[additionalStyles.itemInput, { width: 60 }]}\r\n                        value={String(item.quantity)}\r\n                        onChangeText={(text) => {\r\n                          const newItems = [...editedCharacter.items];\r\n                          newItems[index] = { ...item, quantity: parseInt(text) || 1 };\r\n                          setEditedCharacter(prev => ({ ...prev, items: newItems }));\r\n                        }}\r\n                        keyboardType=\"numeric\"\r\n                        placeholder=\"Qty\"\r\n                        placeholderTextColor={THEME.text.light + '80'}\r\n                      />\r\n                      {item.addedBy === character.name && (\r\n                        <TouchableOpacity\r\n                          style={additionalStyles.removeButton}\r\n                          onPress={() => {\r\n                            setEditedCharacter(prev => ({\r\n                              ...prev,\r\n                              items: prev.items.filter((_, i) => i !== index)\r\n                            }));\r\n                          }}\r\n                        >\r\n                          <Text style={styles.buttonText}>Ã—</Text>\r\n                        </TouchableOpacity>\r\n                      )}\r\n                    </View>\r\n                    <Text style={additionalStyles.addedBy}>Added by: {item.addedBy}</Text>\r\n                  </View>\r\n                ))}\r\n              </View>\r\n\r\n              <TouchableOpacity\r\n                style={[styles.modalButton, { backgroundColor: THEME.success }]}\r\n                onPress={handleSave}\r\n              >\r\n                <Text style={styles.buttonText}>Save Changes</Text>\r\n              </TouchableOpacity>\r\n            </View>\r\n          </GestureScrollView>\r\n        </View>\r\n      </View>\r\n    </Modal>\r\n  );\r\n});\r\n\r\n// Memoized Modal Components\r\nconst TokenModal = memo(({ \r\n  showTokenModal, \r\n  setShowTokenModal, \r\n  selectedToken, \r\n  setSelectedToken, \r\n  tokens, \r\n  firebaseRef, \r\n  initialGameState, \r\n  layers, \r\n  initiative, \r\n  inCombat, \r\n  currentTurn, \r\n  THEME \r\n}) => (\r\n  <Modal\r\n    visible={showTokenModal}\r\n    transparent={true}\r\n    animationType=\"fade\"\r\n    onRequestClose={() => setShowTokenModal(false)}\r\n  >\r\n    <Pressable \r\n      style={[styles.modalOverlay, { cursor: 'default' }]}\r\n      onPress={() => Keyboard.dismiss()}\r\n    >\r\n      <View style={styles.modalContent}>\r\n        <KeyboardAvoidingView \r\n          behavior={Platform.select({ ios: 'padding', android: 'height' })}\r\n          style={styles.modalContainer}\r\n          keyboardVerticalOffset={Platform.select({ ios: 64, android: 0 })}\r\n        >\r\n          <Pressable onPress={e => e.stopPropagation()}>\r\n            <Text style={styles.modalTitle}>Edit Token</Text>\r\n            <TextInput\r\n              style={styles.input}\r\n              value={selectedToken?.name}\r\n              onChangeText={(text) => {\r\n                setSelectedToken(prev => ({\r\n                  ...prev,\r\n                  name: text\r\n                }));\r\n              }}\r\n              placeholder=\"Token Name\"\r\n              placeholderTextColor={THEME.text.light + '80'}\r\n              blurOnSubmit={false}\r\n              autoComplete=\"off\"\r\n              spellCheck={false}\r\n              selectTextOnFocus={true}\r\n              enablesReturnKeyAutomatically={true}\r\n            />\r\n\r\n            <View style={{ flexDirection: 'row', gap: 10, marginBottom: 10 }}>\r\n              <View style={{ flex: 1 }}>\r\n                <TextInput\r\n                  style={styles.input}\r\n                  value={String(selectedToken?.hp || '')}\r\n                  onChangeText={(text) => {\r\n                    const hp = parseInt(text) || 0;\r\n                    setSelectedToken(prev => ({\r\n                      ...prev,\r\n                      hp: Math.max(0, hp)\r\n                    }));\r\n                  }}\r\n                  keyboardType=\"numeric\"\r\n                  placeholder=\"Current HP\"\r\n                  placeholderTextColor={THEME.text.light + '80'}\r\n                  blurOnSubmit={false}\r\n                  autoComplete=\"off\"\r\n                  selectTextOnFocus={true}\r\n                  enablesReturnKeyAutomatically={true}\r\n                />\r\n              </View>\r\n              <View style={{ flex: 1 }}>\r\n                <TextInput\r\n                  style={styles.input}\r\n                  value={String(selectedToken?.maxHp || '')}\r\n                  onChangeText={(text) => {\r\n                    const maxHp = parseInt(text) || 1;\r\n                    setSelectedToken(prev => ({\r\n                      ...prev,\r\n                      maxHp: Math.max(1, maxHp)\r\n                    }));\r\n                  }}\r\n                  keyboardType=\"numeric\"\r\n                  placeholder=\"Max HP\"\r\n                  placeholderTextColor={THEME.text.light + '80'}\r\n                  blurOnSubmit={false}\r\n                  autoComplete=\"off\"\r\n                  selectTextOnFocus={true}\r\n                  enablesReturnKeyAutomatically={true}\r\n                />\r\n              </View>\r\n            </View>\r\n\r\n            <TextInput\r\n              style={styles.input}\r\n              value={String(selectedToken?.initiativeBonus || '0')}\r\n              onChangeText={(text) => {\r\n                setSelectedToken(prev => ({\r\n                  ...prev,\r\n                  initiativeBonus: parseInt(text) || 0\r\n                }));\r\n              }}\r\n              keyboardType=\"numeric\"\r\n              placeholder=\"Initiative Bonus\"\r\n              placeholderTextColor={THEME.text.light + '80'}\r\n              blurOnSubmit={false}\r\n              autoComplete=\"off\"\r\n              selectTextOnFocus={true}\r\n              enablesReturnKeyAutomatically={true}\r\n            />\r\n\r\n            <View style={statusStyles.effectsContainer}>\r\n              <Text style={statusStyles.effectsTitle}>Status Effects</Text>\r\n              <View style={statusStyles.effectsGrid}>\r\n                {STATUS_EFFECTS.map(effect => (\r\n                  <TouchableOpacity\r\n                    key={effect.id}\r\n                    style={[\r\n                      statusStyles.effectButton,\r\n                      selectedToken?.effects?.includes(effect.id) && statusStyles.effectActive\r\n                    ]}\r\n                    onPress={() => {\r\n                      setSelectedToken(prev => {\r\n                        const currentEffects = prev.effects || [];\r\n                        const newEffects = currentEffects.includes(effect.id)\r\n                          ? currentEffects.filter(e => e !== effect.id)\r\n                          : [...currentEffects, effect.id];\r\n                        return {\r\n                          ...prev,\r\n                          effects: newEffects\r\n                        };\r\n                      });\r\n                    }}\r\n                  >\r\n                    <Text style={statusStyles.effectText}>\r\n                      {effect.icon} {effect.name}\r\n                    </Text>\r\n                  </TouchableOpacity>\r\n                ))}\r\n              </View>\r\n            </View>\r\n\r\n            <View style={styles.modalButtons}>\r\n              <TouchableOpacity\r\n                style={[styles.modalButton, { backgroundColor: THEME.danger }]}\r\n                onPress={() => {\r\n                  if (firebaseRef.current && selectedToken) {\r\n                    const newTokens = { ...tokens };\r\n                    delete newTokens[selectedToken.position];\r\n                    set(firebaseRef.current, { \r\n                      ...initialGameState,\r\n                      tokens: newTokens,\r\n                      layers,\r\n                      initiative,\r\n                      inCombat,\r\n                      currentTurn\r\n                    });\r\n                    setShowTokenModal(false);\r\n                  }\r\n                }}\r\n              >\r\n                <Text style={styles.buttonText}>Delete</Text>\r\n              </TouchableOpacity>\r\n\r\n              <TouchableOpacity\r\n                style={[styles.modalButton, { backgroundColor: THEME.success }]}\r\n                onPress={() => {\r\n                  if (firebaseRef.current && selectedToken) {\r\n                    const newTokens = {\r\n                      ...tokens,\r\n                      [selectedToken.position]: selectedToken\r\n                    };\r\n                    set(firebaseRef.current, {\r\n                      ...initialGameState,\r\n                      tokens: newTokens,\r\n                      layers,\r\n                      initiative,\r\n                      inCombat,\r\n                      currentTurn\r\n                    });\r\n                    setShowTokenModal(false);\r\n                  }\r\n                }}\r\n              >\r\n                <Text style={styles.buttonText}>Save</Text>\r\n              </TouchableOpacity>\r\n            </View>\r\n          </Pressable>\r\n        </KeyboardAvoidingView>\r\n      </View>\r\n    </Pressable>\r\n  </Modal>\r\n));\r\n\r\n// Update the RoomModal styles\r\nconst modalStyles = StyleSheet.create({\r\n  modalOverlay: {\r\n    position: 'absolute',\r\n    top: 0,\r\n    left: 0,\r\n    right: 0,\r\n    bottom: 0,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    zIndex: 1000, // Add high z-index\r\n  },\r\n  modalContent: {\r\n    backgroundColor: THEME.background.panel,\r\n    padding: 20,\r\n    borderRadius: 10,\r\n    width: '90%',\r\n    maxWidth: 400,\r\n    zIndex: 1001, // Even higher z-index\r\n  },\r\n});\r\n\r\n// Update the RoomModal component\r\nconst RoomModal = memo(({ \r\n  showRoomModal, \r\n  setShowRoomModal, \r\n  isConnected, \r\n  roomCode, \r\n  setRoomCode, \r\n  isJoining, \r\n  connectToRoom \r\n}) => (\r\n  <Modal\r\n    visible={showRoomModal}\r\n    transparent={true}\r\n    animationType=\"fade\"\r\n    onRequestClose={() => {}}\r\n    style={{ zIndex: 999 }} // Add z-index to Modal\r\n  >\r\n    <View style={[modalStyles.modalOverlay, { pointerEvents: 'auto' }]}>\r\n      <View style={modalStyles.modalContent}>\r\n        <Text style={styles.modalTitle}>Join Room</Text>\r\n        <TextInput\r\n          style={[styles.input, { marginBottom: 15, zIndex: 1002 }]} // Add z-index to input\r\n          value={roomCode}\r\n          onChangeText={(text) => {\r\n            setRoomCode(text.trim().toLowerCase());\r\n          }}\r\n          placeholder=\"Enter room code...\"\r\n          placeholderTextColor={THEME.text.light + '80'}\r\n          autoCapitalize=\"none\"\r\n          autoCorrect={false}\r\n          editable={!isJoining}\r\n          autoFocus={true}\r\n          blurOnSubmit={false}\r\n        />\r\n        <TouchableOpacity\r\n          style={[\r\n            styles.modalButton,\r\n            { \r\n              backgroundColor: isJoining ? THEME.background.secondary : THEME.success,\r\n              width: '100%',\r\n              zIndex: 1002 // Add z-index to button\r\n            }\r\n          ]}\r\n          onPress={() => {\r\n            Keyboard.dismiss();\r\n            connectToRoom(roomCode);\r\n          }}\r\n          disabled={isJoining}\r\n        >\r\n          {isJoining ? (\r\n            <View style={styles.loadingButtonContent}>\r\n              <ActivityIndicator color={THEME.text.light} />\r\n              <Text style={[styles.buttonText, { marginLeft: 10 }]}>\r\n                Connecting...\r\n              </Text>\r\n            </View>\r\n          ) : (\r\n            <Text style={styles.buttonText}>Join Room</Text>\r\n          )}\r\n        </TouchableOpacity>\r\n      </View>\r\n    </View>\r\n  </Modal>\r\n));\r\n\r\nconst PartyLootModal = memo(({ visible, onClose, partyLoot, onUpdate, playerName }) => {\r\n  const [editedLoot, setEditedLoot] = useState({\r\n    currency: {\r\n      CP: 0,\r\n      SP: 0,\r\n      EP: 0,\r\n      GP: 0,\r\n      PP: 0\r\n    },\r\n    items: []\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (visible && partyLoot) {\r\n      setEditedLoot({\r\n        currency: partyLoot.currency || {\r\n          CP: 0,\r\n          SP: 0,\r\n          EP: 0,\r\n          GP: 0,\r\n          PP: 0\r\n        },\r\n        items: partyLoot.items || []\r\n      });\r\n    }\r\n  }, [visible, partyLoot]);\r\n\r\n  if (!visible) return null;\r\n\r\n  return (\r\n    <Modal\r\n      visible={visible}\r\n      transparent={true}\r\n      animationType=\"fade\"\r\n      onRequestClose={onClose}\r\n    >\r\n      <View style={styles.modalOverlay}>\r\n        <View style={[styles.modalContent, { maxHeight: '90%' }]}>\r\n          <Text style={styles.modalTitle}>Party Loot</Text>\r\n\r\n          <ScrollView>\r\n            {/* Currency Section */}\r\n            <View style={additionalStyles.lootSection}>\r\n              {CURRENCY.map(type => (\r\n                <View key={type} style={additionalStyles.currencyRow}>\r\n                  <Text style={additionalStyles.currencyLabel}>{type}</Text>\r\n                  <TextInput\r\n                    style={additionalStyles.currencyInput}\r\n                    value={String(editedLoot.currency[type] || 0)}\r\n                    onChangeText={(text) => {\r\n                      const value = parseInt(text) || 0;\r\n                      setEditedLoot(prev => ({\r\n                        ...prev,\r\n                        currency: {\r\n                          ...prev.currency,\r\n                          [type]: value\r\n                        }\r\n                      }));\r\n                    }}\r\n                    keyboardType=\"numeric\"\r\n                    placeholderTextColor={THEME.text.light + '80'}\r\n                  />\r\n                </View>\r\n              ))}\r\n            </View>\r\n\r\n            {/* Items Section */}\r\n            <View style={additionalStyles.lootSection}>\r\n              <View style={additionalStyles.lootHeader}>\r\n                <Text style={additionalStyles.sectionTitle}>Items</Text>\r\n                <TouchableOpacity\r\n                  style={additionalStyles.addButton}\r\n                  onPress={() => {\r\n                    setEditedLoot(prev => ({\r\n                      ...prev,\r\n                      items: [...prev.items, { \r\n                        id: Date.now().toString(),\r\n                        name: '',\r\n                        quantity: 1,\r\n                        addedBy: playerName \r\n                      }]\r\n                    }));\r\n                  }}\r\n                >\r\n                  <Text style={styles.buttonText}>Add Item</Text>\r\n                </TouchableOpacity>\r\n              </View>\r\n\r\n              {editedLoot.items.map((item, index) => (\r\n                <View key={item.id || index} style={additionalStyles.itemRow}>\r\n                  <TextInput\r\n                    style={[additionalStyles.itemInput, { flex: 2 }]}\r\n                    value={item.name}\r\n                    onChangeText={(text) => {\r\n                      const newItems = [...editedLoot.items];\r\n                      newItems[index] = { ...item, name: text };\r\n                      setEditedLoot(prev => ({ ...prev, items: newItems }));\r\n                    }}\r\n                    placeholder=\"Item name\"\r\n                    placeholderTextColor={THEME.text.light + '80'}\r\n                  />\r\n                  <TextInput\r\n                    style={[additionalStyles.itemInput, { width: 60 }]}\r\n                    value={String(item.quantity)}\r\n                    onChangeText={(text) => {\r\n                      const newItems = [...editedLoot.items];\r\n                      newItems[index] = { ...item, quantity: parseInt(text) || 1 };\r\n                      setEditedLoot(prev => ({ ...prev, items: newItems }));\r\n                    }}\r\n                    keyboardType=\"numeric\"\r\n                    placeholder=\"Qty\"\r\n                    placeholderTextColor={THEME.text.light + '80'}\r\n                  />\r\n                  <TouchableOpacity\r\n                    style={additionalStyles.removeButton}\r\n                    onPress={() => {\r\n                      setEditedLoot(prev => ({\r\n                        ...prev,\r\n                        items: prev.items.filter((_, i) => i !== index)\r\n                      }));\r\n                    }}\r\n                  >\r\n                    <Text style={styles.buttonText}>Ã—</Text>\r\n                  </TouchableOpacity>\r\n                </View>\r\n              ))}\r\n            </View>\r\n          </ScrollView>\r\n\r\n          <View style={styles.buttonRow}>\r\n            <TouchableOpacity\r\n              style={[styles.button, styles.closeButton]}\r\n              onPress={onClose}\r\n            >\r\n              <Text style={styles.buttonText}>Cancel</Text>\r\n            </TouchableOpacity>\r\n            <TouchableOpacity\r\n              style={[styles.button, { backgroundColor: THEME.success }]}\r\n              onPress={() => {\r\n                onUpdate(editedLoot);\r\n                onClose();\r\n              }}\r\n            >\r\n              <Text style={styles.buttonText}>Save Changes</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        </View>\r\n      </View>\r\n    </Modal>\r\n  );\r\n});\r\n\r\n// Add this component definition before the App component\r\nconst GridZoomControls = memo(({ zoomLevel, setZoomLevel }) => {\r\n  const debouncedZoom = debounce((newZoom) => {\r\n    setZoomLevel(newZoom);\r\n  }, 100);\r\n\r\n  return (\r\n    <View style={styles.zoomControls}>\r\n      <TouchableOpacity\r\n        style={styles.zoomButton}\r\n        onPress={() => debouncedZoom(Math.max(0.5, zoomLevel - 0.1))}\r\n      >\r\n        <Text style={styles.buttonText}>-</Text>\r\n      </TouchableOpacity>\r\n      <TouchableOpacity\r\n        style={styles.zoomButton}\r\n        onPress={() => debouncedZoom(Math.min(2, zoomLevel + 0.1))}\r\n      >\r\n        <Text style={styles.buttonText}>+</Text>\r\n      </TouchableOpacity>\r\n    </View>\r\n  );\r\n});\r\n\r\n// Add InventoryModal component\r\nconst InventoryModal = memo(({ visible, onClose, character, onUpdate }) => {\r\n  const [editedInventory, setEditedInventory] = useState({\r\n    currency: character?.currency || {\r\n      CP: 0,\r\n      SP: 0,\r\n      EP: 0,\r\n      GP: 0,\r\n      PP: 0\r\n    },\r\n    inventory: character?.inventory || []\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (visible && character) {\r\n      setEditedInventory({\r\n        currency: character.currency || {\r\n          CP: 0,\r\n          SP: 0,\r\n          EP: 0,\r\n          GP: 0,\r\n          PP: 0\r\n        },\r\n        inventory: character.inventory || []\r\n      });\r\n    }\r\n  }, [visible, character]);\r\n\r\n  if (!visible || !character) return null;\r\n\r\n  return (\r\n    <Modal\r\n      visible={visible}\r\n      transparent={true}\r\n      animationType=\"fade\"\r\n      onRequestClose={onClose}\r\n    >\r\n      <View style={styles.modalOverlay}>\r\n        <View style={additionalStyles.characterSheet}>\r\n          <TouchableOpacity \r\n            style={additionalStyles.closeButton}\r\n            onPress={onClose}\r\n          >\r\n            <Text style={additionalStyles.closeButtonText}>Ã—</Text>\r\n          </TouchableOpacity>\r\n\r\n          <Text style={additionalStyles.sectionTitle}>{character.name}'s Inventory</Text>\r\n\r\n          <GestureScrollView>\r\n            <View style={additionalStyles.lootSection}>\r\n              {/* Currency */}\r\n              {CURRENCY.map(currency => (\r\n                <View key={currency} style={additionalStyles.currencyRow}>\r\n                  <Text style={additionalStyles.currencyLabel}>{currency}</Text>\r\n                  <TextInput\r\n                    style={additionalStyles.currencyInput}\r\n                    value={String(editedInventory.currency[currency] || 0)}\r\n                    onChangeText={(text) => {\r\n                      const value = parseInt(text) || 0;\r\n                      setEditedInventory(prev => ({\r\n                        ...prev,\r\n                        currency: {\r\n                          ...prev.currency,\r\n                          [currency]: value\r\n                        }\r\n                      }));\r\n                    }}\r\n                    keyboardType=\"numeric\"\r\n                    placeholderTextColor={THEME.text.light + '80'}\r\n                  />\r\n                </View>\r\n              ))}\r\n            </View>\r\n\r\n            <View style={additionalStyles.lootSection}>\r\n              <View style={additionalStyles.lootHeader}>\r\n                <Text style={additionalStyles.sectionTitle}>Items</Text>\r\n                <TouchableOpacity\r\n                  style={additionalStyles.addButton}\r\n                  onPress={() => {\r\n                    setEditedInventory(prev => ({\r\n                      ...prev,\r\n                      inventory: [...prev.inventory, { name: '', quantity: 1, notes: '', addedBy: character.name }]\r\n                    }));\r\n                  }}\r\n                >\r\n                  <Text style={styles.buttonText}>Add Item</Text>\r\n                </TouchableOpacity>\r\n              </View>\r\n\r\n              {editedInventory.inventory.map((item, index) => (\r\n                <View key={index} style={additionalStyles.itemRow}>\r\n                  <View style={additionalStyles.itemInfo}>\r\n                    <TextInput\r\n                      style={[additionalStyles.itemInput, { flex: 2 }]}\r\n                      value={item.name}\r\n                      onChangeText={(text) => {\r\n                        const newInventory = [...editedInventory.inventory];\r\n                        newInventory[index] = { ...item, name: text };\r\n                        setEditedInventory(prev => ({ ...prev, inventory: newInventory }));\r\n                      }}\r\n                      placeholder=\"Item name\"\r\n                      placeholderTextColor={THEME.text.light + '80'}\r\n                    />\r\n                    <TextInput\r\n                      style={[additionalStyles.itemInput, { width: 60 }]}\r\n                      value={String(item.quantity)}\r\n                      onChangeText={(text) => {\r\n                        const newInventory = [...editedInventory.inventory];\r\n                        newInventory[index] = { ...item, quantity: parseInt(text) || 1 };\r\n                        setEditedInventory(prev => ({ ...prev, inventory: newInventory }));\r\n                      }}\r\n                      keyboardType=\"numeric\"\r\n                      placeholder=\"Qty\"\r\n                      placeholderTextColor={THEME.text.light + '80'}\r\n                    />\r\n                    {item.addedBy === character.name && (\r\n                      <TouchableOpacity\r\n                        style={additionalStyles.removeButton}\r\n                        onPress={() => {\r\n                          setEditedInventory(prev => ({\r\n                            ...prev,\r\n                            inventory: prev.inventory.filter((_, i) => i !== index)\r\n                          }));\r\n                        }}\r\n                      >\r\n                        <Text style={styles.buttonText}>Ã—</Text>\r\n                      </TouchableOpacity>\r\n                    )}\r\n                  </View>\r\n                  <Text style={additionalStyles.addedBy}>Added by: {item.addedBy}</Text>\r\n                </View>\r\n              ))}\r\n            </View>\r\n\r\n            <TouchableOpacity\r\n              style={[styles.modalButton, { backgroundColor: THEME.success }]}\r\n              onPress={() => {\r\n                onUpdate({\r\n                  ...character,\r\n                  currency: editedInventory.currency,\r\n                  inventory: editedInventory.inventory\r\n                });\r\n                onClose();\r\n              }}\r\n            >\r\n              <Text style={styles.buttonText}>Save Changes</Text>\r\n            </TouchableOpacity>\r\n          </GestureScrollView>\r\n        </View>\r\n      </View>\r\n    </Modal>\r\n  );\r\n});\r\n\r\n// Add PlayerNameModal component\r\nconst PlayerNameModal = memo(({ visible, onSubmit }) => {\r\n  const [name, setName] = useState('');\r\n\r\n  return (\r\n    <Modal\r\n      visible={visible}\r\n      transparent={true}\r\n      animationType=\"fade\"\r\n      onRequestClose={() => {}}\r\n    >\r\n      <View style={styles.modalOverlay}>\r\n        <View style={styles.modalContent}>\r\n          <Text style={styles.modalTitle}>Enter Your Name</Text>\r\n          <TextInput\r\n            style={styles.input}\r\n            value={name}\r\n            onChangeText={setName}\r\n            placeholder=\"Your name\"\r\n            placeholderTextColor={THEME.text.light + '80'}\r\n            autoCapitalize=\"words\"\r\n          />\r\n          <TouchableOpacity\r\n            style={[styles.modalButton, { \r\n              backgroundColor: THEME.success,\r\n              width: '100%',\r\n              marginTop: 10\r\n            }]}\r\n            onPress={() => onSubmit(name)}\r\n            disabled={!name.trim()}\r\n          >\r\n            <Text style={styles.buttonText}>Continue</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n      </View>\r\n    </Modal>\r\n  );\r\n});\r\n\r\n// Add to styles\r\nconst viewerStyles = StyleSheet.create({\r\n  viewersList: {\r\n    marginTop: 15,\r\n    padding: 10,\r\n    backgroundColor: THEME.background.primary,\r\n    borderRadius: 5,\r\n  },\r\n  viewersTitle: {\r\n    color: THEME.text.light,\r\n    fontSize: 14,\r\n    fontWeight: 'bold',\r\n    marginBottom: 5,\r\n  },\r\n  viewerName: {\r\n    color: THEME.text.light,\r\n    opacity: 0.8,\r\n    fontSize: 12,\r\n    marginBottom: 2,\r\n  },\r\n});\r\n\r\n// Add this function at the top level of the App component, before the state declarations\r\nconst calculateModifier = (score) => {\r\n  return Math.floor((score - 10) / 2);\r\n};\r\n\r\n// Add this new component near the other modal components\r\nconst DiceResultModal = memo(({ visible, result, onClose }) => {\r\n  useEffect(() => {\r\n    if (visible) {\r\n      const timer = setTimeout(onClose, 2000);\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [visible, onClose]);\r\n\r\n  if (!visible || !result) return null;\r\n\r\n  return (\r\n    <View style={{\r\n      position: 'fixed', // Change from 'absolute' to 'fixed'\r\n      top: 0,\r\n      left: 0,\r\n      right: 0,\r\n      bottom: 0,\r\n      justifyContent: 'center',\r\n      alignItems: 'center',\r\n      zIndex: 9999, // Increase zIndex to ensure it's above everything\r\n      backgroundColor: 'rgba(0, 0, 0, 0.5)', // Add semi-transparent background\r\n    }}>\r\n      <View style={{\r\n        backgroundColor: THEME.background.panel + 'E6',\r\n        padding: 20,\r\n        borderRadius: 10,\r\n        alignItems: 'center',\r\n        minWidth: 200,\r\n        maxWidth: '90%',\r\n        shadowColor: '#000',\r\n        shadowOffset: { width: 0, height: 2 },\r\n        shadowOpacity: 0.25,\r\n        shadowRadius: 3.84,\r\n        elevation: 5,\r\n      }}>\r\n        <Text style={{\r\n          color: THEME.text.light,\r\n          fontSize: 18,\r\n          marginBottom: 5,\r\n        }}>\r\n          {result.dice} {result.rollType !== 'normal' ? `(${result.rollType})` : ''}\r\n        </Text>\r\n        <Text style={{\r\n          color: THEME.accent,\r\n          fontSize: 32,\r\n          fontWeight: 'bold',\r\n          marginBottom: 5,\r\n        }}>\r\n          {result.total}\r\n        </Text>\r\n        <Text style={{\r\n          color: THEME.text.light + '80',\r\n          fontSize: 14,\r\n        }}>\r\n          Rolls: [{result.rolls.join(', ')}]\r\n          {result.modifier !== 0 && ` + ${result.modifier}`}\r\n        </Text>\r\n      </View>\r\n    </View>\r\n  );\r\n});\r\n\r\n// Add this new component near the other modal components\r\nconst DeleteCharacterModal = memo(({ visible, character, onClose, onConfirm }) => {\r\n  const [confirmName, setConfirmName] = useState('');\r\n\r\n  return (\r\n    <Modal\r\n      visible={visible}\r\n      transparent={true}\r\n      animationType=\"fade\"\r\n      onRequestClose={onClose}\r\n    >\r\n      <View style={styles.modalOverlay}>\r\n        <View style={styles.modalContent}>\r\n          <Text style={styles.modalTitle}>Delete Character</Text>\r\n          <Text style={[styles.buttonText, { marginBottom: 10, textAlign: 'center' }]}>\r\n            Type \"{character?.name}\" to confirm deletion\r\n          </Text>\r\n          <TextInput\r\n            style={styles.input}\r\n            value={confirmName}\r\n            onChangeText={setConfirmName}\r\n            placeholder=\"Character name\"\r\n            placeholderTextColor={THEME.text.light + '80'}\r\n          />\r\n          <View style={[styles.modalButtons, { marginTop: 15 }]}>\r\n            <TouchableOpacity\r\n              style={[styles.modalButton, { backgroundColor: THEME.background.secondary }]}\r\n              onPress={onClose}\r\n            >\r\n              <Text style={styles.buttonText}>Cancel</Text>\r\n            </TouchableOpacity>\r\n            <TouchableOpacity\r\n              style={[\r\n                styles.modalButton, \r\n                { \r\n                  backgroundColor: confirmName === character?.name ? THEME.danger : THEME.background.secondary,\r\n                  opacity: confirmName === character?.name ? 1 : 0.5\r\n                }\r\n              ]}\r\n              onPress={() => {\r\n                if (confirmName === character?.name) {\r\n                  onConfirm();\r\n                }\r\n              }}\r\n              disabled={confirmName !== character?.name}\r\n            >\r\n              <Text style={styles.buttonText}>Delete</Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n        </View>\r\n      </View>\r\n    </Modal>\r\n  );\r\n});\r\n\r\n// Add this new component for the enemy selection modal\r\nconst EnemySelectModal = memo(({ visible, onClose, onSelect }) => {\r\n  return (\r\n    <Modal\r\n      visible={visible}\r\n      transparent={true}\r\n      animationType=\"fade\"\r\n      onRequestClose={onClose}\r\n    >\r\n      <View style={styles.modalOverlay}>\r\n        <View style={styles.modalContent}>\r\n          <Text style={styles.modalTitle}>Select Enemy</Text>\r\n          <ScrollView style={{ maxHeight: 300 }}>\r\n            {COMMON_ENEMIES.map((enemy, index) => (\r\n              <TouchableOpacity\r\n                key={index}\r\n                style={[\r\n                  styles.enemyOption,\r\n                  { backgroundColor: THEME.background.secondary }\r\n                ]}\r\n                onPress={() => onSelect(enemy)}\r\n              >\r\n                <Text style={styles.buttonText}>{enemy.name}</Text>\r\n                <Text style={[styles.buttonText, { opacity: 0.7, fontSize: 12 }]}>\r\n                  HP: {enemy.hp} â€¢ AC: {enemy.ac}\r\n                </Text>\r\n              </TouchableOpacity>\r\n            ))}\r\n          </ScrollView>\r\n          <TouchableOpacity\r\n            style={[styles.modalButton, { backgroundColor: THEME.background.secondary, marginTop: 10 }]}\r\n            onPress={onClose}\r\n          >\r\n            <Text style={styles.buttonText}>Cancel</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n      </View>\r\n    </Modal>\r\n  );\r\n});\r\n\r\nexport default function App() {\r\n  // Add calculateModifier here\r\n  const calculateModifier = (score) => {\r\n    return Math.floor((score - 10) / 2);\r\n  };\r\n\r\n  // State declarations\r\n  const [roomCode, setRoomCode] = useState('');\r\n  const [isConnected, setIsConnected] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isJoining, setIsJoining] = useState(false);\r\n  const [isUpdating, setIsUpdating] = useState(false);\r\n  const [showRoomModal, setShowRoomModal] = useState(true);\r\n  const [isDarkMode, setIsDarkMode] = useState(true);\r\n  const [zoomLevel, setZoomLevel] = useState(isSmallScreen ? 0.8 : 1);\r\n  const [tokens, setTokens] = useState({});\r\n  const [currentColor, setCurrentColor] = useState(COLORS[0]);\r\n  const [initiative, setInitiative] = useState([]);\r\n  const [inCombat, setInCombat] = useState(false);\r\n  const [currentTurn, setCurrentTurn] = useState(0);\r\n  const [layers, setLayers] = useState(initialGameState.layers);\r\n  const [diceHistory, setDiceHistory] = useState([]);\r\n  const [advantage, setAdvantage] = useState(false);\r\n  const [modifier, setModifier] = useState(0);\r\n  const [selectedToken, setSelectedToken] = useState(null);\r\n  const [showTokenModal, setShowTokenModal] = useState(false);\r\n  const [partyLoot, setPartyLoot] = useState({\r\n    currency: {\r\n      CP: 0,\r\n      SP: 0,\r\n      EP: 0,\r\n      GP: 0,\r\n      PP: 0\r\n    },\r\n    items: [],\r\n    currentViewer: null\r\n  });\r\n  const [showPartyLoot, setShowPartyLoot] = useState(false);\r\n  const [diceQuantity, setDiceQuantity] = useState(1);\r\n  const [characters, setCharacters] = useState([]);\r\n  const [showCharacterSheet, setShowCharacterSheet] = useState(false);\r\n  const [selectedCharacter, setSelectedCharacter] = useState(null);\r\n  const [showInventory, setShowInventory] = useState(false);\r\n  const [playerName, setPlayerName] = useState('');\r\n  const [showPlayerNameModal, setShowPlayerNameModal] = useState(true);\r\n  const [rollType, setRollType] = useState('normal'); // 'normal', 'advantage', or 'disadvantage'\r\n  const [diceResult, setDiceResult] = useState(null);\r\n  const [showDiceResult, setShowDiceResult] = useState(false);\r\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n  const [isDM, setIsDM] = useState(false);\r\n  const [showEnemySelect, setShowEnemySelect] = useState(false);\r\n  const [selectedPosition, setSelectedPosition] = useState(null);\r\n\r\n  // Refs\r\n  const firebaseRef = useRef(null);\r\n  const unsubscribeRef = useRef(null);\r\n\r\n  // Helper Functions\r\n  const handleDisconnect = useCallback(() => {\r\n    try {\r\n      if (unsubscribeRef.current) {\r\n        unsubscribeRef.current();\r\n        unsubscribeRef.current = null;\r\n      }\r\n      if (firebaseRef.current) {\r\n        off(firebaseRef.current);\r\n        firebaseRef.current = null;\r\n      }\r\n\r\n      // Reset room-specific state\r\n      setIsConnected(false);\r\n      setRoomCode('');\r\n      setTokens({});\r\n      setLayers(initialGameState.layers);\r\n      setInitiative([]);\r\n      setInCombat(false);\r\n      setCurrentTurn(0);\r\n      setDiceHistory([]);\r\n      setAdvantage(false);\r\n      setModifier(0);\r\n      setSelectedToken(null);\r\n      setShowTokenModal(false);\r\n      setPartyLoot(initialGameState.partyLoot);\r\n      setZoomLevel(isSmallScreen ? 0.8 : 1);\r\n      // Don't clear characters or player name\r\n\r\n    } catch (error) {\r\n      console.error('Error during disconnect:', error);\r\n      Alert.alert('Error', 'Failed to leave room properly. Please try again.');\r\n    }\r\n  }, []);\r\n\r\n  const handleInitiativeRoll = useCallback(() => {\r\n    if (!tokens || Object.keys(tokens).length === 0) {\r\n      Alert.alert('Error', 'No tokens on the board');\r\n      return;\r\n    }\r\n\r\n    const rolls = Object.entries(tokens).map(([position, token]) => {\r\n      const roll = Math.floor(Math.random() * 20) + 1;\r\n      const initiative = roll + (token.initiativeBonus || 0);\r\n      return {\r\n        position,\r\n        initiative,\r\n        details: `${token.name} (${initiative})`\r\n      };\r\n    });\r\n\r\n    rolls.sort((a, b) => b.initiative - a.initiative);\r\n\r\n    if (firebaseRef.current) {\r\n      set(firebaseRef.current, {\r\n        ...initialGameState,\r\n        tokens,\r\n        layers,\r\n        initiative: rolls,\r\n        inCombat: true,\r\n        currentTurn: 0\r\n      });\r\n    }\r\n\r\n    setInitiative(rolls);\r\n    setInCombat(true);\r\n    setCurrentTurn(0);\r\n  }, [tokens, layers]);\r\n\r\n  const rollDice = useCallback((sides) => {\r\n    const allRolls = [];\r\n\r\n    // Roll for each die in quantity\r\n    for (let d = 0; d < diceQuantity; d++) {\r\n      const rolls = [];\r\n      const numRolls = rollType !== 'normal' ? 2 : 1;\r\n\r\n      // Roll with advantage/disadvantage if enabled\r\n      for (let i = 0; i < numRolls; i++) {\r\n        rolls.push(Math.floor(Math.random() * sides) + 1);\r\n      }\r\n\r\n      const finalRoll = rollType === 'advantage' \r\n        ? Math.max(...rolls) \r\n        : rollType === 'disadvantage'\r\n          ? Math.min(...rolls)\r\n          : rolls[0];\r\n\r\n      allRolls.push({\r\n        rolls,\r\n        total: finalRoll\r\n      });\r\n    }\r\n\r\n    // Calculate grand total including modifier\r\n    const grandTotal = allRolls.reduce((sum, roll) => sum + roll.total, 0) + modifier;\r\n\r\n    const newResult = {\r\n      dice: `${diceQuantity}d${sides}`,\r\n      rolls: allRolls.map(r => r.rolls).flat(),\r\n      individualTotals: allRolls.map(r => r.total),\r\n      modifier,\r\n      rollType,\r\n      total: grandTotal,\r\n      timestamp: Date.now()\r\n    };\r\n\r\n    setDiceHistory(prev => [newResult, ...prev.slice(0, 49)]);\r\n    Vibration.vibrate(50);\r\n  }, [rollType, modifier, diceQuantity]);\r\n\r\n  const handleCellPress = useCallback(async (row, col) => {\r\n    if (!firebaseRef.current) return;\r\n\r\n    try {\r\n      const position = `${row}-${col}`;\r\n      const newTokens = { ...tokens };\r\n\r\n      if (tokens[position]) {\r\n        delete newTokens[position];\r\n      } else {\r\n        if (isDM) {\r\n          setSelectedPosition(position);\r\n          setShowEnemySelect(true);\r\n          return;\r\n        } else {\r\n          // Check if a character is selected\r\n          if (!selectedCharacter) {\r\n            Alert.alert('No Character Selected', 'Please select a character from your list first.');\r\n            return;\r\n          }\r\n\r\n          // Create token from selected character\r\n          newTokens[position] = {\r\n            name: selectedCharacter.name,\r\n            color: currentColor,\r\n            hp: selectedCharacter.hp,\r\n            maxHp: selectedCharacter.maxHp,\r\n            ac: selectedCharacter.ac,\r\n            initiativeBonus: calculateModifier(selectedCharacter.abilityScores.DEX),\r\n            effects: [],\r\n            position,\r\n            owner: playerName\r\n          };\r\n        }\r\n      }\r\n\r\n      // Update Firebase\r\n      await set(firebaseRef.current, {\r\n        tokens: newTokens,\r\n        layers,\r\n        initiative,\r\n        inCombat,\r\n        currentTurn,\r\n        partyLoot,\r\n        lastUpdate: Date.now()\r\n      });\r\n\r\n      setTokens(newTokens);\r\n    } catch (error) {\r\n      console.error('Error updating tokens:', error);\r\n      Alert.alert('Error', 'Failed to update token');\r\n    }\r\n  }, [tokens, currentColor, layers, initiative, inCombat, currentTurn, partyLoot, selectedCharacter, playerName, isDM]);\r\n\r\n  // Update the savePlayerData function\r\n  const savePlayerData = useCallback(async (updatedCharacters) => {\r\n    if (!playerName || !roomCode) return;\r\n\r\n    try {\r\n      // Save to both the room and a separate players collection\r\n      const roomPlayerRef = ref(database, `rooms/${roomCode}/players/${playerName}`);\r\n      const globalPlayerRef = ref(database, `players/${playerName}`);\r\n\r\n      const playerData = {\r\n        characters: updatedCharacters,\r\n        lastUpdate: Date.now()\r\n      };\r\n\r\n      // Update both locations\r\n      await Promise.all([\r\n        set(roomPlayerRef, playerData),\r\n        set(globalPlayerRef, playerData)\r\n      ]);\r\n    } catch (error) {\r\n      console.error('Error saving player data:', error);\r\n      Alert.alert('Error', 'Failed to save character data');\r\n    }\r\n  }, [playerName, roomCode]);\r\n\r\n  // Update the connectToRoom function\r\n  const connectToRoom = useCallback(async (code) => {\r\n    if (!code.trim() || !playerName) {\r\n      Alert.alert(\"Error\", \"Please enter a room code and player name\");\r\n      return;\r\n    }\r\n\r\n    setIsJoining(true);\r\n    setIsLoading(true);\r\n\r\n    try {\r\n      // First try to load player's global data\r\n      const globalPlayerRef = ref(database, `players/${playerName}`);\r\n      const playerSnapshot = await get(globalPlayerRef);\r\n      if (playerSnapshot.exists()) {\r\n        const playerData = playerSnapshot.val();\r\n        setCharacters(playerData.characters || []);\r\n      }\r\n\r\n      const gameRef = ref(database, `rooms/${code}`);\r\n      firebaseRef.current = gameRef;\r\n\r\n      // Check if room exists\r\n      const snapshot = await get(gameRef);\r\n      if (!snapshot.exists()) {\r\n        await set(gameRef, initialGameState);\r\n      }\r\n\r\n      // Set up real-time listener\r\n      const unsubscribe = onValue(gameRef, (snapshot) => {\r\n        const data = snapshot.val();\r\n        if (data) {\r\n          setTokens(data.tokens || {});\r\n          setLayers(data.layers || initialGameState.layers);\r\n          setInitiative(data.initiative || []);\r\n          setInCombat(data.inCombat || false);\r\n          setCurrentTurn(data.currentTurn || 0);\r\n          setPartyLoot(data.partyLoot || initialGameState.partyLoot);\r\n\r\n          // Update characters from room data if they exist\r\n          if (data.players && data.players[playerName]) {\r\n            setCharacters(data.players[playerName].characters || []);\r\n          }\r\n        }\r\n      });\r\n\r\n      unsubscribeRef.current = unsubscribe;\r\n      setRoomCode(code);\r\n      setShowRoomModal(false);\r\n      setIsConnected(true);\r\n\r\n    } catch (error) {\r\n      console.error('Connection error:', error);\r\n      Alert.alert(\"Error\", \"Failed to join room. Please try again.\");\r\n      setIsConnected(false);\r\n    } finally {\r\n      setIsJoining(false);\r\n      setIsLoading(false);\r\n    }\r\n  }, [playerName]);\r\n\r\n  // Effects\r\n  useEffect(() => {\r\n    const handleOffline = () => {\r\n      Alert.alert(\r\n        'Connection Lost',\r\n        'Please check your internet connection',\r\n        [{ text: 'OK' }]\r\n      );\r\n    };\r\n\r\n    window.addEventListener('offline', handleOffline);\r\n    return () => {\r\n      window.removeEventListener('offline', handleOffline);\r\n      if (unsubscribeRef.current) {\r\n        unsubscribeRef.current();\r\n      }\r\n      if (firebaseRef.current) {\r\n        off(firebaseRef.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  // Add to styles\r\n  const layoutStyles = {\r\n    sidePanel: {\r\n      backgroundColor: THEME.background.panel,\r\n      padding: 15,\r\n      borderRadius: 10,\r\n      marginBottom: 15,\r\n      width: '100%',\r\n    },\r\n    sidePanelTitle: {\r\n      color: THEME.text.light,\r\n      fontSize: 18,\r\n      fontWeight: 'bold',\r\n      marginBottom: 10,\r\n    },\r\n    buttonRow: {\r\n      flexDirection: 'row',\r\n      gap: 10,\r\n      marginBottom: 10,\r\n    },\r\n    panelButton: {\r\n      backgroundColor: THEME.background.primary,\r\n      padding: 10,\r\n      borderRadius: 5,\r\n      alignItems: 'center',\r\n      flex: 1,\r\n    },\r\n    panelButtonText: {\r\n      color: THEME.text.light,\r\n      fontWeight: 'bold',\r\n    },\r\n    characterItem: {\r\n      padding: 10,\r\n      borderRadius: 5,\r\n      marginBottom: 5,\r\n      backgroundColor: THEME.background.secondary,\r\n    },\r\n    characterInfo: {\r\n      flexDirection: 'row',\r\n      justifyContent: 'space-between',\r\n      alignItems: 'center',\r\n    },\r\n    characterName: {\r\n      color: THEME.text.light,\r\n      fontWeight: 'bold',\r\n    },\r\n    characterDetails: {\r\n      color: THEME.text.light,\r\n      opacity: 0.8,\r\n    },\r\n  };\r\n\r\n  // Add the delete function in App component\r\n  const handleDeleteCharacter = useCallback(async () => {\r\n    if (!selectedCharacter) return;\r\n\r\n    try {\r\n      const newCharacters = characters.filter(char => char.name !== selectedCharacter.name);\r\n      setCharacters(newCharacters);\r\n      await savePlayerData(newCharacters);\r\n      setSelectedCharacter(null);\r\n      setShowDeleteModal(false);\r\n    } catch (error) {\r\n      console.error('Error deleting character:', error);\r\n      Alert.alert('Error', 'Failed to delete character');\r\n    }\r\n  }, [selectedCharacter, characters, savePlayerData]);\r\n\r\n  // Add the handleEnemySelect function\r\n  const handleEnemySelect = useCallback(async (enemy) => {\r\n    if (!selectedPosition || !firebaseRef.current) return;\r\n\r\n    try {\r\n      const newTokens = { ...tokens };\r\n      newTokens[selectedPosition] = {\r\n        ...enemy,\r\n        position: selectedPosition,\r\n        effects: [],\r\n        owner: 'DM'\r\n      };\r\n\r\n      await set(firebaseRef.current, {\r\n        tokens: newTokens,\r\n        layers,\r\n        initiative,\r\n        inCombat,\r\n        currentTurn,\r\n        partyLoot,\r\n        lastUpdate: Date.now()\r\n      });\r\n\r\n      setTokens(newTokens);\r\n      setShowEnemySelect(false);\r\n      setSelectedPosition(null);\r\n    } catch (error) {\r\n      console.error('Error adding enemy:', error);\r\n      Alert.alert('Error', 'Failed to add enemy');\r\n    }\r\n  }, [selectedPosition, tokens, layers, initiative, inCombat, currentTurn, partyLoot]);\r\n\r\n  // Main render return\r\n  return (\r\n    <SafeAreaView style={[styles.container, isDarkMode && styles.darkMode]}>\r\n      <View style={styles.container}>\r\n        {/* Modals stay at the top level */}\r\n        <TokenModal \r\n          showTokenModal={showTokenModal}\r\n          setShowTokenModal={setShowTokenModal}\r\n          selectedToken={selectedToken}\r\n          setSelectedToken={setSelectedToken}\r\n          tokens={tokens}\r\n          firebaseRef={firebaseRef}\r\n          initialGameState={initialGameState}\r\n          layers={layers}\r\n          initiative={initiative}\r\n          inCombat={inCombat}\r\n          currentTurn={currentTurn}\r\n          THEME={THEME}\r\n        />\r\n\r\n        <RoomModal \r\n          showRoomModal={showRoomModal}\r\n          setShowRoomModal={setShowRoomModal}\r\n          isConnected={isConnected}\r\n          roomCode={roomCode}\r\n          setRoomCode={setRoomCode}\r\n          isJoining={isJoining}\r\n          connectToRoom={connectToRoom}\r\n        />\r\n\r\n        <PlayerNameModal\r\n          visible={showPlayerNameModal && !playerName}\r\n          onSubmit={(name) => {\r\n            setPlayerName(name);\r\n            setShowPlayerNameModal(false);\r\n            setIsConnected(true);\r\n          }}\r\n        />\r\n\r\n        <DiceResultModal\r\n          visible={showDiceResult}\r\n          result={diceResult}\r\n          onClose={() => setShowDiceResult(false)}\r\n        />\r\n\r\n        <PartyLootModal\r\n          visible={showPartyLoot}\r\n          onClose={() => setShowPartyLoot(false)}\r\n          partyLoot={partyLoot}\r\n          playerName={playerName}\r\n          onUpdate={(updatedLoot) => {\r\n            setPartyLoot(updatedLoot);\r\n            if (firebaseRef.current) {\r\n              set(firebaseRef.current, {\r\n                ...initialGameState,\r\n                tokens,\r\n                layers,\r\n                initiative,\r\n                inCombat,\r\n                currentTurn,\r\n                partyLoot: updatedLoot\r\n              });\r\n            }\r\n          }}\r\n        />\r\n\r\n        <CharacterSheetModal\r\n          visible={showCharacterSheet}\r\n          onClose={() => setShowCharacterSheet(false)}\r\n          character={selectedCharacter || {\r\n            name: '',\r\n            class: '',\r\n            level: 1,\r\n            owner: playerName,\r\n            proficiencyBonus: 2,\r\n            hp: 0,\r\n            maxHp: 0,\r\n            ac: 10,\r\n            abilityScores: {\r\n              STR: 10,\r\n              DEX: 10,\r\n              CON: 10,\r\n              INT: 10,\r\n              WIS: 10,\r\n              CHA: 10\r\n            },\r\n            proficientSkills: [],\r\n            currency: {\r\n              CP: 0,\r\n              SP: 0,\r\n              EP: 0,\r\n              GP: 0,\r\n              PP: 0\r\n            },\r\n            items: [],\r\n            inventory: []\r\n          }}\r\n          characters={characters}\r\n          onUpdate={async (updatedCharacter) => {\r\n            try {\r\n              if (!updatedCharacter) {\r\n                throw new Error('No character data to save');\r\n              }\r\n\r\n              // Create new array with updated character\r\n              const newCharacters = selectedCharacter\r\n                ? characters.map(char => \r\n                    char.name === selectedCharacter.name ? updatedCharacter : char\r\n                  )\r\n                : [...characters, updatedCharacter];\r\n\r\n              // Update local state first\r\n              setCharacters(newCharacters);\r\n\r\n              // Save to Firebase\r\n              const playerRef = ref(database, `players/${playerName}`);\r\n              await set(playerRef, {\r\n                characters: newCharacters,\r\n                lastUpdate: Date.now()\r\n              });\r\n\r\n              // Also save to room data\r\n              if (firebaseRef.current) {\r\n                const roomPlayerRef = ref(database, `rooms/${roomCode}/players/${playerName}`);\r\n                await set(roomPlayerRef, {\r\n                  characters: newCharacters,\r\n                  lastUpdate: Date.now()\r\n                });\r\n              }\r\n\r\n              setShowCharacterSheet(false);\r\n\r\n            } catch (error) {\r\n              console.error('Error saving character:', error);\r\n              Alert.alert('Error', 'Failed to save character');\r\n            }\r\n          }}\r\n        />\r\n\r\n        <InventoryModal\r\n          visible={showInventory}\r\n          onClose={() => setShowInventory(false)}\r\n          character={selectedCharacter}\r\n          onUpdate={async (updatedCharacter) => {\r\n            try {\r\n              const newCharacters = characters.map(char => \r\n                char.name === selectedCharacter.name ? updatedCharacter : char\r\n              );\r\n\r\n              setCharacters(newCharacters);\r\n              await savePlayerData(newCharacters);\r\n              setShowInventory(false);\r\n            } catch (error) {\r\n              console.error('Error saving inventory:', error);\r\n              Alert.alert('Error', 'Failed to save inventory');\r\n            }\r\n          }}\r\n        />\r\n\r\n        {!isConnected ? (\r\n          <View style={styles.loadingContainer}>\r\n            {isLoading ? (\r\n              <View style={{ alignItems: 'center' }}>\r\n                <ActivityIndicator size=\"large\" color={THEME.accent} />\r\n                <Text style={[styles.loadingText, { marginTop: 20 }]}>\r\n                  Connecting to room...\r\n                </Text>\r\n              </View>\r\n            ) : (\r\n              <Text style={styles.loadingText}>\r\n                Enter a room code to begin\r\n              </Text>\r\n            )}\r\n          </View>\r\n        ) : (\r\n          <>\r\n            <View style={styles.header}>\r\n              <Text style={styles.title}>D&D Combat Tracker</Text>\r\n              <ScrollView \r\n                horizontal={isSmallScreen} \r\n                showsHorizontalScrollIndicator={false}\r\n                contentContainerStyle={styles.controls}\r\n              >\r\n                <TouchableOpacity \r\n                  style={[styles.controlButton, { backgroundColor: THEME.primary }]}\r\n                  onPress={() => setShowRoomModal(true)}\r\n                >\r\n                  <Text style={styles.buttonText}>Room: {roomCode}</Text>\r\n                </TouchableOpacity>\r\n\r\n                <TouchableOpacity\r\n                  style={[styles.controlButton, { backgroundColor: THEME.primary }]}\r\n                  onPress={handleInitiativeRoll}\r\n                >\r\n                  <Text style={styles.buttonText}>Roll Initiative</Text>\r\n                </TouchableOpacity>\r\n\r\n                {inCombat && (\r\n                  <>\r\n                    <TouchableOpacity\r\n                      style={[styles.controlButton, { backgroundColor: THEME.success }]}\r\n                      onPress={() => {\r\n                        const nextTurn = (currentTurn + 1) % initiative.length;\r\n                        setCurrentTurn(nextTurn);\r\n                        if (firebaseRef.current) {\r\n                          set(firebaseRef.current, {\r\n                            ...initialGameState,\r\n                            tokens,\r\n                            layers,\r\n                            initiative,\r\n                            inCombat: true,\r\n                            currentTurn: nextTurn\r\n                          });\r\n                        }\r\n                      }}\r\n                    >\r\n                      <Text style={styles.buttonText}>Next Turn</Text>\r\n                    </TouchableOpacity>\r\n\r\n                    <TouchableOpacity\r\n                      style={[styles.controlButton, { backgroundColor: THEME.danger }]}\r\n                      onPress={() => {\r\n                        if (firebaseRef.current) {\r\n                          set(firebaseRef.current, {\r\n                            ...initialGameState,\r\n                            tokens,\r\n                            layers,\r\n                            initiative: [],\r\n                            inCombat: false,\r\n                            currentTurn: 0\r\n                          });\r\n                        }\r\n                        setInitiative([]);\r\n                        setInCombat(false);\r\n                        setCurrentTurn(0);\r\n                      }}\r\n                    >\r\n                      <Text style={styles.buttonText}>End Combat</Text>\r\n                    </TouchableOpacity>\r\n                  </>\r\n                )}\r\n\r\n                <TouchableOpacity\r\n                  style={[styles.controlButton, { backgroundColor: THEME.danger }]}\r\n                  onPress={() => {\r\n                    Alert.alert(\r\n                      \"Leave Room\",\r\n                      \"Are you sure you want to leave this room?\",\r\n                      [\r\n                        { text: \"Cancel\", style: \"cancel\" },\r\n                        { \r\n                          text: \"Leave\", \r\n                          style: \"destructive\",\r\n                          onPress: () => {\r\n                            // Disconnect from Firebase\r\n                            if (unsubscribeRef.current) {\r\n                              unsubscribeRef.current();\r\n                              unsubscribeRef.current = null;\r\n                            }\r\n                            if (firebaseRef.current) {\r\n                              off(firebaseRef.current);\r\n                              firebaseRef.current = null;\r\n                            }\r\n\r\n                            // Reset state\r\n                            setIsConnected(false);\r\n                            setRoomCode('');\r\n                            setTokens({});\r\n                            setInitiative([]);\r\n                            setInCombat(false);\r\n                            setCurrentTurn(0);\r\n                            setPartyLoot(initialGameState.partyLoot);\r\n                            setShowRoomModal(true);\r\n                            setShowPlayerNameModal(true);\r\n                          }\r\n                        }\r\n                      ]\r\n                    );\r\n                  }}\r\n                >\r\n                  <Text style={styles.buttonText}>Leave Room</Text>\r\n                </TouchableOpacity>\r\n\r\n                <TouchableOpacity \r\n                  style={[\r\n                    styles.controlButton,\r\n                    isDM && styles.dmToggleActive\r\n                  ]}\r\n                  onPress={() => setIsDM(!isDM)}\r\n                >\r\n                  <Text style={styles.buttonText}>DM Mode</Text>\r\n                </TouchableOpacity>\r\n              </ScrollView>\r\n            </View>\r\n            <ScrollView style={styles.content}>\r\n              <View style={styles.mainArea}>\r\n                {/* Left Sidebar - Dice Roller */}\r\n                <View style={styles.leftSidebar}>\r\n                  <View style={diceStyles.dicePanel}>\r\n                    <Text style={diceStyles.diceTitle}>Dice Roller</Text>\r\n                    <View style={diceStyles.diceControls}>\r\n                      <View style={diceStyles.controlsRow}>\r\n                        <View style={diceStyles.controlGroup}>\r\n                          <TouchableOpacity\r\n                            style={[\r\n                              diceStyles.controlButton,\r\n                              rollType === 'advantage' && diceStyles.controlActive,\r\n                              rollType === 'advantage' && { backgroundColor: THEME.success }\r\n                            ]}\r\n                            onPress={() => setRollType(current => \r\n                              current === 'advantage' ? 'normal' : 'advantage'\r\n                            )}\r\n                          >\r\n                            <Text style={styles.buttonText}>Advantage</Text>\r\n                          </TouchableOpacity>\r\n                          <TouchableOpacity\r\n                            style={[\r\n                              diceStyles.controlButton,\r\n                              rollType === 'disadvantage' && diceStyles.controlActive,\r\n                              rollType === 'disadvantage' && { backgroundColor: THEME.danger }\r\n                            ]}\r\n                            onPress={() => setRollType(current => \r\n                              current === 'disadvantage' ? 'normal' : 'disadvantage'\r\n                            )}\r\n                          >\r\n                            <Text style={styles.buttonText}>Disadvantage</Text>\r\n                          </TouchableOpacity>\r\n                        </View>\r\n                      </View>\r\n\r\n                      <View style={diceStyles.controlsRow}>\r\n                        <View style={diceStyles.modifierGroup}>\r\n                          <Text style={diceStyles.modifierLabel}>Modifier</Text>\r\n                          <TextInput\r\n                            style={diceStyles.modifierInput}\r\n                            value={String(modifier)}\r\n                            onChangeText={text => {\r\n                              const num = parseInt(text) || 0;\r\n                              setModifier(num);\r\n                            }}\r\n                            keyboardType=\"numeric\"\r\n                            selectTextOnFocus={true}\r\n                          />\r\n                        </View>\r\n                        <View style={diceStyles.quantityGroup}>\r\n                          <Text style={diceStyles.quantityLabel}>Quantity</Text>\r\n                          <TextInput\r\n                            style={diceStyles.quantityInput}\r\n                            value={String(diceQuantity)}\r\n                            onChangeText={text => {\r\n                              const num = parseInt(text) || 1;\r\n                              setDiceQuantity(Math.max(1, Math.min(num, 100)));\r\n                            }}\r\n                            keyboardType=\"numeric\"\r\n                            selectTextOnFocus={true}\r\n                          />\r\n                        </View>\r\n                      </View>\r\n                    </View>\r\n\r\n                    <View style={diceStyles.diceGrid}>\r\n                      {DICE_TYPES.map(({ sides }) => (\r\n                        <TouchableOpacity\r\n                          key={sides}\r\n                          style={[diceStyles.diceButton, { backgroundColor: THEME.background.secondary }]}\r\n                          onPress={() => {\r\n                            const rolls = [];\r\n                            for (let i = 0; i < diceQuantity; i++) {\r\n                              if (rollType !== 'normal') {\r\n                                const roll1 = Math.floor(Math.random() * sides) + 1;\r\n                                const roll2 = Math.floor(Math.random() * sides) + 1;\r\n                                rolls.push(rollType === 'advantage' ? Math.max(roll1, roll2) : Math.min(roll1, roll2));\r\n                              } else {\r\n                                rolls.push(Math.floor(Math.random() * sides) + 1);\r\n                              }\r\n                            }\r\n\r\n                            const total = rolls.reduce((sum, roll) => sum + roll, 0) + modifier;\r\n                            const result = {\r\n                              dice: `${diceQuantity}d${sides}`,\r\n                              rolls,\r\n                              modifier,\r\n                              rollType,\r\n                              total\r\n                            };\r\n\r\n                            setDiceResult(result);\r\n                            setShowDiceResult(true);\r\n                            Vibration.vibrate(50);\r\n                          }}\r\n                        >\r\n                          <Text style={diceStyles.diceButtonText}>d{sides}</Text>\r\n                        </TouchableOpacity>\r\n                      ))}\r\n                    </View>\r\n                  </View>\r\n\r\n                  {/* Player Tools Panel */}\r\n                  <View style={styles.infoPanel}>\r\n                    <Text style={styles.infoPanelTitle}>Player Tools</Text>\r\n                    <View style={styles.infoGrid}>\r\n                      <TouchableOpacity \r\n                        style={styles.quickActionButton}\r\n                        onPress={() => {\r\n                          const roll = Math.floor(Math.random() * 20) + 1;\r\n                          setDiceResult({\r\n                            dice: \"d20\",\r\n                            rolls: [roll],\r\n                            modifier: 0,\r\n                            rollType: 'normal',\r\n                            total: roll\r\n                          });\r\n                          setShowDiceResult(true);\r\n                        }}\r\n                      >\r\n                        <Text style={styles.quickActionText}>Quick d20</Text>\r\n                      </TouchableOpacity>\r\n\r\n                      <TouchableOpacity \r\n                        style={styles.quickActionButton}\r\n                        onPress={() => {\r\n                          const roll1 = Math.floor(Math.random() * 20) + 1;\r\n                          const roll2 = Math.floor(Math.random() * 20) + 1;\r\n                          const total = Math.max(roll1, roll2);\r\n                          setDiceResult({\r\n                            dice: \"d20 with advantage\",\r\n                            rolls: [roll1, roll2],\r\n                            modifier: 0,\r\n                            rollType: 'advantage',\r\n                            total\r\n                          });\r\n                          setShowDiceResult(true);\r\n                        }}\r\n                      >\r\n                        <Text style={styles.quickActionText}>Quick Advantage</Text>\r\n                      </TouchableOpacity>\r\n\r\n                      <TouchableOpacity \r\n                        style={styles.quickActionButton}\r\n                        onPress={() => {\r\n                          const damage = Math.floor(Math.random() * 8) + 1;\r\n                          setDiceResult({\r\n                            dice: \"d8\",\r\n                            rolls: [damage],\r\n                            modifier: 0,\r\n                            rollType: 'normal',\r\n                            total: damage\r\n                          });\r\n                          setShowDiceResult(true);\r\n                        }}\r\n                      >\r\n                        <Text style={styles.quickActionText}>Quick Damage</Text>\r\n                      </TouchableOpacity>\r\n\r\n                      <TouchableOpacity \r\n                        style={styles.quickActionButton}\r\n                        onPress={() => {\r\n                          const roll1 = Math.floor(Math.random() * 20) + 1;\r\n                          const roll2 = Math.floor(Math.random() * 20) + 1;\r\n                          const total = Math.min(roll1, roll2);\r\n                          setDiceResult({\r\n                            dice: \"d20 with disadvantage\",\r\n                            rolls: [roll1, roll2],\r\n                            modifier: 0,\r\n                            rollType: 'disadvantage',\r\n                            total\r\n                          });\r\n                          setShowDiceResult(true);\r\n                        }}\r\n                      >\r\n                        <Text style={styles.quickActionText}>Quick Disadvantage</Text>\r\n                      </TouchableOpacity>\r\n                    </View>\r\n\r\n                    <View style={styles.divider} />\r\n\r\n                    <View style={styles.infoGrid}>\r\n                      <TouchableOpacity \r\n                        style={[styles.quickActionButton, { backgroundColor: THEME.accent }]}\r\n                        onPress={() => {\r\n                          const rolls = [\r\n                            Math.floor(Math.random() * 6) + 1,\r\n                            Math.floor(Math.random() * 6) + 1,\r\n                            Math.floor(Math.random() * 6) + 1,\r\n                            Math.floor(Math.random() * 6) + 1\r\n                          ].sort((a, b) => b - a);\r\n                          // Drop lowest roll\r\n                          rolls.pop();\r\n                          const total = rolls.reduce((sum, roll) => sum + roll, 0);\r\n                          setDiceResult({\r\n                            dice: \"4d6 drop lowest\",\r\n                            rolls: rolls,\r\n                            modifier: 0,\r\n                            rollType: 'normal',\r\n                            total\r\n                          });\r\n                          setShowDiceResult(true);\r\n                        }}\r\n                      >\r\n                        <Text style={styles.quickActionText}>Roll Ability Score</Text>\r\n                      </TouchableOpacity>\r\n\r\n                      <TouchableOpacity \r\n                        style={[styles.quickActionButton, { backgroundColor: THEME.success }]}\r\n                        onPress={() => {\r\n                          const roll = Math.floor(Math.random() * 100) + 1;\r\n                          setDiceResult({\r\n                            dice: \"d100\",\r\n                            rolls: [roll],\r\n                            modifier: 0,\r\n                            rollType: 'normal',\r\n                            total: roll\r\n                          });\r\n                          setShowDiceResult(true);\r\n                        }}\r\n                      >\r\n                        <Text style={styles.quickActionText}>Percentile Roll</Text>\r\n                      </TouchableOpacity>\r\n                    </View>\r\n                  </View>\r\n                </View>\r\n\r\n                {/* Grid Section */}\r\n                <View style={styles.gridSection}>\r\n                  <ScrollView \r\n                    horizontal \r\n                    contentContainerStyle={{ minWidth: '100%' }}\r\n                  >\r\n                    <ScrollView>\r\n                      <View style={[\r\n                        styles.gridContainer,\r\n                        { transform: [{ scale: zoomLevel }] }\r\n                      ]}>\r\n                        {/* Color Picker */}\r\n                        <View style={styles.colorPicker}>\r\n                          {COLORS.map(color => (\r\n                            <TouchableOpacity\r\n                              key={color}\r\n                              style={[\r\n                                styles.colorButton,\r\n                                { backgroundColor: color },\r\n                                color === currentColor && styles.selectedColor\r\n                              ]}\r\n                              onPress={() => setCurrentColor(color)}\r\n                            />\r\n                          ))}\r\n                        </View>\r\n\r\n                        {/* Grid */}\r\n                        {Array.from({ length: GRID_SIZE }).map((_, row) => (\r\n                          <View key={row} style={styles.row}>\r\n                            {Array.from({ length: GRID_SIZE }).map((_, col) => {\r\n                              const position = `${row}-${col}`;\r\n                              const token = tokens[position];\r\n                              const isCurrentTurn = inCombat && \r\n                                initiative[currentTurn]?.position === position;\r\n\r\n                              return (\r\n                                <TouchableOpacity\r\n                                  key={col}\r\n                                  style={[\r\n                                    styles.cell,\r\n                                    token && { backgroundColor: token.color },\r\n                                    isCurrentTurn && styles.currentTurn\r\n                                  ]}\r\n                                  onPress={() => handleCellPress(row, col)}\r\n                                  onLongPress={() => {\r\n                                    if (token) {\r\n                                      setSelectedToken({ ...token, position });\r\n                                      setShowTokenModal(true);\r\n                                    }\r\n                                  }}\r\n                                >\r\n                                  {token && (\r\n                                    <View style={styles.tokenContent}>\r\n                                      <Text style={[\r\n                                        styles.tokenText,\r\n                                        { color: token.color === '#ffffff' ? '#000000' : '#ffffff' }\r\n                                      ]} numberOfLines={1}>\r\n                                        {token.name}\r\n                                      </Text>\r\n                                      <Text style={[\r\n                                        styles.tokenHp,\r\n                                        { color: token.color === '#ffffff' ? '#000000' : '#ffffff' }\r\n                                      ]}>\r\n                                        HP: {token.hp}/{token.maxHp}\r\n                                      </Text>\r\n                                      <Text style={[\r\n                                        styles.tokenHp,\r\n                                        { color: token.color === '#ffffff' ? '#000000' : '#ffffff' }\r\n                                      ]}>\r\n                                        AC: {token.ac}\r\n                                      </Text>\r\n                                      {token.effects && token.effects.length > 0 && (\r\n                                        <View style={statusStyles.tokenEffects}>\r\n                                          {token.effects.map(effect => {\r\n                                            const statusEffect = STATUS_EFFECTS.find(e => e.id === effect);\r\n                                            return statusEffect ? (\r\n                                              <Text key={effect} style={statusStyles.effectIcon}>\r\n                                                {statusEffect.icon}\r\n                                              </Text>\r\n                                            ) : null;\r\n                                          })}\r\n                                        </View>\r\n                                      )}\r\n                                    </View>\r\n                                  )}\r\n                                </TouchableOpacity>\r\n                              );\r\n                            })}\r\n                          </View>\r\n                        ))}\r\n                      </View>\r\n                    </ScrollView>\r\n                  </ScrollView>\r\n                  <GridZoomControls \r\n                    zoomLevel={zoomLevel}\r\n                    setZoomLevel={setZoomLevel}\r\n                  />\r\n                </View>\r\n\r\n                {/* Right Sidebar - Character Management & Combat */}\r\n                <View style={styles.rightSidebar}>\r\n                  {/* Quick Actions */}\r\n                  <View style={styles.quickActions}>\r\n                    <TouchableOpacity \r\n                      style={styles.quickActionButton}\r\n                      onPress={() => setShowCharacterSheet(true)}\r\n                    >\r\n                      <Text style={styles.quickActionText}>New Character</Text>\r\n                    </TouchableOpacity>\r\n                    <TouchableOpacity \r\n                      style={styles.quickActionButton}\r\n                      onPress={() => setShowPartyLoot(true)}\r\n                    >\r\n                      <Text style={styles.quickActionText}>Party Loot</Text>\r\n                    </TouchableOpacity>\r\n                    <TouchableOpacity \r\n                      style={styles.quickActionButton}\r\n                      onPress={handleInitiativeRoll}\r\n                    >\r\n                      <Text style={styles.quickActionText}>Roll Initiative</Text>\r\n                    </TouchableOpacity>\r\n                    <TouchableOpacity \r\n                      style={[styles.quickActionButton, { backgroundColor: THEME.danger }]}\r\n                      onPress={() => {\r\n                        if (firebaseRef.current) {\r\n                          set(firebaseRef.current, {\r\n                            ...initialGameState,\r\n                            tokens: {},\r\n                            layers,\r\n                            initiative: [],\r\n                            inCombat: false,\r\n                            currentTurn: 0,\r\n                            partyLoot,\r\n                            characters\r\n                          });\r\n                          setTokens({});\r\n                          setInitiative([]);\r\n                          setInCombat(false);\r\n                          setCurrentTurn(0);\r\n                        }\r\n                      }}\r\n                    >\r\n                      <Text style={styles.quickActionText}>Clear Board</Text>\r\n                    </TouchableOpacity>\r\n                  </View>\r\n\r\n                  {/* Character Management Panel */}\r\n                  <View style={[styles.infoPanel, { marginBottom: 15 }]}>\r\n                    <Text style={styles.infoPanelTitle}>Characters</Text>\r\n                    <ScrollView style={{ maxHeight: 200 }}>\r\n                      {characters\r\n                        .filter(char => char.owner === playerName)\r\n                        .map((char, index) => (\r\n                          <TouchableOpacity\r\n                            key={index}\r\n                            style={[\r\n                              layoutStyles.characterItem,\r\n                              selectedCharacter?.name === char.name && { backgroundColor: THEME.accent + '40' }\r\n                            ]}\r\n                            onPress={() => setSelectedCharacter(char)}\r\n                          >\r\n                            <View style={layoutStyles.characterInfo}>\r\n                              <View>\r\n                                <Text style={layoutStyles.characterName}>{char.name}</Text>\r\n                                <Text style={layoutStyles.characterDetails}>\r\n                                  Level {char.level} {char.class}\r\n                                </Text>\r\n                              </View>\r\n                              <View style={styles.statBadge}>\r\n                                <Text style={styles.statBadgeText}>\r\n                                  HP: {char.hp}/{char.maxHp}\r\n                                </Text>\r\n                              </View>\r\n                            </View>\r\n                          </TouchableOpacity>\r\n                        ))}\r\n                    </ScrollView>\r\n                    \r\n                    {selectedCharacter && (\r\n                      <>\r\n                        <View style={styles.divider} />\r\n                        <View style={styles.infoGrid}>\r\n                          <TouchableOpacity\r\n                            style={[styles.quickActionButton, { backgroundColor: THEME.accent }]}\r\n                            onPress={() => setShowCharacterSheet(true)}\r\n                          >\r\n                            <Text style={styles.quickActionText}>Character Sheet</Text>\r\n                          </TouchableOpacity>\r\n                          <TouchableOpacity\r\n                            style={[styles.quickActionButton, { backgroundColor: THEME.success }]}\r\n                            onPress={() => setShowInventory(true)}\r\n                          >\r\n                            <Text style={styles.quickActionText}>Inventory</Text>\r\n                          </TouchableOpacity>\r\n                        </View>\r\n                      </>\r\n                    )}\r\n                  </View>\r\n\r\n                  {/* Combat Tracker Panel */}\r\n                  <View style={styles.infoPanel}>\r\n                    <Text style={styles.infoPanelTitle}>Combat Tracker</Text>\r\n                    <View style={styles.infoGrid}>\r\n                      <TouchableOpacity \r\n                        style={[styles.quickActionButton, inCombat ? { backgroundColor: THEME.danger } : {}]}\r\n                        onPress={() => {\r\n                          if (inCombat) {\r\n                            if (firebaseRef.current) {\r\n                              set(firebaseRef.current, {\r\n                                ...initialGameState,\r\n                                tokens,\r\n                                layers,\r\n                                initiative: [],\r\n                                inCombat: false,\r\n                                currentTurn: 0\r\n                              });\r\n                            }\r\n                            setInitiative([]);\r\n                            setInCombat(false);\r\n                            setCurrentTurn(0);\r\n                          } else {\r\n                            handleInitiativeRoll();\r\n                          }\r\n                        }}\r\n                      >\r\n                        <Text style={styles.quickActionText}>\r\n                          {inCombat ? 'End Combat' : 'Start Combat'}\r\n                        </Text>\r\n                      </TouchableOpacity>\r\n                      \r\n                      {inCombat && (\r\n                        <TouchableOpacity\r\n                          style={[styles.quickActionButton, { backgroundColor: THEME.success }]}\r\n                          onPress={() => {\r\n                            const nextTurn = (currentTurn + 1) % initiative.length;\r\n                            setCurrentTurn(nextTurn);\r\n                            if (firebaseRef.current) {\r\n                              set(firebaseRef.current, {\r\n                                ...initialGameState,\r\n                                tokens,\r\n                                layers,\r\n                                initiative,\r\n                                inCombat: true,\r\n                                currentTurn: nextTurn\r\n                              });\r\n                            }\r\n                          }}\r\n                        >\r\n                          <Text style={styles.quickActionText}>Next Turn</Text>\r\n                        </TouchableOpacity>\r\n                      )}\r\n                    </View>\r\n\r\n                    {inCombat && initiative.length > 0 && (\r\n                      <>\r\n                        <View style={styles.divider} />\r\n                        <Text style={[styles.infoPanelTitle, { fontSize: 14 }]}>Current Turn</Text>\r\n                        <View style={[styles.infoCard, { marginBottom: 10 }]}>\r\n                          <Text style={styles.infoValue}>\r\n                            {tokens[initiative[currentTurn]?.position]?.name || 'Unknown'}\r\n                          </Text>\r\n                          <Text style={styles.infoLabel}>\r\n                            Initiative: {initiative[currentTurn]?.initiative || '0'}\r\n                          </Text>\r\n                        </View>\r\n                        \r\n                        <Text style={[styles.infoPanelTitle, { fontSize: 14 }]}>Initiative Order</Text>\r\n                        <ScrollView style={{ maxHeight: 150 }}>\r\n                          {initiative.map((item, index) => {\r\n                            const token = tokens[item.position];\r\n                            if (!token) return null;\r\n                            return (\r\n                              <View \r\n                                key={item.position}\r\n                                style={[\r\n                                  styles.infoCard,\r\n                                  { marginBottom: 5 },\r\n                                  index === currentTurn && { backgroundColor: THEME.accent + '40' }\r\n                                ]}\r\n                              >\r\n                                <Text style={styles.infoValue}>{token.name}</Text>\r\n                                <View style={{ flexDirection: 'row', justifyContent: 'space-between' }}>\r\n                                  <Text style={styles.infoLabel}>Initiative: {item.initiative}</Text>\r\n                                  <Text style={styles.infoLabel}>HP: {token.hp}/{token.maxHp}</Text>\r\n                                </View>\r\n                              </View>\r\n                            );\r\n                          })}\r\n                        </ScrollView>\r\n                      </>\r\n                    )}\r\n                  </View>\r\n                </View>\r\n              </View>\r\n            </ScrollView>\r\n          </>\r\n        )}\r\n      </View>\r\n      <DeleteCharacterModal\r\n        visible={showDeleteModal}\r\n        character={selectedCharacter}\r\n        onClose={() => setShowDeleteModal(false)}\r\n        onConfirm={handleDeleteCharacter}\r\n      />\r\n      <EnemySelectModal\r\n        visible={showEnemySelect}\r\n        onClose={() => {\r\n          setShowEnemySelect(false);\r\n          setSelectedPosition(null);\r\n        }}\r\n        onSelect={handleEnemySelect}\r\n      />\r\n    </SafeAreaView>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}